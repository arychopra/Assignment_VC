<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>The Vast Challenge: Building the Charts</title>
  
  <meta property="description" itemprop="description" content="A new article created using the Distill format."/>
  
  
  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-07-23"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-07-23"/>
  <meta name="article:author" content="Aryah U. Chopra"/>
  
  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="The Vast Challenge: Building the Charts"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="A new article created using the Distill format."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="The Vast Challenge"/>
  
  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="The Vast Challenge: Building the Charts"/>
  <meta property="twitter:description" content="A new article created using the Distill format."/>
  
  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Building the Charts"]},{"type":"character","attributes":{},"value":["A new article created using the Distill format.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Aryah U. Chopra"]},{"type":"character","attributes":{},"value":["https://www.linkedin.com/in/aryahuc/"]}]}]},{"type":"character","attributes":{},"value":["2021-07-23"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>
  
  <script type="application/javascript">
  
    window.headroom_prevent_pin = false;
  
    window.document.addEventListener("DOMContentLoaded", function (event) {
  
      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');
  
      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });
  
      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });
  
      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>
  
  <style type="text/css">
  
  /* Theme (user-documented overrideables for nav appearance) */
  
  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }
  
  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }
  
  .distill-site-nav a:hover {
    color: white;
  }
  
  @media print {
    .distill-site-nav {
      display: none;
    }
  }
  
  .distill-site-header {
  
  }
  
  .distill-site-footer {
  
  }
  
  
  /* Site Header */
  
  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }
  
  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }
  
  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }
  
  
  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }
  
  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }
  
  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }
  
  .distill-site-header .logo {
    padding: 0;
  }
  
  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }
  
  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }
  
  
  
  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }
  
  
  .distill-site-header .nav-toggle {
    display: none;
  }
  
  .nav-dropdown {
    display: inline-block;
    position: relative;
  }
  
  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }
  
  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }
  
  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .nav-dropdown-active {
    display: block;
  }
  
  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }
  
  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }
  
  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }
  
  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }
  
  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }
  
  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }
  
  
  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }
  
  /* Site Footer */
  
  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }
  
  /* Headroom */
  
  d-title {
    padding-top: 6rem;
  }
  
  @media print {
    d-title {
      padding-top: 4rem;
    }
  }
  
  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }
  
  .headroom--transition {
    transition: all .4s ease-in-out;
  }
  
  .headroom--unpinned {
    top: -100px;
  }
  
  .headroom--pinned {
    top: 0;
  }
  
  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }
  
  </style>
  
  <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>
  
  <script type="application/javascript">
  
  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }
  
  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }
  
  function createFuseIndex() {
  
    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);
  
    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });
  
        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }
  
  window.document.addEventListener("DOMContentLoaded", function (event) {
  
    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;
  
    createFuseIndex()
      .then(function(fuse) {
  
        // make search box visible
        searchEl.classList.remove('hidden');
  
        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });
  
  });
  
  </script>
  
  <style type="text/css">
  
  .nav-search {
    font-size: x-small;
  }
  
  /* Algolioa Autocomplete */
  
  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }
  
  
  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }
  
  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }
  
  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }
  
  </style>
  
  
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->
  
  <style type="text/css">
  
  body {
    background-color: white;
  }
  
  .pandoc-table {
    width: 100%;
  }
  
  .pandoc-table>caption {
    margin-bottom: 10px;
  }
  
  .pandoc-table th:not([align]) {
    text-align: left;
  }
  
  .pagedtable-footer {
    font-size: 15px;
  }
  
  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }
  
  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }
  
  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }
  
  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }
  
  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }
  
  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }
  
  .html-widget {
    margin-bottom: 2.0em;
  }
  
  .l-screen-inset {
    padding-right: 16px;
  }
  
  .l-screen .caption {
    margin-left: 10px;
  }
  
  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .shaded-content {
    background: white;
  }
  
  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }
  
  .hidden {
    display: none !important;
  }
  
  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }
  
  d-appendix {
    padding-top: 30px;
  }
  
  d-article>p>img {
    width: 100%;
  }
  
  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }
  
  d-article h3 {
    margin-top: 1.5rem;
  }
  
  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }
  
  /* Tweak code blocks */
  
  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }
  
  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }
  
  d-article div.sourceCode {
    background-color: white;
  }
  
  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }
  
  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  d-article pre a {
    border-bottom: none;
  }
  
  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }
  
  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }
  
  @media(min-width: 768px) {
  
  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }
  
  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }
  
  d-article pre {
    font-size: 14px;
  }
  
  }
  
  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  /* CSS for d-contents */
  
  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }
  
  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }
  
  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }
  
  .d-contents li {
    list-style-type: none
  }
  
  .d-contents nav > ul {
    padding-left: 0;
  }
  
  .d-contents ul {
    padding-left: 1em
  }
  
  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }
  
  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }
  
  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }
  
  .d-contents nav > ul > li > a {
    font-weight: 600;
  }
  
  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }
  
  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }
  
  
  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }
  
  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }
  
  
  /* Figure */
  
  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }
  
  .figure img {
    width: 100%;
  }
  
  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }
  
  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }
  
  /* Citations */
  
  d-article .citation {
    color: inherit;
    cursor: inherit;
  }
  
  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }
  
  /* Citation hover box */
  
  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }
  
  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }
  
  
  /* Tweak 1000px media break to show more text */
  
  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }
  
    .grid {
      grid-column-gap: 16px;
    }
  
    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }
  
  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }
  
    .grid {
      grid-column-gap: 32px;
    }
  }
  
  
  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */
  
  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  
  /* Include appendix styles here so they can be overridden */
  
  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }
  
  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }
  
  d-appendix h3 + * {
    margin-top: 1em;
  }
  
  d-appendix ol {
    padding: 0 0 0 15px;
  }
  
  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }
  
  d-appendix li {
    margin-bottom: 1em;
  }
  
  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  d-appendix > * {
    grid-column: text;
  }
  
  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }
  
  /* Include footnote styles here so they can be overridden */
  
  d-footnote-list {
    contain: layout style;
  }
  
  d-footnote-list > * {
    grid-column: text;
  }
  
  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }
  
  
  
  /* Anchor.js */
  
  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }
  
  /* Social footer */
  
  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }
  
  .disqus-comments {
    margin-right: 30px;
  }
  
  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }
  
  #disqus_thread {
    margin-top: 30px;
  }
  
  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }
  
  .article-sharing a:hover {
    border-bottom: none;
  }
  
  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .subscribe p {
    margin-bottom: 0.5em;
  }
  
  
  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }
  
  
  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .custom p {
    margin-bottom: 0.5em;
  }
  
  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }
  
  /* Styles for posts lists (not auto-injected) */
  
  
  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }
  
  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }
  
  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }
  
  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }
  
  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }
  
  .post-preview-last {
    border-bottom: none !important;
  }
  
  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }
  
  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }
  
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }
  
  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }
  
  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }
  
  .posts-list .metadata > * {
    display: inline-block;
  }
  
  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }
  
  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }
  
  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }
  
  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  .posts-list img {
    opacity: 1;
  }
  
  .posts-list img[data-src] {
    opacity: 0;
  }
  
  .posts-more {
    clear: both;
  }
  
  
  .posts-sidebar {
    font-size: 16px;
  }
  
  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }
  
  .sidebar-section {
    margin-bottom: 30px;
  }
  
  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
  
  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }
  
  .categories li>a {
    border-bottom: none;
  }
  
  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }
  
  .categories .active {
    font-weight: 600;
  }
  
  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }
  
  
  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }
  
  
  /* Improve display for browsers without grid (IE/Edge <= 15) */
  
  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }
  
  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }
  
  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }
  
  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }
  
  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }
  
  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }
  
  
  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }
  
  .downlevel .footnotes ol {
    padding-left: 13px;
  }
  
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }
  
  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }
  
  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }
  
  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  .downlevel .posts-list .post-preview {
    color: inherit;
  }
  
  
  
  </style>
  
  <script type="application/javascript">
  
  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }
  
  // show body when load is complete
  function on_load_complete() {
  
    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }
  
  
    // set body to visible
    document.body.style.visibility = 'visible';
  
    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }
  
    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }
  
  function init_distill() {
  
    init_common();
  
    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);
  
    // create d-title
    $('.d-title').changeElementType('d-title');
  
    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);
  
    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();
  
    // move posts container into article
    $('.posts-container').appendTo($('d-article'));
  
    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');
  
    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;
  
    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();
  
    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));
  
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });
  
    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');
  
    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {
  
      // capture layout
      var layout = $(this).attr('data-layout');
  
      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });
  
  
      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });
  
    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();
  
    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();
  
    // load distill framework
    load_distill_framework();
  
    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {
  
      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;
  
      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');
  
      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');
  
      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');
  
      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });
  
      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }
  
      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');
  
      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");
  
      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }
  
       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }
  
      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();
  
      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();
  
      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });
  
      // clear polling timer
      clearInterval(tid);
  
      // show body now that everything is ready
      on_load_complete();
    }
  
    var tid = setInterval(distill_post_process, 50);
    distill_post_process();
  
  }
  
  function init_downlevel() {
  
    init_common();
  
     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));
  
    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
  
    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();
  
    // remove toc
    $('.d-contents').remove();
  
    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });
  
  
    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);
  
    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);
  
    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();
  
    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();
  
    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));
  
    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });
  
    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));
  
    $('body').addClass('downlevel');
  
    on_load_complete();
  }
  
  
  function init_common() {
  
    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};
  
        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });
  
        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);
  
    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});
  
    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });
  
      }
    });
  
    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });
  
    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }
  
    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');
  
    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");
  
    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();
  
    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });
  
  </script>
  
  <style type="text/css">
  /* base variables */
  
  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */
  
  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */
  
  
  
  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.06rem;
    --code-size:       14px;
    --aside-size:      12px;
    --fig-cap-size:    13px;
    /*-- Main font colors --*/
    --title-color:     #000000;
    --header-color:    rgba(0, 0, 0, 0.8);
    --body-color:      rgba(0, 0, 0, 0.8);
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    sans-serif;
    --mono-font:       monospace;
    --body-font:       sans-serif;
    --navbar-font:     sans-serif;  /* websites + blogs only */
  }
  
  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.6rem;
    --heading-color:   rgba(0, 0, 0, 0.5);
    --body-size:       0.8rem;
    --body-color:      rgba(0, 0, 0, 0.8);
  }
  
  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }
  
  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(0, 0, 0, 0.5);
  }
  
  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */
  
  .distill-site-header {
    --title-size:       18px;
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }
  
  .distill-site-footer {
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }
  
  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */
  </style>
  <style type="text/css">
  /* base variables */
  
  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */
  
  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */
  @import url('https://fonts.googleapis.com/css2?family=Cardo');
  @import url('https://fonts.googleapis.com/css2?family=Alata');
  
  
  html {
    /*-- Main font sizes --*/
    --title-size:      36px;
    --body-size:       16px;                     /* edited */
    --code-size:       14px;                     /* edited */
    --aside-size:      16px;
    --fig-cap-size:    12px;
    /*-- Main font colors --*/
    --title-color:     #000000;
    --heading-color:   rgba(0, 0, 0, 0.8);
    --body-color:      #383838;                    /* edited */
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    'Alata', sans-serif;        /* edited */
    --mono-font:       monospace;
    --body-font:       'Alata', serif;             /* edited */
    --navbar-font:     'Alata', sans-serif;        /* edited */
  }
  
  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.9rem;
    --heading-color:   rgba(0, 0, 0, 0.8);
    --body-size:       1rem;
    --body-color:      rgba(0, 0, 0, 0.8);
  }
  
  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    16px;
    --contents-size:   15px;
  }
  
  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(249, 83, 85, 0.5);
  }
  
  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */
  
  .distill-site-header {
    --title-size:       18px;                      /* edited */
    --text-color:       #434343;                   /* edited */
    --text-size:        18px;                      /* edited */
    --hover-color:      rgb(135, 203, 61);         /* edited */
    --bkgd-color:       #FFFFFF;                /* edited */
  }
  
  
  .distill-site-footer {
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        18px;
    --hover-color:      rgb(135, 203, 61);
    --bkgd-color:       #0F2E3D;
  }
  
  
  /*-- Additional custom styles --*/
  
  .posts-list .metadata .publishedDate {
      color: #434343;
      font-size: 18px;
  }
  
  d-article p code {
    color: #383838;
    background: rgba(249, 83, 85, 0.1);
    font-weight: 400;
    font-size: 18px;
  }
  
  d-article a {
      border-bottom: 2.5px solid rgba(249, 83, 85, 0.4);
      text-decoration: none;
  }
  
  .distill-site-header .title {
      font-weight: 600; 
  }
  
  ul > li::marker {
    color: rgb(249, 83, 85);
  }
  
  .nav-search{
    font-size: 12px;
    color: rgb(249, 83, 85);
    font-weight: bold;
  
  }
  
  
  d-title {
  	height: 100%;
  	/* max-height: 600px; */
  	width: auto;
  	background-color: hsla(200,40%,30%,.4);
  	background-image:		
  		/*url('https://sensanalytics.com/wp-content/uploads/2017/12/Data-Science-Image-1.png'),*/
  		/*url('/Presentation3.png'),*/
  		url('/Presentation3.png'),
  		url('/white.jpg'),
  		url('/white.jpg'),
  		url('/white.jpg'),
  		url('/white.jpg');
  		
  		/*url('https://coolbackgrounds.io/images/backgrounds/white/pure-white-background-85a2a7fd.jpg'),*/
  		/*url('https://coolbackgrounds.io/images/backgrounds/white/pure-white-background-85a2a7fd.jpg'),*/		     
  		/*url('https://coolbackgrounds.io/images/backgrounds/white/pure-white-background-85a2a7fd.jpg');*/
  	
  	background-repeat: repeat-x;
  	background-position: 
  		0 70%,
  		0 100%,
  		0 50%,
  		0 100%,
  		0 0;
  	background-size: 
  		1200px,
  		500px,
  		500px 200px,
  		500px,
  		500px 260px;
  	animation: 800s para infinite linear;
  	}
  
  @keyframes para {
  	100% {
  		background-position: 
  			-5000px 20%,
  			-800px 95%,
  			500px 50%,
  			1000px 100%,
  			400px 0;
  		}
  	}
  	
  d-title p{
    background-color: rgba(255, 255, 255, 0.90);   
    line-height: 1.75em;
    text-align: center;
  }
  
  d-title h1{
    background-color: rgba(255, 255, 255, 0.90);  
    line-height: 1.75em;
    text-align: center;
  }
  
  ::-webkit-scrollbar{
      width: 15px;
      height: 5px;
  }
  ::-webkit-scrollbar-track{
      background-color: rgb(255, 255, 255);
      border-radius: 10px;
  }
  ::-webkit-scrollbar-thumb{
      background: rgba(249, 83, 85, 0.20);
      border-radius: 10px;
  }
  ::-webkit-scrollbar-thumb:hover{
      background: rgba(249, 83, 85, 0.30);
  }</style>
  <style type="text/css">
  /* base style */
  
  /* FONT FAMILIES */
  
  :root {
    --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }
  
  body,
  .posts-list .post-preview p,
  .posts-list .description p {
    font-family: var(--body-font), var(--body-default);
  }
  
  h1, h2, h3, h4, h5, h6,
  .posts-list .post-preview h2,
  .posts-list .description h2 {
    font-family: var(--heading-font), var(--heading-default);
  }
  
  d-article div.sourceCode code,
  d-article pre code {
    font-family: var(--mono-font), var(--mono-default);
  }
  
  
  /*-- TITLE --*/
  d-title h1,
  .posts-list > h1 {
    color: var(--title-color, black);
  }
  
  d-title h1 {
    font-size: var(--title-size, 50px);
  }
  
  /*-- HEADERS --*/
  d-article h1,
  d-article h2,
  d-article h3,
  d-article h4,
  d-article h5,
  d-article h6 {
    color: var(--header-color, rgba(0, 0, 0, 0.8));
  }
  
  /*-- BODY --*/
  d-article > p,  /* only text inside of <p> tags */
  d-article > ul, /* lists */
  d-article > ol {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
    font-size: var(--body-size, 1.06rem);
  }
  
  
  /*-- CODE --*/
  d-article div.sourceCode code,
  d-article pre code {
    font-size: var(--code-size, 14px);
  }
  
  /*-- ASIDE --*/
  d-article aside {
    font-size: var(--aside-size, 12px);
    color: var(--aside-color, rgba(0, 0, 0, 0.6));
  }
  
  /*-- FIGURE CAPTIONS --*/
  figure .caption,
  figure figcaption,
  .figure .caption {
    font-size: var(--fig-cap-size, 13px);
    color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
  }
  
  /*-- METADATA --*/
  d-byline h3 {
    font-size: var(--heading-size, 0.6rem);
    color: var(--heading-color, rgba(0, 0, 0, 0.5));
  }
  
  d-byline {
    font-size: var(--body-size, 0.8rem);
    color: var(--body-color, rgba(0, 0, 0, 0.8));
  }
  
  d-byline a,
  d-article d-byline a {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
  }
  
  /*-- TABLE OF CONTENTS --*/
  .d-contents nav h3 {
    font-size: var(--heading-size, 18px);
  }
  
  .d-contents nav a {
    font-size: var(--contents-size, 13px);
  }
  
  /*-- APPENDIX --*/
  d-appendix h3 {
    font-size: var(--heading-size, 15px);
    color: var(--heading-color, rgba(0, 0, 0, 0.65));
  }
  
  d-appendix {
    font-size: var(--text-size, 0.8em);
    color: var(--text-color, rgba(0, 0, 0, 0.5));
  }
  
  d-appendix d-footnote-list a.footnote-backlink {
    color: var(--text-color, rgba(0, 0, 0, 0.5));
  }
  
  /*-- WEBSITE HEADER + FOOTER --*/
  .distill-site-header .title {
    font-size: var(--title-size, 18px);
    font-family: var(--navbar-font), var(--heading-default);
  }
  
  .distill-site-header a,
  .nav-dropdown .nav-dropbtn {
    font-family: var(--navbar-font), var(--heading-default);
  }
  
  .nav-dropdown .nav-dropbtn {
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    font-size: var(--text-size, 15px);
  }
  
  .distill-site-header a:hover,
  .nav-dropdown:hover .nav-dropbtn {
    color: var(--hover-color, white);
  }
  
  .distill-site-header {
    font-size: var(--text-size, 15px);
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    background-color: var(--bkgd-color, #0F2E3D);
  }
  
  .distill-site-footer {
    font-size: var(--text-size, 15px);
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    background-color: var(--bkgd-color, #0F2E3D);
  }
  
  .distill-site-footer a:hover {
    color: var(--hover-color, white);
  }</style>
  <!--/radix_placeholder_distill-->
  <script src="site_libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
  <link href="site_libs/vis-4.20.1/vis.css" rel="stylesheet" />
  <script src="site_libs/vis-4.20.1/vis.min.js"></script>
  <script src="site_libs/visNetwork-binding-2.0.9/visNetwork.js"></script>
  <script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
  <script src="site_libs/plotly-binding-4.9.3/plotly.js"></script>
  <script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
  <script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
  <link href="site_libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
  <script src="site_libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
  <link href="site_libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
  <script src="site_libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Building the Charts","description":"A new article created using the Distill format.","authors":[{"author":"Aryah U. Chopra","authorURL":"https://www.linkedin.com/in/aryahuc/","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-07-23T00:00:00.000+08:00","citationText":"Chopra, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">The Vast Challenge</a>
<a href="Introduction.html">Intro</a>
<a href="Data_Prep.html">Data Prep</a>
<a href="Build.html">Building the Visuals</a>
<a href="Insights.html">Insights</a>
</div>
<div class="nav-right">
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Building the Charts</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>A new article created using the Distill format.</p></p>
</div>

<div class="d-byline">
  Aryah U. Chopra <a href="https://www.linkedin.com/in/aryahuc/" class="uri">https://www.linkedin.com/in/aryahuc/</a> 
  
<br/>2021-07-23
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#loading-the-libraries">Loading the Libraries</a></li>
<li><a href="#building-the-visuals-for-question-1">Building the Visuals for Question 1</a><ul>
<li><a href="#editing-functions">Editing Functions</a></li>
<li><a href="#creating-the-visnetwork-for-texts">Creating the VisNetwork for Texts</a></li>
<li><a href="#creating-the-correlation-plot-of-sources">Creating the Correlation Plot of Sources</a></li>
<li><a href="#understanding-the-authors-links">Understanding the Author’s Links</a></li>
<li><a href="#tf-idf-of-news-sources">TF-IDF of News sources</a></li>
<li><a href="#average-no.-of-words-per-source">Average No. of Words Per Source</a></li>
</ul></li>
<li><a href="#building-the-visuals-for-question-2">Building the Visuals for Question 2</a><ul>
<li><a href="#bi-gram-plots-by-source">Bi-Gram Plots by Source</a></li>
<li><a href="#word-cloud-by-communities">Word Cloud by Communities</a></li>
</ul></li>
<li><a href="#building-the-visuals-for-question-3">Building the Visuals for Question 3</a><ul>
<li><a href="#creating-the-email-network-communities-by-department">Creating the email Network, communities by Department</a></li>
<li><a href="#creating-the-email-network-communities-by-weight-i.e.-frequency-of-email-correspondence">Creating the email Network, communities by Weight i.e. frequency of email correspondence</a></li>
<li><a href="#creating-the-email-network-communites-by-text">Creating the email Network, communites by Text</a></li>
<li><a href="#create-the-age-plot">Create the Age Plot</a></li>
<li><a href="#creating-the-age-comparison-plot">Creating the Age Comparison Plot</a></li>
<li><a href="#creating-the-citizenship-chart">Creating the Citizenship Chart</a></li>
<li><a href="#creating-the-military-period">Creating the Military Period</a></li>
<li><a href="#creating-the-year-joined-chart">Creating the Year Joined Chart</a></li>
</ul></li>
</ul>
</nav>
</div>
<style>

d-article div.sourceCode {
    background-color: rgba(247, 230, 230, 0.05);
    border-color: blue;
    border: 1px solid rgba(249, 83, 85, 0.2);
    border-radius: 1px;
    overflow-x: auto !important;
    max-width: 704px;

}

d-article pre{
    background-color: rgba(217, 217, 217, 0.05);
    #border: 1px solid rgba(217, 217, 217, 0.2);
    border-radius: 1px;
    overflow-x: auto !important;
    max-width: 704px;
}

::ng-deep div.vis-tooltip {
  position: absolute;
  visibility: visible;
  padding: 5px;
  white-space: nowrap;
  color: #000000;
  background-color: #f5f4ed;

  -moz-border-radius: 3px;
  -webkit-border-radius: 3px;
  border-radius: 3px;
  border: 1px solid #808074;

  box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);
  pointer-events: none;

  z-index: 5;
}



</style>
<div class="layout-chunk" data-layout="l-body">
<style type="text/css">
body {line-height: 1;}
</style>
</div>
<div class="layout-chunk" data-layout="l-body">
<style type="text/css">
script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"
</style>
</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">
 $(document).ready(function() {
    $('body').prepend('<div class=\"zoomDiv\"><img src=\"\" class=\"zoomImg\"></div>');
    // onClick function for all plots (img's)
    $('img:not(.zoomImg)').click(function() {
      $('.zoomImg').attr('src', $(this).attr('src')).css({width: '100%'});
      $('.zoomDiv').css({opacity: '1', width: 'auto', border: '1px solid white', borderRadius: '5px', position: 'fixed', top: '50%', left: '50%', marginRight: '-50%', transform: 'translate(-50%, -50%)', boxShadow: '0px 0px 50px #888888', zIndex: '50', overflow: 'auto', maxHeight: '100%'});
    });
    // onClick function for zoomImg
    $('img.zoomImg').click(function() {
      $('.zoomDiv').css({opacity: '0', width: '0%'}); 
    });
  });
</script>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="loading-the-libraries">Loading the Libraries</h2>
<p>The following libraries will be loade to build the visuals.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://plotly-r.com'>plotly</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/cbail/textnets'>textnets</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/lepennec/ggwordcloud'>ggwordcloud</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/juliasilge/tidytext'>tidytext</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://datastorm-open.github.io/visNetwork/'>visNetwork</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/EmilHvitfeldt/textdata'>textdata</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://igraph.org'>igraph</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggraph.data-imaginist.com'>ggraph</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidygraph.data-imaginist.com'>tidygraph</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://kgjerde.github.io/corporaexplorer/'>corporaexplorer</a></span><span class='op'>)</span> 
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>topicmodels</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://github.com/dgrtwo/widyr'>widyr</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Corpora Explorer - To Analyze the Texts by Source <img src="https://kgjerde.github.io/corporaexplorer/" alt="GitHub Link" /></p>
<p>The documents were built into two corpus, one was built according to the source and the other was by the date.</p>
<p>The following two code can be run within R markdown to open the Shiny Application for document exploration by key word.</p>
<p>By source:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>all_news_by_source</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"Date"</span><span class='op'>=</span><span class='st'>"PUBLISHED"</span><span class='op'>)</span>

<span class='co'># This line of code adds in some details of the document in the document view. </span>

<span class='va'>all_news_by_source</span><span class='op'>$</span><span class='va'>Text</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>all_news_by_source</span><span class='op'>$</span><span class='va'>Date</span>, <span class='st'>"\n"</span>, 
                                 <span class='va'>all_news_by_source</span><span class='op'>$</span><span class='va'>AUTHOR</span>, <span class='st'>"\n"</span>,
                                 <span class='va'>all_news_by_source</span><span class='op'>$</span><span class='va'>NOTE</span>, <span class='st'>"\n"</span>, 
                                 <span class='va'>all_news_by_source</span><span class='op'>$</span><span class='va'>Text</span><span class='op'>)</span>

<span class='va'>all_news_by_source</span> <span class='op'>&lt;-</span> <span class='va'>all_news_by_source</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>Date</span><span class='op'>)</span>

<span class='va'>news_corpus_source</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://kgjerde.github.io/corporaexplorer/reference/prepare_data.html'>prepare_data</a></span><span class='op'>(</span>
                        dataset <span class='op'>=</span> <span class='va'>all_news_by_source</span>,
                        date_based_corpus <span class='op'>=</span> <span class='cn'>F</span>,
                        grouping_variable <span class='op'>=</span> <span class='st'>"SOURCE"</span><span class='op'>)</span>

<span class='fu'><a href='https://kgjerde.github.io/corporaexplorer/reference/explore.html'>explore</a></span><span class='op'>(</span><span class='va'>news_corpus_source</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Snapshot of Corpus by Source</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/include_graphics.html'>include_graphics</a></span><span class='op'>(</span><span class='st'>'images/5-Corpus.png'</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="images/5-Corpus.png" width="455" /></p>
</div>
<p>By Date:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>all_news_by_date</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"Date"</span><span class='op'>=</span><span class='st'>"PUBLISHED"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Date <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/date.html'>date</a></span><span class='op'>(</span><span class='va'>Date</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># This line of code adds in some details of the document in the document view. </span>
<span class='va'>all_news_by_date</span><span class='op'>$</span><span class='va'>Text</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>all_news_by_date</span><span class='op'>$</span><span class='va'>SOURCE</span>,
                               <span class='st'>": \n"</span>, 
                               <span class='va'>all_news_by_date</span><span class='op'>$</span><span class='va'>AUTHOR</span>, 
                               <span class='st'>"\n"</span>, 
                               <span class='va'>all_news_by_date</span><span class='op'>$</span><span class='va'>Text</span><span class='op'>)</span>

<span class='va'>news_corpus_date</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://kgjerde.github.io/corporaexplorer/reference/prepare_data.html'>prepare_data</a></span><span class='op'>(</span>
                      dataset <span class='op'>=</span> <span class='va'>all_news_by_date</span>,
                      date_based_corpus <span class='op'>=</span> <span class='cn'>T</span>,
                      grouping_variable <span class='op'>=</span> <span class='st'>"SOURCE"</span><span class='op'>)</span>

<span class='fu'><a href='https://kgjerde.github.io/corporaexplorer/reference/explore.html'>explore</a></span><span class='op'>(</span><span class='va'>news_corpus_date</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Snapshot of Corpus by Date</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="images/5-Corpus2.png" width="426" /></p>
</div>
<h2 id="building-the-visuals-for-question-1">Building the Visuals for Question 1</h2>
<p>For building the text network, the visTextNet function was used.</p>
<figure>
<img src="https://github.com/cbail/textnets" alt="" /><figcaption>Link</figcaption>
</figure>
<p>The function does the following:</p>
<ul>
<li>calculates the term frequency inverse document frequency of each word;</li>
<li>creates a weighted adjacency matrix where the rows and columns are the groups and the cells describe the sum of overlapping TFIDF between them;</li>
<li>creates an igraph object from this adjacency matrix.</li>
</ul>
<h3 id="editing-functions">Editing Functions</h3>
<p>The functions retrieved from GitHub were re-edited for building the text visuals:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>VisTextNet_e</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>text_network</span>, <span class='va'>alpha</span> <span class='op'>=</span> <span class='fl'>.25</span>, <span class='va'>label_degree_cut</span><span class='op'>=</span><span class='fl'>0</span>, <span class='va'>betweenness</span><span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/which_multiple.html'>has.multiple</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"textnets does not yet support multiple edges"</span><span class='op'>)</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>text_network</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/set_vertex_attr.html'>set_vertex_attr</a></span><span class='op'>(</span><span class='va'>text_network</span>, <span class='st'>"name"</span>, value <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gorder.html'>vcount</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>
  
  <span class='co'>#create network backbone </span>
  
  <span class='va'>e</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>as_data_frame</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span> <span class='op'>]</span>, 
             weight <span class='op'>=</span>   <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span><span class='op'>)</span>
  
  <span class='co'># in</span>
  <span class='va'>w_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/strength.html'>graph.strength</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
  <span class='va'>w_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>w_in</span><span class='op'>)</span>, <span class='va'>w_in</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>k_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
  <span class='va'>k_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>k_in</span><span class='op'>)</span>, <span class='va'>k_in</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  
  <span class='va'>e_in</span> <span class='op'>&lt;-</span> <span class='va'>e</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>w_in</span>, by <span class='op'>=</span> <span class='st'>"to"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>k_in</span>, by <span class='op'>=</span> <span class='st'>"to"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>alpha_in <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='op'>(</span><span class='va'>weight</span><span class='op'>/</span><span class='va'>w_in</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='va'>k_in</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='co'># out</span>
  
  <span class='va'>w_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/strength.html'>graph.strength</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"out"</span><span class='op'>)</span>
  <span class='va'>w_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>w_out</span><span class='op'>)</span>, <span class='va'>w_out</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>k_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"out"</span><span class='op'>)</span>
  <span class='va'>k_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>k_out</span><span class='op'>)</span>, <span class='va'>k_out</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  
  <span class='va'>e_out</span> <span class='op'>&lt;-</span> <span class='va'>e</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>w_out</span>, by <span class='op'>=</span> <span class='st'>"from"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>k_out</span>, by <span class='op'>=</span> <span class='st'>"from"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>alpha_out <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='op'>(</span><span class='va'>weight</span><span class='op'>/</span><span class='va'>w_out</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='va'>k_out</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>e_full</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>e_in</span>, <span class='va'>e_out</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"from"</span>, <span class='st'>"to"</span>, <span class='st'>"weight"</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>e_full</span> <span class='op'>&lt;-</span> <span class='va'>e_full</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>alpha_in</span> <span class='op'>&lt;</span> <span class='va'>alpha_out</span>, <span class='va'>alpha_in</span>, <span class='va'>alpha_out</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>from</span>, <span class='va'>to</span>, <span class='va'>alpha</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>alpha</span> <span class='op'>&lt;-</span> <span class='va'>e_full</span><span class='op'>$</span><span class='va'>alpha</span>
  
  <span class='va'>pruned</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/delete_edges.html'>delete.edges</a></span><span class='op'>(</span><span class='va'>text_network</span>, <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>alpha</span> <span class='op'>&gt;=</span> <span class='va'>alpha</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>pruned</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/delete_vertices.html'>delete.vertices</a></span><span class='op'>(</span><span class='va'>pruned</span>, <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
  
  
  <span class='co'># make degree for labelling most popular nodes</span>
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>degree</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span>
  
  <span class='co'># remove isolates</span>
  <span class='va'>isolates</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>]</span>
  <span class='va'>pruned</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/delete_vertices.html'>delete.vertices</a></span><span class='op'>(</span><span class='va'>pruned</span>, <span class='va'>isolates</span><span class='op'>)</span>
  
  <span class='co'># calculate modularity for coloring</span>
  <span class='va'>communities</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/cluster_louvain.html'>cluster_louvain</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span> 
  
  <span class='co'>#Cluster Lovain grouping was used for community detection as any text network is large in nature. </span>
  
  
  <span class='co'>#calculate betweenness for sizing nodes</span>
  <span class='va'>size</span> <span class='op'>&lt;-</span> <span class='fl'>25</span> <span class='co'>#default 25</span>
  
  <span class='kw'>if</span><span class='op'>(</span><span class='va'>betweenness</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>size</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/betweenness.html'>betweenness</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span> 
    
    <span class='va'>size</span> <span class='op'>&lt;-</span> <span class='va'>size</span><span class='op'>/</span><span class='fl'>0.95</span>
  <span class='op'>}</span>
  
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>community</span> <span class='op'>&lt;-</span> <span class='va'>communities</span><span class='op'>$</span><span class='va'>membership</span>
  
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>degree</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span>
  
  <span class='co'>## Changed Code: </span>
  <span class='va'>nodes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, 
                      title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Degree of Node: &lt;br&gt;"</span>,
                                     <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>degree</span><span class='op'>)</span>,
                      group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>community</span>,
                      size <span class='op'>=</span>  <span class='va'>size</span>
                      <span class='op'>)</span>
  
  <span class='va'>nodes</span> <span class='op'>&lt;-</span> <span class='va'>nodes</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>nodes</span><span class='op'>$</span><span class='va'>id</span>, decreasing <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>,<span class='op'>]</span>
  <span class='va'>nodes</span><span class='op'>$</span><span class='va'>shadow</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>
  <span class='va'>nodes</span> <span class='op'>&lt;-</span> <span class='va'>nodes</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>font.size <span class='op'>=</span> <span class='fl'>20</span>, font.weight<span class='op'>=</span> <span class='fl'>900</span><span class='op'>)</span> 
  <span class='va'>nodes</span><span class='op'>$</span><span class='va'>color.highlight.background</span> <span class='op'>&lt;-</span> <span class='st'>"brown"</span>

  <span class='va'>edges</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>get.data.frame</a></span><span class='op'>(</span><span class='va'>pruned</span>, what<span class='op'>=</span><span class='st'>"edges"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>
  <span class='va'>edges</span><span class='op'>$</span><span class='va'>value</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span>
  <span class='va'>nodes</span><span class='op'>$</span><span class='va'>color.highlight.background</span> <span class='op'>&lt;-</span> <span class='st'>"brown"</span> 

  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>nodes</span>, <span class='va'>edges</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visLayout.html'>visLayout</a></span><span class='op'>(</span>randomSeed <span class='op'>=</span> <span class='fl'>123</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visOptions.html'>visOptions</a></span><span class='op'>(</span>highlightNearest <span class='op'>=</span> <span class='cn'>TRUE</span>, 
               nodesIdSelection <span class='op'>=</span> <span class='cn'>TRUE</span>, 
               selectedBy <span class='op'>=</span> <span class='st'>"group"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>labelHighlightBold <span class='op'>=</span> <span class='cn'>T</span>, size<span class='op'>=</span><span class='fl'>20</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>layout <span class='op'>=</span> <span class='st'>'layout.davidson.harel'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visInteraction.html'>visInteraction</a></span><span class='op'>(</span>multiselect <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Similarly the Text Communities function was changed so as to return a dataframe of the communities and the names:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>TextComm_e</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>text_network</span>, <span class='va'>alpha</span> <span class='op'>=</span> <span class='fl'>.25</span>, <span class='va'>label_degree_cut</span><span class='op'>=</span><span class='fl'>0</span>, <span class='va'>betweenness</span><span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/which_multiple.html'>has.multiple</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"textnets does not yet support multiple edges"</span><span class='op'>)</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>text_network</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/set_vertex_attr.html'>set_vertex_attr</a></span><span class='op'>(</span><span class='va'>text_network</span>, <span class='st'>"name"</span>, value <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gorder.html'>vcount</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>
  
  <span class='co'>#create network backbone </span>
  
  <span class='va'>e</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>as_data_frame</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span> <span class='op'>]</span>, 
             weight <span class='op'>=</span>   <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span><span class='op'>)</span>
  
  <span class='co'># in</span>
  <span class='va'>w_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/strength.html'>graph.strength</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
  <span class='va'>w_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>w_in</span><span class='op'>)</span>, <span class='va'>w_in</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>k_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
  <span class='va'>k_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>k_in</span><span class='op'>)</span>, <span class='va'>k_in</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  
  <span class='va'>e_in</span> <span class='op'>&lt;-</span> <span class='va'>e</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>w_in</span>, by <span class='op'>=</span> <span class='st'>"to"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>k_in</span>, by <span class='op'>=</span> <span class='st'>"to"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>alpha_in <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='op'>(</span><span class='va'>weight</span><span class='op'>/</span><span class='va'>w_in</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='va'>k_in</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='co'># out</span>
  
  <span class='va'>w_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/strength.html'>graph.strength</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"out"</span><span class='op'>)</span>
  <span class='va'>w_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>w_out</span><span class='op'>)</span>, <span class='va'>w_out</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>k_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"out"</span><span class='op'>)</span>
  <span class='va'>k_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>k_out</span><span class='op'>)</span>, <span class='va'>k_out</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  
  <span class='va'>e_out</span> <span class='op'>&lt;-</span> <span class='va'>e</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>w_out</span>, by <span class='op'>=</span> <span class='st'>"from"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>k_out</span>, by <span class='op'>=</span> <span class='st'>"from"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>alpha_out <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='op'>(</span><span class='va'>weight</span><span class='op'>/</span><span class='va'>w_out</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='va'>k_out</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>e_full</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>e_in</span>, <span class='va'>e_out</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"from"</span>, <span class='st'>"to"</span>, <span class='st'>"weight"</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>e_full</span> <span class='op'>&lt;-</span> <span class='va'>e_full</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>alpha_in</span> <span class='op'>&lt;</span> <span class='va'>alpha_out</span>, <span class='va'>alpha_in</span>, <span class='va'>alpha_out</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>from</span>, <span class='va'>to</span>, <span class='va'>alpha</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>alpha</span> <span class='op'>&lt;-</span> <span class='va'>e_full</span><span class='op'>$</span><span class='va'>alpha</span>
  
  <span class='va'>pruned</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/delete_edges.html'>delete.edges</a></span><span class='op'>(</span><span class='va'>text_network</span>, <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>alpha</span> <span class='op'>&gt;=</span> <span class='va'>alpha</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>pruned</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/delete_vertices.html'>delete.vertices</a></span><span class='op'>(</span><span class='va'>pruned</span>, <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
  
  
  <span class='co'># make degree for labelling most popular nodes</span>
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>degree</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span>
  
  <span class='co'># remove isolates</span>
  <span class='va'>isolates</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>]</span>
  <span class='va'>pruned</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/delete_vertices.html'>delete.vertices</a></span><span class='op'>(</span><span class='va'>pruned</span>, <span class='va'>isolates</span><span class='op'>)</span>
  
  <span class='va'>communities</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/cluster_louvain.html'>cluster_louvain</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span>

  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>community</span> <span class='op'>&lt;-</span> <span class='va'>communities</span><span class='op'>$</span><span class='va'>membership</span>
  
  <span class='co'>## Changed Code:</span>
  
  <span class='va'>output</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>communities</span><span class='op'>$</span><span class='va'>names</span>, 
                             <span class='va'>communities</span><span class='op'>$</span><span class='va'>membership</span><span class='op'>)</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>output</span><span class='op'>)</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SOURCE"</span>,<span class='st'>"Membership"</span><span class='op'>)</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>output</span><span class='op'>)</span>

<span class='op'>}</span>
</code></pre>
</div>
</div>
<h3 id="creating-the-visnetwork-for-texts">Creating the VisNetwork for Texts</h3>
<ol type="1">
<li>First, the common words are sieved out. This will included words such as GasTech, POK, that might skew the data.This data frame will be called <code>common_words</code></li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>common_words</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>,<span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'>count</span><span class='op'>(</span><span class='va'>word</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>&gt;</span><span class='fl'>200</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>lexicon <span class='op'>=</span> <span class='st'>"CUSTOM"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Bind it to the <code>stop_words</code> dataframe</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>stop_words2</span> <span class='op'>&lt;-</span> <span class='va'>stop_words</span> <span class='op'>%&gt;%</span> 
                <span class='fu'>bind_rows</span><span class='op'>(</span><span class='va'>common_words</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<ol start="3" type="1">
<li><p>Next, we will create two dataframe. One from 1998 - 2014 (for analysis purpose), and the other in 2014(solely for exploratory purpose)</p>
<p>This is done as new sources such as “Modern Rubicon”, “Centrum Sentinel” and “Tethy News” will solely reporting in 2014 i.e. the kidnapping event.</p>
<p>In addition to that, some news sources such as “The International Times” were reporting as early as 1982.</p>
<p>To prevent skewing of the data, the period was split into such.</p>
<p>Other notions for the lines of code are marked as comments in the code chunk below:</p></li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>clean_news_before</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fl'>1998</span> <span class='op'>&lt;=</span> <span class='fu'>year</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span>,
                             <span class='fu'>year</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>&lt;</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'># Remove any digits</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'># Make all lower case</span>
                      <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'># antijoin will preserve all words that appear in df.news that do not appear in stop_word</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>word <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>word</span>, collapse <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># So that each new source is a single row and the column word contains all the words across the articules</span>

<span class='va'>clean_news_2014</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>year</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>==</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>word <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>word</span>, collapse <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Building the Text Network object for the period 1998-2014</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>text_grouped</span> <span class='op'>&lt;-</span> <span class='va'>clean_news_before</span> <span class='op'>%&gt;%</span> 
                <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span>

<span class='va'>news_before</span> <span class='op'>&lt;-</span> <span class='fu'>PrepText</span><span class='op'>(</span><span class='va'>text_grouped</span>, 
                         groupvar <span class='op'>=</span> <span class='st'>"SOURCE"</span>, 
                         textvar <span class='op'>=</span> <span class='st'>"word"</span>, 
                         node_type <span class='op'>=</span> <span class='st'>"groups"</span>, 
                         tokenizer <span class='op'>=</span> <span class='st'>"words"</span>, 
                         pos <span class='op'>=</span> <span class='st'>"nouns"</span>, 
                         remove_stop_words <span class='op'>=</span> <span class='cn'>TRUE</span>, 
                         compound_nouns <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>text_network_before</span> <span class='op'>&lt;-</span> <span class='fu'>CreateTextnet</span><span class='op'>(</span><span class='va'>news_before</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<ol start="5" type="1">
<li>Visualising the Text Network</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>390</span><span class='op'>)</span>
<span class='fu'>VisTextNet_e</span><span class='op'>(</span><span class='va'>text_network_before</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-d93c111a3daed531e03c" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-d93c111a3daed531e03c">{"x":{"nodes":{"id":["All News Today","Athena Speaks","Central Bulletin","Daily Pegasus","Everyday News","Homeland Illumination","International News","International Times","Kronos Star","News Desk","News Online Today","The Abila Post","The Continent","The Explainer","The General Post","The Guide","The Light of Truth","The Orb","The Truth","The Tulip","The World","The Wrap","Who What News","World Journal","World Source","Worldwise"],"title":["Degree of Node: <br>5","Degree of Node: <br>5","Degree of Node: <br>7","Degree of Node: <br>4","Degree of Node: <br>4","Degree of Node: <br>5","Degree of Node: <br>6","Degree of Node: <br>5","Degree of Node: <br>6","Degree of Node: <br>7","Degree of Node: <br>8","Degree of Node: <br>5","Degree of Node: <br>6","Degree of Node: <br>6","Degree of Node: <br>5","Degree of Node: <br>5","Degree of Node: <br>4","Degree of Node: <br>4","Degree of Node: <br>8","Degree of Node: <br>7","Degree of Node: <br>4","Degree of Node: <br>8","Degree of Node: <br>4","Degree of Node: <br>4","Degree of Node: <br>5","Degree of Node: <br>5"],"group":[1,3,3,1,4,1,2,4,2,3,1,3,4,3,5,2,5,1,2,5,5,1,5,4,4,2],"size":[25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],"shadow":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"font.size":[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],"font.weight":[900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900],"color.highlight.background":["brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown"],"label":["All News Today","Athena Speaks","Central Bulletin","Daily Pegasus","Everyday News","Homeland Illumination","International News","International Times","Kronos Star","News Desk","News Online Today","The Abila Post","The Continent","The Explainer","The General Post","The Guide","The Light of Truth","The Orb","The Truth","The Tulip","The World","The Wrap","Who What News","World Journal","World Source","Worldwise"],"x":[-0.413761175849553,-1,-0.754743776151343,-0.894777761111636,1,-0.62915922904155,-0.196389908337728,0.334063384280372,-0.51046183137943,-0.656617509218177,-0.207283028509332,-0.959823895442572,0.840354250135174,-0.537692863170663,0.286728672107991,-0.291861776582472,0.482536470605055,-0.510557904769394,0.0493948362432457,0.0551223139353003,0.0535736527940964,-0.196839635332773,0.306725248222457,0.606557344721306,0.817036529703439,-0.0516218161900979],"y":[-0.423021301502743,0.728144874411058,0.486461224689636,-0.604813845854935,0.482437398270597,-0.64881363051593,0.663148561980747,0.224578953536622,0.732291966902484,0.188165393648341,0.132203793112386,0.0797990523754528,0.243178483468411,0.427977366364092,-0.576677921748198,1,-0.815662057776873,-0.878453892529442,0.42644987729886,-0.541042595251509,-0.897331679447066,-0.471187419594033,-1,0.169213655948973,-0.0957223970066993,0.924981384917807]},"edges":{"from":["All News Today","All News Today","All News Today","All News Today","All News Today","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Daily Pegasus","Daily Pegasus","Daily Pegasus","Everyday News","Everyday News","Everyday News","Everyday News","Homeland Illumination","Homeland Illumination","Homeland Illumination","International News","International News","International News","International News","International News","International Times","International Times","International Times","International Times","Kronos Star","Kronos Star","Kronos Star","Kronos Star","News Desk","News Desk","News Desk","News Desk","News Desk","News Online Today","News Online Today","The Abila Post","The Continent","The Continent","The Continent","The Continent","The Explainer","The Explainer","The General Post","The General Post","The General Post","The General Post","The Guide","The Guide","The Light of Truth","The Light of Truth","The Light of Truth","The Orb","The Truth","The Truth","The Truth","The Tulip","The Tulip","The Tulip","The World","World Journal"],"to":["Daily Pegasus","Homeland Illumination","News Online Today","The Orb","The Wrap","Central Bulletin","News Desk","The Abila Post","The Explainer","Worldwise","International News","Kronos Star","News Desk","News Online Today","The Abila Post","The Explainer","Homeland Illumination","The Orb","The Wrap","International Times","The Continent","World Journal","World Source","News Online Today","The Orb","The Wrap","Kronos Star","News Online Today","The Guide","The Truth","Worldwise","News Online Today","The Continent","World Journal","World Source","News Online Today","The Guide","The Truth","Worldwise","The Abila Post","The Explainer","The Truth","The Tulip","The Wrap","The Abila Post","World Source","The Explainer","The Truth","The Wrap","World Journal","World Source","The General Post","The Guide","The Light of Truth","The Tulip","The World","Who What News","The Truth","Worldwise","The Tulip","The World","Who What News","The Wrap","The Tulip","The Wrap","Worldwise","The World","The Wrap","Who What News","Who What News","World Source"],"value":[0.00156162744667993,0.00267032446242905,0.00115483769166408,0.00148798624872667,0.00139937938054064,0.00197286674383265,0.00184509822238823,0.00195494975427119,0.00170566986858221,0.00112080859457602,0.000987044946787035,0.000936701596860749,0.00189407573472961,0.00131782358430141,0.0049229392197231,0.00215577196461759,0.00165442260839225,0.00177755635503322,0.00143911511913888,0.00293200114507338,0.00243895223108253,0.00234559795398315,0.00177942757483524,0.00111480290264119,0.00158727090346751,0.00143909437794666,0.00273443083615598,0.000946827404075986,0.00141255267188061,0.00120055277758705,0.00135461407974346,0.00149932621505372,0.00347057769438888,0.00254512478027435,0.00333993987974456,0.000926489985148059,0.00175302105444171,0.00152311156390034,0.00158098304071077,0.00184259093771528,0.00150532127209725,0.00175325748906283,0.00142336551524023,0.00113335170853075,0.0011831435286209,0.00112527357294344,0.00202067889361045,0.00110599687588991,0.000874150736208628,0.00248760752546771,0.00200473896410157,0.00105664760906249,0.00121011705293451,0.00338613626270459,0.00323266847034943,0.00383175100488151,0.00302682703217745,0.00135174912881923,0.00157344601925656,0.00316648388755249,0.00447843376093827,0.00380552683299899,0.00164899675931867,0.000909756837683135,0.00118177073572284,0.00150505525453812,0.00413159600795348,0.000891181085391255,0.00340435693776371,0.00730186529029193,0.00154997819131858]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","size":20,"labelHighlightBold":true,"physics":false},"manipulation":{"enabled":false},"layout":{"randomSeed":123},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"multiselect":true}},"groups":["1","3","4","2","5"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":[1,2,3,4,5]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
<ol start="6" type="1">
<li>Building the Text Network object for the period 2014</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>text_grouped2</span> <span class='op'>&lt;-</span> <span class='va'>clean_news_2014</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span>

<span class='va'>new_2014</span> <span class='op'>&lt;-</span> <span class='fu'>PrepText</span><span class='op'>(</span><span class='va'>text_grouped2</span>, 
                         groupvar <span class='op'>=</span> <span class='st'>"SOURCE"</span>, 
                         textvar <span class='op'>=</span> <span class='st'>"word"</span>, 
                         node_type <span class='op'>=</span> <span class='st'>"groups"</span>, 
                         tokenizer <span class='op'>=</span> <span class='st'>"words"</span>, 
                         pos <span class='op'>=</span> <span class='st'>"nouns"</span>, 
                         remove_stop_words <span class='op'>=</span> <span class='cn'>TRUE</span>, 
                         compound_nouns <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>text_network_2014</span> <span class='op'>&lt;-</span> <span class='fu'>CreateTextnet</span><span class='op'>(</span><span class='va'>new_2014</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<ol start="7" type="1">
<li>Visualising the Text Network</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>99</span><span class='op'>)</span>
<span class='fu'>VisTextNet_e</span><span class='op'>(</span><span class='va'>text_network_2014</span>, label_degree_cut <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> 
</code></pre>
</div>
<div id="htmlwidget-75a7d71d1404043b5c86" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-75a7d71d1404043b5c86">{"x":{"nodes":{"id":["All News Today","Athena Speaks","Central Bulletin","Centrum Sentinel","Daily Pegasus","Everyday News","Homeland Illumination","International News","International Times","Kronos Star","Modern Rubicon","News Desk","News Online Today","Tethys News","The Abila Post","The Continent","The Explainer","The General Post","The Guide","The Light of Truth","The Orb","The Truth","The Tulip","The World","The Wrap","Who What News","World Journal","World Source","Worldwise"],"title":["Degree of Node: <br>6","Degree of Node: <br>7","Degree of Node: <br>8","Degree of Node: <br>3","Degree of Node: <br>3","Degree of Node: <br>4","Degree of Node: <br>4","Degree of Node: <br>6","Degree of Node: <br>5","Degree of Node: <br>8","Degree of Node: <br>3","Degree of Node: <br>6","Degree of Node: <br>9","Degree of Node: <br>4","Degree of Node: <br>7","Degree of Node: <br>5","Degree of Node: <br>6","Degree of Node: <br>6","Degree of Node: <br>4","Degree of Node: <br>5","Degree of Node: <br>6","Degree of Node: <br>6","Degree of Node: <br>7","Degree of Node: <br>5","Degree of Node: <br>8","Degree of Node: <br>6","Degree of Node: <br>4","Degree of Node: <br>6","Degree of Node: <br>5"],"group":[4,3,3,1,4,5,1,2,5,1,1,3,3,1,1,5,3,3,2,3,4,2,3,3,4,3,5,5,2],"size":[25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],"shadow":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"font.size":[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],"font.weight":[900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900],"color.highlight.background":["brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown"],"label":["All News Today","Athena Speaks","Central Bulletin","Centrum Sentinel","Daily Pegasus","Everyday News","Homeland Illumination","International News","International Times","Kronos Star","Modern Rubicon","News Desk","News Online Today","Tethys News","The Abila Post","The Continent","The Explainer","The General Post","The Guide","The Light of Truth","The Orb","The Truth","The Tulip","The World","The Wrap","Who What News","World Journal","World Source","Worldwise"],"x":[0.0090030698337229,0.234259129331518,0.37296991469885,-1,0.193959689167201,0.312912917827893,-0.658075215940575,-0.505001296513942,0.419772383177956,-0.806406519860532,-0.690618297550431,-0.0141625294152617,0.762257933586234,-0.756327385174475,-0.192037603236728,0.610458936250426,0.330854793407002,0.672328645745457,-0.848477675209298,0.738147267135546,-0.264526993444341,-0.340942590507063,0.587095289683014,0.567769850803818,0.395749167234493,1,0.379433229251184,0.0131578514549637,-0.586728158012316],"y":[-0.282735736795384,0.390290060330806,1,0.410905791060646,0.0256257381151228,-0.643429822898142,0.0969452999956686,-0.712592370077541,-0.485432649360427,-0.270526497893207,0.725244912456887,0.35312580232208,-0.0290973213874771,0.41859316497238,0.58478026429872,-1,0.545738705063924,0.85168794791769,-0.561182152212106,0.595727741143318,0.035558872185097,-0.202239199605824,0.3066753959874,0.659257960836214,-0.0569908576922096,0.820714342444053,-0.821938766990792,-0.697754121175437,-0.485323984913442]},"edges":{"from":["All News Today","All News Today","All News Today","All News Today","All News Today","All News Today","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Athena Speaks","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Central Bulletin","Centrum Sentinel","Centrum Sentinel","Centrum Sentinel","Daily Pegasus","Daily Pegasus","Everyday News","Everyday News","Everyday News","Everyday News","Homeland Illumination","Homeland Illumination","International News","International News","International News","International News","International News","International Times","International Times","International Times","International Times","Kronos Star","Kronos Star","Kronos Star","Kronos Star","Kronos Star","Kronos Star","Modern Rubicon","Modern Rubicon","News Desk","News Desk","News Desk","News Desk","News Online Today","News Online Today","News Online Today","News Online Today","Tethys News","The Abila Post","The Continent","The Continent","The Continent","The Explainer","The General Post","The General Post","The General Post","The General Post","The Guide","The Guide","The Light of Truth","The Light of Truth","The Light of Truth","The Orb","The Orb","The Truth","The Truth","The Truth","The Tulip","The Tulip","The Tulip","The World","World Journal"],"to":["Daily Pegasus","Homeland Illumination","International News","News Online Today","The Orb","The Wrap","Central Bulletin","News Desk","News Online Today","The Abila Post","The Explainer","The Light of Truth","The Orb","News Desk","News Online Today","The Abila Post","The Explainer","The General Post","The World","Who What News","Homeland Illumination","Modern Rubicon","Tethys News","The Orb","The Wrap","International Times","The Continent","World Journal","World Source","Kronos Star","The Orb","Kronos Star","News Online Today","The Guide","The Truth","Worldwise","News Online Today","The Continent","World Journal","World Source","Tethys News","The Abila Post","The Guide","The Truth","World Source","Worldwise","Tethys News","The Abila Post","The Abila Post","The Explainer","The Tulip","The Wrap","The Explainer","The Wrap","Who What News","World Source","The Abila Post","The Explainer","The Wrap","World Journal","World Source","The General Post","The Light of Truth","The Tulip","The World","Who What News","The Truth","Worldwise","The Tulip","The World","Who What News","The Wrap","Worldwise","The Tulip","The Wrap","Worldwise","The World","The Wrap","Who What News","Who What News","World Source"],"value":[0.0160298826094453,0.00878370063562516,0.00471125382950078,0.0103572856599703,0.0252484554103783,0.0419165869259229,0.00476635168675798,0.0102615273224692,0.0045526081117884,0.005908558439243,0.00918865112100369,0.00641143250109285,0.00473889400945304,0.00543618440793671,0.00622404688098076,0.00661615515918009,0.00576735365574495,0.00510938428691398,0.00474443527522902,0.00602124839147969,0.00981615766199576,0.0159185503666337,0.0141467140032279,0.0142326241625124,0.0150778065462614,0.00363579534874758,0.0080588091530349,0.010019730438558,0.00256289864396314,0.0039387281191265,0.00475176545616622,0.00775515012984981,0.00507037865034193,0.0114558422160912,0.0116055984334645,0.0105698161262255,0.0047775638082416,0.00434774935757406,0.00504850636912421,0.0223631101995694,0.0520024515356954,0.0197492548110723,0.00520803763488444,0.00488525957285427,0.00369890716096897,0.00522394803227689,0.0157798336099964,0.00532883547678585,0.00562457727847846,0.00898551463794424,0.00965259045710242,0.00595573927581586,0.00458022268211378,0.00535515557135,0.00511898022950154,0.00508984204998859,0.0232414737866012,0.00541448026687664,0.00429309457924335,0.0136403426023258,0.00368808249692659,0.00563152742275226,0.00979924613843739,0.00669562350579734,0.0127158724867341,0.0104493261438527,0.0101099896042248,0.0111225827303726,0.00881970051031607,0.0115237243097003,0.00825828134482609,0.0298572176215829,0.00543921036390944,0.00538238561420618,0.0139351337043452,0.00973524058206597,0.00793423400000634,0.00973373620561474,0.00852055244582107,0.0175242903921269,0.00372825837147587]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","size":20,"labelHighlightBold":true,"physics":false},"manipulation":{"enabled":false},"layout":{"randomSeed":123},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"multiselect":true}},"groups":["4","3","1","5","2"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":[1,2,3,4,5]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
<h3 id="creating-the-correlation-plot-of-sources">Creating the Correlation Plot of Sources</h3>
<p>The correlation plot will give an idea of the most similiar new sources based on the word and their counts. <br> As we did before, they will be split into two time periods, while the latter is more for exploration purposes.</p>
<ol type="1">
<li>Create the dataframe of the counts</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>clean_news_before_count</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fl'>1998</span> <span class='op'>&lt;=</span> <span class='fu'>year</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span>,
                                   <span class='fu'>year</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>&lt;</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                            <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>word</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/sample_n.html'>sample_n</a></span><span class='op'>(</span><span class='va'>clean_news_before_count</span>,<span class='fl'>10</span><span class='op'>)</span>, <span class='st'>"simple"</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">SOURCE</th>
<th style="text-align: left;">word</th>
<th style="text-align: right;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">World Source</td>
<td style="text-align: left;">dispatched</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Everyday News</td>
<td style="text-align: left;">detergent</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kronos Star</td>
<td style="text-align: left;">car</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Homeland Illumination</td>
<td style="text-align: left;">plan</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Wrap</td>
<td style="text-align: left;">griffith</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">The Tulip</td>
<td style="text-align: left;">contributed</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Guide</td>
<td style="text-align: left;">master</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">The World</td>
<td style="text-align: left;">times</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">News Online Today</td>
<td style="text-align: left;">improve</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">The Abila Post</td>
<td style="text-align: left;">leveled</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<ol start="2" type="1">
<li>Create the correlation dataframe</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>newsgroup_cors</span> <span class='op'>&lt;-</span> <span class='va'>clean_news_before_count</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://rdrr.io/pkg/widyr/man/pairwise_cor.html'>pairwise_cor</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, 
                               <span class='va'>word</span>, 
                               <span class='va'>count</span>, 
                               sort <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/sample_n.html'>sample_n</a></span><span class='op'>(</span><span class='va'>newsgroup_cors</span>,<span class='fl'>5</span><span class='op'>)</span>, <span class='st'>"simple"</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">item1</th>
<th style="text-align: left;">item2</th>
<th style="text-align: right;">correlation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">News Online Today</td>
<td style="text-align: left;">The Wrap</td>
<td style="text-align: right;">0.3988099</td>
</tr>
<tr class="even">
<td style="text-align: left;">Everyday News</td>
<td style="text-align: left;">Homeland Illumination</td>
<td style="text-align: right;">0.1211655</td>
</tr>
<tr class="odd">
<td style="text-align: left;">World Source</td>
<td style="text-align: left;">The Abila Post</td>
<td style="text-align: right;">0.1979165</td>
</tr>
<tr class="even">
<td style="text-align: left;">The Orb</td>
<td style="text-align: left;">Homeland Illumination</td>
<td style="text-align: right;">0.6888076</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Light of Truth</td>
<td style="text-align: left;">The World</td>
<td style="text-align: right;">0.6575972</td>
</tr>
</tbody>
</table>
</div>
<ol start="3" type="1">
<li>Creating the ggplot object</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>corr_plot_before</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>newsgroup_cors</span><span class='op'>)</span> <span class='op'>+</span>
                      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_tile</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>item1</span>, y<span class='op'>=</span><span class='va'>item2</span>, fill<span class='op'>=</span><span class='va'>correlation</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
                      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_brewer.html'>scale_fill_distiller</a></span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Spectral"</span><span class='op'>)</span> <span class='op'>+</span>
                      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>""</span>,
                           y<span class='op'>=</span><span class='st'>" "</span>, 
                           title <span class='op'>=</span> <span class='st'>"Correlations of New Sources from 1998 to 2014"</span>,
                           fill <span class='op'>=</span> <span class='st'>"Correlation"</span><span class='op'>)</span> <span class='op'>+</span>
                      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>90</span>, 
                                                       vjust <span class='op'>=</span> <span class='fl'>0.5</span>,
                                                       hjust<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>, 
                            panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill<span class='op'>=</span><span class='st'>"white"</span><span class='op'>)</span>,
                            panel.grid.major.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                            panel.grid.major.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                            axis.ticks <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"grey"</span><span class='op'>)</span>,
                            plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>15</span><span class='op'>)</span>
                            <span class='op'>)</span> <span class='co'>#+</span>
                      <span class='co'>#ggsave(filename = "images/1-corrplot.png",</span>
                      <span class='co'>#       width = 20, </span>
                      <span class='co'>#       units = "cm")</span>
<span class='va'>corr_plot_before</span>
</code></pre>
</div>
<p><img src="Build_files/figure-html5/unnamed-chunk-20-1.png" width="624" /></p>
</div>
<ol start="4" type="1">
<li>Repeat the same for 2014</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>clean_news_2014_count</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>year</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>2014</span>, <span class='fu'>month</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>word</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>newsgroup_cors_2014</span> <span class='op'>&lt;-</span> <span class='va'>clean_news_2014_count</span> <span class='op'>%&gt;%</span>
                        <span class='fu'><a href='https://rdrr.io/pkg/widyr/man/pairwise_cor.html'>pairwise_cor</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, 
                                     <span class='va'>word</span>, 
                                     <span class='va'>count</span>, 
                                     sort <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>corr_plot_2014</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>newsgroup_cors_2014</span><span class='op'>)</span> <span class='op'>+</span>
                  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_tile.html'>geom_tile</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>item1</span>, y<span class='op'>=</span><span class='va'>item2</span>, fill<span class='op'>=</span><span class='va'>correlation</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
                  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>90</span>, 
                                                   vjust <span class='op'>=</span> <span class='fl'>0.5</span>,
                                                   hjust<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
                  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_brewer.html'>scale_fill_distiller</a></span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Spectral"</span><span class='op'>)</span> <span class='op'>+</span>
                  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>""</span>,
                       y<span class='op'>=</span><span class='st'>" "</span>, 
                       title <span class='op'>=</span> <span class='st'>"Correlations of New Sources in 2014"</span>,
                       fill <span class='op'>=</span> <span class='st'>"Correlation"</span><span class='op'>)</span> <span class='op'>+</span>
                  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill<span class='op'>=</span><span class='st'>"white"</span><span class='op'>)</span>,
                        panel.grid.major.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                        panel.grid.major.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                        axis.ticks <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"grey"</span><span class='op'>)</span>,
                        plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>15</span><span class='op'>)</span>
                        <span class='op'>)</span> <span class='co'>#+</span>
                  <span class='co'>#ggsave(filename = "images/1-corrplot2.png",</span>
                  <span class='co'>#       width = 20, </span>
                  <span class='co'>#       units = "cm")</span>
<span class='co'>#corr_plot_2014</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="understanding-the-authors-links">Understanding the Author’s Links</h3>
<ol type="1">
<li>Create the Author table</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>author_links</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>,<span class='va'>AUTHOR</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>Count <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>AUTHOR</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"from"</span> <span class='op'>=</span> <span class='st'>"AUTHOR"</span>,
                       <span class='st'>"to"</span><span class='op'>=</span><span class='st'>"SOURCE"</span>,
                       <span class='st'>"value"</span><span class='op'>=</span><span class='st'>"Count"</span><span class='op'>)</span>
<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>author_links</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">to</th>
<th style="text-align: left;">from</th>
<th style="text-align: right;">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">All News Today</td>
<td style="text-align: left;">Petrus Gerhard</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Athena Speaks</td>
<td style="text-align: left;">Haneson Ngohebo</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Homeland Illumination</td>
<td style="text-align: left;">Maha Salo</td>
<td style="text-align: right;">46</td>
</tr>
<tr class="even">
<td style="text-align: left;">Homeland Illumination</td>
<td style="text-align: left;">Petrus Gerhard</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kronos Star</td>
<td style="text-align: left;">Cato Rossini</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
<ol start="2" type="1">
<li>Create the visNetwork object</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>g_author</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span><span class='va'>author_links</span>, directed<span class='op'>=</span><span class='cn'>F</span><span class='op'>)</span>

<span class='va'>data_author</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html'>toVisNetworkData</a></span><span class='op'>(</span><span class='va'>g_author</span><span class='op'>)</span> 


<span class='va'>data_author</span><span class='op'>$</span><span class='va'>nodes</span><span class='op'>$</span><span class='va'>color</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>data_author</span><span class='op'>$</span><span class='va'>nodes</span><span class='op'>$</span><span class='va'>id</span> <span class='op'>%in%</span> 
                                    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"The Explainer"</span>, 
                                      <span class='st'>"Athena Speaks"</span>, 
                                      <span class='st'>"News Desk"</span>,
                                      <span class='st'>"The Abila Post"</span><span class='op'>)</span>,
                                      <span class='st'>"#ffff00"</span>,
                                  <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>data_author</span><span class='op'>$</span><span class='va'>nodes</span><span class='op'>$</span><span class='va'>id</span> <span class='op'>%in%</span> 
                                           <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Kronos Star"</span><span class='op'>)</span>,
                                         <span class='st'>"#7be141"</span>,
                                         <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>data_author</span><span class='op'>$</span><span class='va'>nodes</span><span class='op'>$</span><span class='va'>id</span> <span class='op'>%in%</span> 
                                                  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"News Online Today"</span>,
                                                    <span class='st'>"Homeland Illumination"</span>,
                                                    <span class='st'>"All News Today"</span><span class='op'>)</span>,
                                                <span class='st'>"#97c2fc"</span>,
                                                <span class='st'>"#e0e0e0"</span><span class='op'>)</span>
                                          <span class='op'>)</span>
                                 <span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>data_author</span><span class='op'>$</span><span class='va'>nodes</span>, 
           <span class='va'>data_author</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>font <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span><span class='fl'>18</span><span class='op'>)</span>, 
           size <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-75c7e5400d7ad6a77594" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-75c7e5400d7ad6a77594">{"x":{"nodes":{"id":["All News Today","Athena Speaks","Homeland Illumination","Kronos Star","News Desk","News Online Today","The Abila Post","The Explainer","Petrus Gerhard","Haneson Ngohebo","Maha Salo","Cato Rossini","Cato Rossini, Marcella Trapani","Donato Petri","Eva Thayer","Lelio Masin","Marcella Trapani"],"label":["All News Today","Athena Speaks","Homeland Illumination","Kronos Star","News Desk","News Online Today","The Abila Post","The Explainer","Petrus Gerhard","Haneson Ngohebo","Maha Salo","Cato Rossini","Cato Rossini, Marcella Trapani","Donato Petri","Eva Thayer","Lelio Masin","Marcella Trapani"],"color":["#97c2fc","#ffff00","#97c2fc","#7be141","#ffff00","#97c2fc","#ffff00","#ffff00","#e0e0e0","#e0e0e0","#e0e0e0","#e0e0e0","#e0e0e0","#e0e0e0","#e0e0e0","#e0e0e0","#e0e0e0"],"x":[1,-0.133650593854552,0.817075546557372,-0.617326144711926,0.368807779574087,0.505050732535916,0.145894981821158,-0.486814325560919,0.687616826176237,-0.0524640624805169,0.954487832540075,-1,-0.211905213408212,-0.27337206372952,-0.98906604248968,-0.627204946438928,-0.646478283734024],"y":[-0.739276650531423,1,-0.235894787752512,-0.551776310814424,0.753434532323714,-1,0.356543817420035,0.649919117392046,-0.645280892307449,0.670472580825349,0.101555954938116,-0.676077975946858,-0.429111833207048,-0.890002804149441,-0.237510596027591,-0.102505739265994,-0.997150347757172]},"edges":{"from":["All News Today","Athena Speaks","Homeland Illumination","Homeland Illumination","Kronos Star","Kronos Star","Kronos Star","Kronos Star","Kronos Star","Kronos Star","News Desk","News Online Today","The Abila Post","The Explainer"],"to":["Petrus Gerhard","Haneson Ngohebo","Maha Salo","Petrus Gerhard","Cato Rossini","Cato Rossini, Marcella Trapani","Donato Petri","Eva Thayer","Lelio Masin","Marcella Trapani","Haneson Ngohebo","Petrus Gerhard","Haneson Ngohebo","Haneson Ngohebo"],"value":[1,1,46,18,1,35,5,5,3,13,1,3,31,1]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false,"size":20,"font":{"size":18}},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="tf-idf-of-news-sources">TF-IDF of News sources</h3>
<ol type="1">
<li><p>Set up the re-order func that is able to sort the facet’s in descending order</p>
<figure>
<img src="https://github.com/dgrtwo/drlib/blob/master/R/reorder_within.R" alt="" /><figcaption>Link</figcaption>
</figure></li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>reorder_within</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>by</span>, <span class='va'>within</span>, <span class='va'>fun</span> <span class='op'>=</span> <span class='va'>mean</span>, <span class='va'>sep</span> <span class='op'>=</span> <span class='st'>"___"</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>new_x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>within</span>, sep <span class='op'>=</span> <span class='va'>sep</span><span class='op'>)</span>
  <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>new_x</span>, <span class='va'>by</span>, FUN <span class='op'>=</span> <span class='va'>fun</span><span class='op'>)</span>
<span class='op'>}</span>


<span class='va'>scale_x_reordered</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>sep</span> <span class='op'>=</span> <span class='st'>"___"</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>reg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>sep</span>, <span class='st'>".+$"</span><span class='op'>)</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_x_discrete</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='va'>reg</span>, <span class='st'>""</span>, <span class='va'>x</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>scale_y_reordered</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span>, <span class='va'>sep</span> <span class='op'>=</span> <span class='st'>"___"</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>reg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>sep</span>, <span class='st'>".+$"</span><span class='op'>)</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_discrete.html'>scale_y_discrete</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='va'>reg</span>, <span class='st'>""</span>, <span class='va'>x</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<ol type="1">
<li>Create the TF-IDF Dataframe using the <code>tidytext</code> package:</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tf_idf</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fl'>1998</span> <span class='op'>&lt;=</span> <span class='fu'>year</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span>,
                 <span class='fu'>year</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>&lt;</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>word</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'>count</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/bind_tf_idf.html'>bind_tf_idf</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>SOURCE</span>, <span class='va'>n</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/top_n.html'>top_n</a></span><span class='op'>(</span><span class='fl'>7</span>,wt<span class='op'>=</span><span class='va'>tf_idf</span><span class='op'>)</span> 

<span class='fu'><a href='https://dplyr.tidyverse.org/reference/sample_n.html'>sample_n</a></span><span class='op'>(</span><span class='va'>tf_idf</span>,<span class='fl'>5</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 130 x 6
# Groups:   SOURCE [26]
   SOURCE         word           n      tf   idf  tf_idf
   &lt;chr&gt;          &lt;chr&gt;      &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
 1 All News Today cleanup        3 0.00291 2.16  0.00628
 2 All News Today didn           3 0.00291 2.16  0.00628
 3 All News Today protectors    15 0.0145  0.486 0.00706
 4 All News Today series         4 0.00388 1.65  0.00640
 5 All News Today henk           4 0.00388 1.47  0.00569
 6 Athena Speaks  flight         4 0.00354 3.26  0.0115 
 7 Athena Speaks  carol          7 0.00619 3.26  0.0202 
 8 Athena Speaks  dob           11 0.00973 1.47  0.0143 
 9 Athena Speaks  elan           6 0.00531 3.26  0.0173 
10 Athena Speaks  shown         12 0.0106  2.16  0.0229 
# ... with 120 more rows</code></pre>
</div>
<ol start="2" type="1">
<li>Using the <code>TextComm_e</code> function earlier, we will create a dataframe of the communities</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>wc_comms</span> <span class='op'>&lt;-</span> <span class='fu'>TextComm_e</span><span class='op'>(</span>text_network <span class='op'>=</span> <span class='va'>text_network_before</span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='va'>wc_comms</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Membership</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/sample_n.html'>sample_n</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">SOURCE</th>
<th style="text-align: left;">Membership</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Daily Pegasus</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">The Orb</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kronos Star</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Worldwise</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Abila Post</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">The Explainer</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">World Source</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">World Journal</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The World</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">The Light of Truth</td>
<td style="text-align: left;">5</td>
</tr>
</tbody>
</table>
</div>
<ol start="3" type="1">
<li>Join to the <code>tf_idf</code> dataframe</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>com_tf_idf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>inner_join</a></span><span class='op'>(</span><span class='va'>tf_idf</span>, 
                         <span class='va'>wc_comms</span>, 
                         by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SOURCE"</span><span class='op'>)</span>
                         <span class='op'>)</span>
<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/sample_n.html'>sample_n</a></span><span class='op'>(</span><span class='va'>com_tf_idf</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">SOURCE</th>
<th style="text-align: left;">word</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">tf</th>
<th style="text-align: right;">idf</th>
<th style="text-align: right;">tf_idf</th>
<th style="text-align: left;">Membership</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Everyday News</td>
<td style="text-align: left;">caramel</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.0106686</td>
<td style="text-align: right;">3.258097</td>
<td style="text-align: right;">0.0347592</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">International News</td>
<td style="text-align: left;">officers</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.0083612</td>
<td style="text-align: right;">1.312186</td>
<td style="text-align: right;">0.0109715</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The World</td>
<td style="text-align: left;">cato</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0066815</td>
<td style="text-align: right;">1.466337</td>
<td style="text-align: right;">0.0097974</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Everyday News</td>
<td style="text-align: left;">bottoms</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.0035562</td>
<td style="text-align: right;">2.159484</td>
<td style="text-align: right;">0.0076795</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The World</td>
<td style="text-align: left;">relationship</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.0066815</td>
<td style="text-align: right;">1.466337</td>
<td style="text-align: right;">0.0097974</td>
<td style="text-align: left;">5</td>
</tr>
</tbody>
</table>
</div>
<ol start="4" type="1">
<li>Create the ggplot object</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>com_tf_idf</span> <span class='op'>%&gt;%</span> 
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/reorder_within.html'>reorder_within</a></span><span class='op'>(</span><span class='va'>word</span>, 
                            <span class='va'>tf_idf</span>, 
                            <span class='va'>SOURCE</span><span class='op'>)</span>,
                 <span class='va'>tf_idf</span>,
                 fill <span class='op'>=</span> <span class='va'>Membership</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_bar</a></span><span class='op'>(</span>stat <span class='op'>=</span> <span class='st'>'identity'</span>,color<span class='op'>=</span><span class='st'>'black'</span>, size<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/reorder_within.html'>scale_x_reordered</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_flip.html'>coord_flip</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>SOURCE</span>, scales <span class='op'>=</span> <span class='st'>"free_y"</span>, ncol <span class='op'>=</span> <span class='fl'>7</span><span class='op'>)</span> <span class='op'>+</span> 
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1"</span><span class='op'>=</span><span class='st'>'#97c2fc'</span>,
                                  <span class='st'>"2"</span><span class='op'>=</span><span class='st'>"#7be141"</span>,
                                  <span class='st'>"3"</span><span class='op'>=</span><span class='st'>"#ffff00"</span>,
                                  <span class='st'>"4"</span><span class='op'>=</span><span class='st'>'#fb7e81'</span>,
                                  <span class='st'>"5"</span><span class='op'>=</span><span class='st'>'#eb7df4'</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='st'>''</span>,y<span class='op'>=</span><span class='st'>''</span>, title <span class='op'>=</span> <span class='st'>"TF-IDF"</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.title.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
            axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
            axis.ticks.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
            panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill<span class='op'>=</span><span class='st'>"white"</span><span class='op'>)</span>,
            strip.background <span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill<span class='op'>=</span><span class='st'>"white"</span><span class='op'>)</span>,
            plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>16</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>5</span>,<span class='fl'>0</span><span class='op'>)</span>, hjust<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span>
            <span class='op'>)</span>

<span class='co'>#p</span>
</code></pre>
</div>
</div>
<h3 id="average-no.-of-words-per-source">Average No. of Words Per Source</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fl'>1998</span> <span class='op'>&lt;=</span> <span class='fu'>year</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span>, <span class='fu'>year</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>&lt;</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>,<span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>SOURCE</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Tethys News"</span>, <span class='st'>"Centrum Sentinel"</span>, <span class='st'>"Modern Rubicon"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>count</span><span class='op'>(</span><span class='va'>FILE</span>, <span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>avg_word <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>wc_comms</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>Membership</span>, <span class='fu'>desc</span><span class='op'>(</span><span class='va'>avg_word</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>SOURCE2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, levels<span class='op'>=</span><span class='va'>SOURCE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>avg_word</span>,<span class='va'>SOURCE2</span>,fill<span class='op'>=</span><span class='va'>Membership</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_bar.html'>geom_col</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='st'>'black'</span>, size<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1"</span><span class='op'>=</span><span class='st'>'#97c2fc'</span>,
                                <span class='st'>"2"</span><span class='op'>=</span><span class='st'>"#7be141"</span>,
                                <span class='st'>"3"</span><span class='op'>=</span><span class='st'>"#ffff00"</span>,
                                <span class='st'>"4"</span><span class='op'>=</span><span class='st'>'#fb7e81'</span>,
                                <span class='st'>"5"</span><span class='op'>=</span><span class='st'>'#eb7df4'</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Average No. of Words"</span>,
         y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
         title <span class='op'>=</span> <span class='st'>"Average No. of Words in each News Source"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill<span class='op'>=</span><span class='st'>"white"</span><span class='op'>)</span>,
          panel.grid.major.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span><span class='st'>"#d6d6d6"</span><span class='op'>)</span>,
          axis.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>10</span>, color<span class='op'>=</span><span class='st'>"black"</span><span class='op'>)</span>,
          plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>15</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>30</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
          <span class='op'>)</span> <span class='co'>#+</span>
</code></pre>
</div>
<img src="Build_files/figure-html5/words-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">    <span class='co'>#ggsave('images/5-1-2.png')</span>
</code></pre>
</div>
</div>
<h2 id="building-the-visuals-for-question-2">Building the Visuals for Question 2</h2>
<h3 id="bi-gram-plots-by-source">Bi-Gram Plots by Source</h3>
<ol type="1">
<li>Create the dataframe for the ngrams</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>g_before_ngrams</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fl'>1998</span> <span class='op'>&lt;=</span> <span class='fu'>year</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span>,
                             <span class='fu'>year</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>&lt;</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>word <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>word</span>, collapse <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>word</span>, token<span class='op'>=</span><span class='st'>"ngrams"</span>, n<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>word</span> <span class='op'>!=</span> <span class='st'>'NA'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'>separate</span><span class='op'>(</span><span class='va'>word</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"word1"</span>, <span class='st'>"word2"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>word1</span>, <span class='va'>word2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/top_n.html'>top_n</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fl'>50</span>, wt<span class='op'>=</span><span class='va'>n</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'>relocate</span><span class='op'>(</span><span class='va'>SOURCE</span>, .after <span class='op'>=</span> <span class='fu'>last_col</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"from"</span><span class='op'>=</span><span class='st'>"word1"</span>,
                             <span class='st'>"to"</span><span class='op'>=</span><span class='st'>"word2"</span>,
                             <span class='st'>"value"</span><span class='op'>=</span><span class='st'>"n"</span>,
                             <span class='st'>"group"</span><span class='op'>=</span><span class='st'>"SOURCE"</span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/sample_n.html'>sample_n</a></span><span class='op'>(</span><span class='va'>g_before_ngrams</span> <span class='op'>%&gt;%</span> <span class='va'>ungroup</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">from</th>
<th style="text-align: left;">to</th>
<th style="text-align: right;">value</th>
<th style="text-align: left;">group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">article</td>
<td style="text-align: left;">installment</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">The Orb</td>
</tr>
<tr class="even">
<td style="text-align: left;">developing</td>
<td style="text-align: left;">country</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">The World</td>
</tr>
<tr class="odd">
<td style="text-align: left;">practice</td>
<td style="text-align: left;">medicine</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Kronos Star</td>
</tr>
<tr class="even">
<td style="text-align: left;">declaration</td>
<td style="text-align: left;">government</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">The Explainer</td>
</tr>
<tr class="odd">
<td style="text-align: left;">international</td>
<td style="text-align: left;">founded</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">The World</td>
</tr>
</tbody>
</table>
</div>
<ol start="2" type="1">
<li>Feed into a for-loop to create the plots per source.</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>g_before_ngrams</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  
      <span class='va'>e</span> <span class='op'>&lt;-</span> <span class='va'>g_before_ngrams</span> <span class='op'>%&gt;%</span> 
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>group</span> <span class='op'>==</span><span class='va'>i</span><span class='op'>)</span>
      
      <span class='va'>n</span> <span class='op'>&lt;-</span> <span class='va'>e</span> <span class='op'>%&gt;%</span> 
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>from</span>, <span class='va'>to</span>, <span class='va'>group</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
            <span class='fu'>pivot_longer</span><span class='op'>(</span>cols<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"from"</span>,<span class='st'>"to"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/get_sentiments.html'>get_sentiments</a></span><span class='op'>(</span><span class='st'>"bing"</span><span class='op'>)</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"value"</span><span class='op'>=</span><span class='st'>"word"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'>replace_na</span><span class='op'>(</span>replace <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>sentiment <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>sentiment</span><span class='op'>==</span><span class='st'>"negative"</span>, <span class='st'>"blue"</span>, 
                                <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>sentiment</span><span class='op'>==</span><span class='st'>"none"</span>, <span class='st'>"grey"</span>,
                                       <span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>value</span>, <span class='va'>color</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"id"</span> <span class='op'>=</span> <span class='st'>"value"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>id</span>,<span class='va'>color</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

      <span class='va'>n</span><span class='op'>$</span><span class='va'>label</span> <span class='op'>&lt;-</span> <span class='va'>n</span><span class='op'>$</span><span class='va'>id</span>

      <span class='va'>p</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='va'>n</span>, 
                    edges <span class='op'>=</span> <span class='va'>e</span>, 
                    main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"News Source: "</span>,<span class='va'>i</span><span class='op'>)</span>,
                                       style <span class='op'>=</span> <span class='st'>"font-family:Verdana;font-weight:600;color:#000000;font-size:20px;text-align:center;"</span><span class='op'>)</span>
                    <span class='op'>)</span>  <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>font <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span><span class='fl'>34</span>, style<span class='op'>=</span><span class='st'>"font-weight:600"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>physics <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visOptions.html'>visOptions</a></span><span class='op'>(</span>highlightNearest <span class='op'>=</span> <span class='cn'>T</span>, 
                     nodesIdSelection <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visInteraction.html'>visInteraction</a></span><span class='op'>(</span>multiselect <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

      <span class='fu'>show</span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>

<span class='op'>}</span>
</code></pre>
</div>
</div>
<ol start="3" type="1">
<li><p>Extension of the above for-loop to sieve out the primary sources and also identify paired word with key words such as “Gastech”, “POK”.</p>
<p>First a new dataset will be created <code>g_before_ngrams2</code> as the line of code, commented out below, is removed.</p></li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>g_before_ngrams2</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fl'>1998</span> <span class='op'>&lt;=</span> <span class='fu'>year</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span>,
                             <span class='fu'>year</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>&lt;</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>word <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>word</span>, collapse <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>word</span>, token<span class='op'>=</span><span class='st'>"ngrams"</span>, n<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>word</span> <span class='op'>!=</span> <span class='st'>'NA'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'>separate</span><span class='op'>(</span><span class='va'>word</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"word1"</span>, <span class='st'>"word2"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>" "</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>word1</span>, <span class='va'>word2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  
  
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='co'>#top_n(n=30, wt=n) %&gt;% </span>
                      <span class='fu'>relocate</span><span class='op'>(</span><span class='va'>SOURCE</span>, .after <span class='op'>=</span> <span class='fu'>last_col</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"from"</span><span class='op'>=</span><span class='st'>"word1"</span>,
                             <span class='st'>"to"</span><span class='op'>=</span><span class='st'>"word2"</span>,
                             <span class='st'>"value"</span><span class='op'>=</span><span class='st'>"n"</span>,
                             <span class='st'>"group"</span><span class='op'>=</span><span class='st'>"SOURCE"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>For Homeland Illumination, Kronos Star, and The Abila Post, we will use the filter marked as <code>--1</code>. For The World, and International Times we will use the filter marked as <code>--2</code>.</p>
<p>These filtered datasets will be saved as <code>g_before_ngrams_specific</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>g_before_ngrams_specific</span> <span class='op'>&lt;-</span> <span class='va'>g_before_ngrams2</span> <span class='op'>%&gt;%</span> 
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>group</span><span class='op'>==</span><span class='st'>"International Times"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'># -- Change</span>
                            <span class='co'>#filter(from %in% c("pok","elodis","police","government")| to %in% c("pok","elodis","police","government")) # -- 1</span>
                            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>from</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"gastech"</span>,<span class='st'>"international"</span>, <span class='st'>"kronos"</span>,<span class='st'>"sanjorge"</span>,<span class='st'>"pok"</span>,<span class='st'>"elodis"</span>,<span class='st'>"protector"</span><span class='op'>)</span><span class='op'>|</span> <span class='va'>to</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"gastech"</span>,<span class='st'>"international"</span>,<span class='st'>"kronos"</span>, <span class='st'>"sanjorge"</span>,<span class='st'>"pok"</span>,<span class='st'>"elodis"</span>,<span class='st'>"protector"</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># -- 2</span>

      <span class='va'>e</span> <span class='op'>&lt;-</span> <span class='va'>g_before_ngrams_specific</span> 

      <span class='va'>n</span> <span class='op'>&lt;-</span> <span class='va'>e</span> <span class='op'>%&gt;%</span> 
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>from</span>, <span class='va'>to</span>, <span class='va'>group</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
            <span class='fu'>pivot_longer</span><span class='op'>(</span>cols<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"from"</span>,<span class='st'>"to"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/get_sentiments.html'>get_sentiments</a></span><span class='op'>(</span><span class='st'>"bing"</span><span class='op'>)</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"value"</span><span class='op'>=</span><span class='st'>"word"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'>replace_na</span><span class='op'>(</span>replace <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>sentiment <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>color.background <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>sentiment</span><span class='op'>==</span><span class='st'>"negative"</span>, <span class='st'>"blue"</span>, 
                                <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>sentiment</span><span class='op'>==</span><span class='st'>"none"</span>, <span class='st'>"grey"</span>,
                                       <span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>value</span>, <span class='va'>color.background</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span><span class='st'>"id"</span> <span class='op'>=</span> <span class='st'>"value"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>id</span>,<span class='va'>color.background</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

      <span class='va'>n</span><span class='op'>$</span><span class='va'>label</span> <span class='op'>&lt;-</span> <span class='va'>n</span><span class='op'>$</span><span class='va'>id</span>
      <span class='va'>n</span><span class='op'>$</span><span class='va'>color.highlight.background</span> <span class='op'>&lt;-</span> <span class='st'>"brown"</span>
      <span class='va'>n</span><span class='op'>$</span><span class='va'>color.border</span> <span class='op'>&lt;-</span> <span class='st'>"black"</span>
      <span class='va'>e</span><span class='op'>$</span><span class='va'>color</span> <span class='op'>&lt;-</span> <span class='st'>"gray"</span> 
      

      <span class='va'>p</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>n</span>, 
                    edges <span class='op'>=</span> <span class='va'>e</span>, 
                    main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"News Source: "</span>,<span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>e</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>)</span>,
                                       style <span class='op'>=</span> <span class='st'>"font-family:Verdana;font-weight:600;color:#000000;font-size:20px;text-align:center;"</span><span class='op'>)</span>
                    <span class='op'>)</span>  <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>arrows <span class='op'>=</span> <span class='st'>"middle"</span>, color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>highlight <span class='op'>=</span> <span class='st'>"brown"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>font <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>size <span class='op'>=</span><span class='fl'>34</span>, style<span class='op'>=</span><span class='st'>"font-weight:600"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>physics <span class='op'>=</span> <span class='cn'>F</span>, layout <span class='op'>=</span> <span class='st'>"layout_nicely"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visOptions.html'>visOptions</a></span><span class='op'>(</span>highlightNearest <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>enabled <span class='op'>=</span> <span class='cn'>T</span>, 
                                             algorithm <span class='op'>=</span> <span class='st'>"all"</span>,
                                             degree <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, 
                     nodesIdSelection <span class='op'>=</span> <span class='cn'>T</span>
                    <span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visInteraction.html'>visInteraction</a></span><span class='op'>(</span>multiselect <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

      
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>390</span><span class='op'>)</span>
<span class='va'>p</span>
</code></pre>
</div>
<div id="htmlwidget-4fb6f662b222bff97e67" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-4fb6f662b222bff97e67">{"x":{"nodes":{"id":["abila","abilia","ability","accused","action","activist","added","america","appears","armed","attacked","attention","audiences","belonged","blossom","brilliant","candy","capital","ceo","certainty","close","colliding","committed","company","conservative","corporation","countries","crack","crackdown","crossfire","custody","declaration","declared","demonstrations","denied","died","disaster","driving","drymiau","eastern","elodis","empire","europe","exposure","favored","fields","food","found","front","future","gas","gastech","giant","government","head","headquarters","heart","held","holds","horrified","hospital","image","influenced","initially","initiated","international","investors","issues","jail","jr","kdt","kronos","kronosians","largest","leader","legacies","likened","live","mantle","naked","national","notify","nowadays","past","payments","people","perks","pipeline","pok","president","production","propelled","protectors","pump","quipped","refuses","responsible","rest","roots","sanjorge","served","set","social","spokesperson","spotlight","stated","sten","strives","submit","supporters","supportive","swamped","takes","tax","terrorism","terrorist","tethys","told","towns","traffic","treasury","truck","trust","tv","violence","waste","week","wellness"],"color.background":["grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","red","red","grey","grey","grey","grey","grey","grey","grey","grey","blue","grey","grey","blue","grey","grey","grey","grey","grey","grey","blue","blue","blue","grey","grey","grey","grey","grey","grey","grey","red","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","blue","grey","grey","grey","grey","grey","grey","grey","blue","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","blue","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","grey","red","blue","grey","grey","blue","grey","grey","grey","grey","grey","grey","grey","red","grey","grey","blue","grey","grey"],"n":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,2,1,2,1,1,1,36,1,2,1,1,1,1,1,1,1,1,1,1,1,10,1,1,2,1,1,56,1,1,4,1,1,1,1,1,1,1,1,1,1,2,1,2,35,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,1,2,1,1,2,1,1,1,1,2,2,3,1,2,1,1,1,1,1,2,1,1,1],"label":["abila","abilia","ability","accused","action","activist","added","america","appears","armed","attacked","attention","audiences","belonged","blossom","brilliant","candy","capital","ceo","certainty","close","colliding","committed","company","conservative","corporation","countries","crack","crackdown","crossfire","custody","declaration","declared","demonstrations","denied","died","disaster","driving","drymiau","eastern","elodis","empire","europe","exposure","favored","fields","food","found","front","future","gas","gastech","giant","government","head","headquarters","heart","held","holds","horrified","hospital","image","influenced","initially","initiated","international","investors","issues","jail","jr","kdt","kronos","kronosians","largest","leader","legacies","likened","live","mantle","naked","national","notify","nowadays","past","payments","people","perks","pipeline","pok","president","production","propelled","protectors","pump","quipped","refuses","responsible","rest","roots","sanjorge","served","set","social","spokesperson","spotlight","stated","sten","strives","submit","supporters","supportive","swamped","takes","tax","terrorism","terrorist","tethys","told","towns","traffic","treasury","truck","trust","tv","violence","waste","week","wellness"],"color.highlight.background":["brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown"],"color.border":["black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black"],"x":[0.421906911574676,0.495545645403525,-0.478742513379496,0.177190336668147,0.351317549204455,0.317986170781978,0.201273862986561,0.18913624333555,0.497990047836232,0.260037713361321,0.327491629914974,0.260634426664892,-0.303371483440501,0.145375549127388,0.19451451224588,-0.926193648398891,0.312418827442756,0.231028368272942,-0.532522555441523,-0.444714459706192,0.431451314105729,-0.362705660863966,0.458314765982014,0.358298761962331,0.209631594669497,-0.255506607826093,-0.659567902962207,0.232943035846253,0.50585719364344,0.528630325939034,0.982613005639035,0.45074034300741,0.268690015717852,0.557776923672894,0.211690115935761,0.413514349888601,0.46643947256382,0.363281755377722,0.399143933882769,0.603127348871412,0.813295009851506,-0.54148646504816,-0.370868946462863,-0.455482709994054,-0.496915472007548,0.398627832354919,-0.30995304638086,0.624424643076446,-0.401563198452455,-0.551316688060423,0.235487900825243,-0.329089396363207,-0.438177882784665,0.416618898100201,-0.243575735854601,-0.338511584222709,0.422837070463136,0.527209949527983,0.467129714242888,0.282377630524266,0.371488010554466,0.155099644646987,-0.672103572717401,0.351515939235204,0.274268451384488,-0.514199117401974,-0.710009570954098,0.307737305131115,0.608396505883768,-0.975604106555122,0.344700828444078,0.356221100766901,0.270934984294235,0.574174953624159,0.0915647432353408,0.549392232330088,0.181360633760514,0.519780573383904,0.405457875943756,1,0.257357684893779,0.472686494369687,-0.346947027907277,-0.414470084995161,0.422320896482882,0.311103025195708,-0.204216365136161,-0.00089536196204365,0.324410709569898,0.550397799114537,0.492981462192344,0.300604463335238,0.484407719140944,-0.504575313276394,-1,0.46572151231437,-0.713518650184584,0.54062787046105,-0.243896358598323,-0.848079392067708,-0.683322133375588,0.579191528936703,0.515601042555703,0.597964219754167,0.491539096997949,0.509246019810779,-0.610280438072331,-0.431804014872176,0.162106995961615,0.372428311201095,-0.392791860033281,0.583679982603582,-0.420927360735857,-0.522992877818934,0.33343274051653,0.354196422914306,-0.117158505730002,0.452997559543047,0.0124038378611055,0.226060636683696,0.376848239449558,-0.215314535772175,-0.61734866759843,-0.295173841949425,0.382179777523012,-0.488105161706837,-0.475387344784257,-0.73065984588311],"y":[0.245462472505549,0.173670958277604,-0.208121456204018,0.09360625001795,0.906486794696767,-0.161904275504045,0.933441564806218,0.0233838934024269,0.111030931223215,-0.124201953899732,0.95636766306405,0.897887202552412,-0.497505043181569,0.795882056203898,0.152516690820018,-1,-0.104017017000939,0.19967576652389,-0.363017880759468,-0.268845877907661,0.187724258191072,-0.487208090968653,0.883430939904334,-0.0648803305338836,-0.0375579022368703,-0.449389373750945,-0.0285837716372889,0.973786373644912,0.761348786399385,-0.0236203439298643,0.615491785847331,0.949208660378245,0.1438650001353,-0.0977192764165898,0.867950194414939,0.984576153959023,-0.122428194752496,0.99278100321202,0.933261276532278,0.0366608003127331,0.527670263551685,-0.415255222752093,-0.404375838154296,-0.351538123762657,-0.303902079186729,0.00837580668624205,-0.428568650740281,0.304717280690917,-0.215945720294872,-0.316284292430157,0.0713512996900514,-0.301823616557472,-0.529510780045747,0.10228198904929,-0.320176488545933,-0.179383030359932,-0.0949835528270979,0.817213252147185,0.821433770709521,0.227717587470011,-0.183682965258039,0.847996394746731,0.0287488516307615,0.244169865899606,0.951442852986968,-0.105000204356165,-0.151613950104682,0.858591427284749,0.663325560526744,-0.968645460479507,0.184234849992106,0.0683936219398775,-0.000785206449206322,0.148992438853826,0.275670162937992,0.0411208490744646,0.748909555171826,-0.135600230619799,0.863716957061232,0.55264946642641,-0.067531531177361,-0.170756892766196,-0.549884477027302,-0.159919085358033,-0.17440611553624,0.428380248269974,-0.456115876163549,-0.115340347807781,0.734048204372888,0.101318639154528,0.0314601976654394,1,0.234534634839485,-0.459110565503596,-0.912411615869313,-0.0427897023162174,-0.0233886112367289,0.193272447511553,-0.514356748301128,-0.839359971814752,-0.0918440793233326,-0.0531158832548139,0.871410028952259,0.0913199105023561,0.922811773143738,-0.0796529944245168,-0.595031371969329,-0.415152015094051,0.902339403538257,0.787704806330459,-0.540957046760961,-0.00694421432728232,-0.474099429256318,-0.253906049915571,0.40957012994451,0.428834276777228,-0.079618534243112,0.749188930987656,-0.143686098875808,0.804767702980473,-0.130482835901157,-0.387794500310947,0.0425785739838485,-0.55002306357736,0.424113480063756,-0.407478059462336,-0.496771162780295,-0.0892911548516219]},"edges":{"from":["abila","abilia","accused","added","america","armed","attacked","attention","audiences","blossom","candy","certainty","colliding","committed","company","conservative","crack","crackdown","crossfire","custody","declaration","demonstrations","driving","eastern","elodis","elodis","europe","exposure","favored","fields","food","front","gas","gastech","gastech","gastech","gastech","gastech","gastech","gastech","gastech","gastech","gastech","gastech","gastech","gastech","gastech","gastech","gastech","gastech","gastech","giant","government","head","heart","hospital","image","influenced","international","international","international","international","international","international","issues","jail","kdt","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","kronos","leader","leader","likened","live","mantle","naked","nowadays","past","payments","people","perks","pok","pok","pok","pok","pok","pok","pok","pok","pok","pok","pok","pok","pok","pok","pok","pok","pok","production","propelled","protectors","quipped","rest","sanjorge","sanjorge","stated","sten","submit","supporters","supportive","terrorism","tethys","towns","towns","trust","violence","week"],"to":["kronos","kronos","kronos","pok","kronos","kronos","pok","pok","gastech","kronos","kronos","gastech","gastech","pok","kronos","kronos","pok","pok","kronos","elodis","pok","kronos","pok","kronos","found","jail","gastech","gastech","gastech","kronos","gastech","gastech","kronos","ability","ceo","corporation","empire","future","headquarters","international","pipeline","pump","roots","sten","strives","takes","tax","tethys","truck","tv","waste","gastech","kronos","gastech","kronos","kronos","pok","international","countries","gastech","investors","responsible","served","wellness","pok","pok","kronos","activist","appears","capital","close","declared","disaster","fields","found","government","horrified","initially","kronos","kronosians","largest","leader","legacies","national","notify","people","pipeline","president","refuses","set","spokesperson","swamped","terrorist","tethys","treasury","gastech","pok","pok","kronos","pok","elodis","gastech","gastech","kronos","pok","gastech","action","belonged","denied","died","drymiau","held","holds","initiated","leader","social","spotlight","supporters","terrorism","terrorist","told","traffic","violence","kronos","pok","kronos","sanjorge","kronos","brilliant","jr","kronos","sanjorge","pok","pok","gastech","kronos","international","gastech","kronos","international","kronos","gastech"],"value":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,1,1,1,1,3,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,4,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,5,1,1,1,2,2,2,1,1,1,1,1,1,1,1,2,1],"group":["International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times","International Times"],"color":["gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray","gray"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","font":{"size":34,"style":"font-weight:600"},"physics":false},"manipulation":{"enabled":false},"edges":{"arrows":"middle","color":{"highlight":"brown"},"smooth":false},"physics":{"stabilization":false},"interaction":{"multiselect":true}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"News Source:  International Times","style":"font-family:Verdana;font-weight:600;color:#000000;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":0,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
<h3 id="word-cloud-by-communities">Word Cloud by Communities</h3>
<ol type="1">
<li>Create a DTM Corpus i.e. Source and their word counts. This would be the same dataset as we created for the correlation plot.</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dtm_corpus</span> <span class='op'>&lt;-</span> <span class='va'>df.news</span> <span class='op'>%&gt;%</span> 
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fl'>1998</span> <span class='op'>&lt;=</span> <span class='fu'>year</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span>,
                     <span class='fu'>year</span><span class='op'>(</span><span class='va'>PUBLISHED</span><span class='op'>)</span><span class='op'>&lt;</span><span class='fl'>2014</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\d+"</span>, <span class='st'>" "</span>, <span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Text <span class='op'>=</span> <span class='fu'>str_to_lower</span><span class='op'>(</span><span class='va'>Text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Text</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>word</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>inner_join</a></span><span class='op'>(</span><span class='va'>wc_comms</span><span class='op'>)</span> 

<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/sample_n.html'>sample_n</a></span><span class='op'>(</span><span class='va'>dtm_corpus</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span>,<span class='fl'>5</span><span class='op'>)</span>, caption <span class='op'>=</span> <span class='st'>"Snapshot of dtm_corpus"</span><span class='op'>)</span>  
</code></pre>
</div>
<table>
<caption><span id="tab:unnamed-chunk-27">Table 1: </span>Snapshot of dtm_corpus</caption>
<thead>
<tr class="header">
<th style="text-align: left;">SOURCE</th>
<th style="text-align: left;">word</th>
<th style="text-align: right;">count</th>
<th style="text-align: left;">Membership</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">The Guide</td>
<td style="text-align: left;">hard</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">News Online Today</td>
<td style="text-align: left;">vehicle</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Guide</td>
<td style="text-align: left;">animate</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">The Continent</td>
<td style="text-align: left;">gala</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Tulip</td>
<td style="text-align: left;">cofounder</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">5</td>
</tr>
</tbody>
</table>
</div>
<ol start="2" type="1">
<li>Feed into a for-loop to generate a WordCloud for each of the communities</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>dtm_corpus</span><span class='op'>$</span><span class='va'>Membership</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>dtm_model</span> <span class='op'>&lt;-</span> <span class='va'>dtm_corpus</span> <span class='op'>%&gt;%</span> 
               <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Membership</span><span class='op'>==</span><span class='va'>i</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
               <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/document_term_casters.html'>cast_dtm</a></span><span class='op'>(</span><span class='va'>SOURCE</span>, <span class='va'>word</span>, <span class='va'>count</span><span class='op'>)</span>

  <span class='va'>lda_topics</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/topicmodels/man/lda.html'>LDA</a></span><span class='op'>(</span><span class='va'>dtm_model</span>,
                     k<span class='op'>=</span><span class='fl'>2</span>, 
                     method<span class='op'>=</span><span class='st'>"Gibbs"</span>,
                     control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>seed<span class='op'>=</span><span class='fl'>333</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></span><span class='op'>(</span>matrix <span class='op'>=</span> <span class='st'>"beta"</span><span class='op'>)</span>
  
  <span class='va'>sources</span> <span class='op'>&lt;-</span> <span class='va'>wc_comms</span> <span class='op'>%&gt;%</span> 
             <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Membership</span><span class='op'>==</span><span class='va'>i</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
             <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SOURCE</span><span class='op'>)</span>
  
    
  <span class='va'>word_probs</span> <span class='op'>&lt;-</span> <span class='va'>lda_topics</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>topic</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/top_n.html'>top_n</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='va'>beta</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>term2 <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>term</span>, <span class='va'>beta</span><span class='op'>)</span><span class='op'>)</span> 
  
  <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://lepennec.github.io/ggwordcloud/reference/ggwordcloud.html'>ggwordcloud</a></span><span class='op'>(</span><span class='va'>word_probs</span><span class='op'>$</span><span class='va'>term</span>, 
                   freq <span class='op'>=</span> <span class='va'>word_probs</span><span class='op'>$</span><span class='va'>beta</span>, 
                   colors <span class='op'>=</span> <span class='va'>word_probs</span><span class='op'>$</span><span class='va'>topic</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Wordcloud for Cluster: "</span>, <span class='va'>i</span><span class='op'>)</span>,
            subtitle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>sources</span><span class='op'>)</span>, collapse <span class='op'>=</span> <span class='st'>', '</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0.5</span>, size<span class='op'>=</span><span class='fl'>14</span><span class='op'>)</span>,
             plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0.5</span>, size<span class='op'>=</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span>
  <span class='co'>#show(p)</span>
  <span class='co'>#ggsave(paste('images/5-1-6-',i,".png",sep = ''))</span>

<span class='op'>}</span>
</code></pre>
</div>
</div>
<h2 id="building-the-visuals-for-question-3">Building the Visuals for Question 3</h2>
<h3 id="creating-the-email-network-communities-by-department">Creating the email Network, communities by Department</h3>
<p>This network will show an overview of the employees and conversations within their departments.</p>
<ol type="1">
<li>First we will set up the links, <code>links</code> , and nodes, <code>nodes_df</code></li>
</ol>
<p>Links:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>links</span> <span class='op'>&lt;-</span> <span class='va'>df.emails</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>To <span class='op'>=</span> <span class='fu'>str_split</span><span class='op'>(</span><span class='va'>To</span>,pattern<span class='op'>=</span><span class='st'>','</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
          <span class='fu'>unnest_longer</span><span class='op'>(</span><span class='va'>To</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>To <span class='op'>=</span> <span class='fu'>str_trim</span><span class='op'>(</span><span class='va'>To</span><span class='op'>)</span>,
                 From <span class='op'>=</span> <span class='fu'>str_trim</span><span class='op'>(</span><span class='va'>From</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>From</span><span class='op'>==</span><span class='va'>To</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>From</span>, <span class='va'>To</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>count<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>weight <span class='op'>=</span> <span class='va'>count</span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>links</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">From</th>
<th style="text-align: left;">To</th>
<th style="text-align: right;">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ada Campo-Corrente</td>
<td style="text-align: left;">Felix Resumir</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ada Campo-Corrente</td>
<td style="text-align: left;">Ingrid Barranco</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ada Campo-Corrente</td>
<td style="text-align: left;">Orhan Strum</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ada Campo-Corrente</td>
<td style="text-align: left;">Ruscella Mies Haber</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ada Campo-Corrente</td>
<td style="text-align: left;">Sten Sanjorge Jr</td>
<td style="text-align: right;">16</td>
</tr>
</tbody>
</table>
</div>
<p>Nodes:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>nodes_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>links</span><span class='op'>$</span><span class='va'>From</span>, <span class='va'>links</span><span class='op'>$</span><span class='va'>To</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>df.emp</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span><span class='op'>=</span><span class='st'>"FullName"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>id</span>, 
                     <span class='va'>CurrentEmploymentTitle</span>, 
                     <span class='va'>CurrentEmploymentType</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='va'>CurrentEmploymentTitle</span>, 
                   department <span class='op'>=</span> <span class='va'>CurrentEmploymentType</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
            <span class='fu'>replace_na</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>department <span class='op'>=</span> <span class='st'>"Executive"</span>, 
                            title <span class='op'>=</span> <span class='st'>"CEO"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>nodes_df</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">id</th>
<th style="text-align: left;">title</th>
<th style="text-align: left;">department</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ada Campo-Corrente</td>
<td style="text-align: left;">SVP/CIO</td>
<td style="text-align: left;">Executive</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adan Morlun</td>
<td style="text-align: left;">Truck Driver</td>
<td style="text-align: left;">Facilities</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Adra Nubarron</td>
<td style="text-align: left;">Geologist</td>
<td style="text-align: left;">Engineering</td>
</tr>
<tr class="even">
<td style="text-align: left;">Albina Hafon</td>
<td style="text-align: left;">Truck Driver</td>
<td style="text-align: left;">Facilities</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Anda Ribera</td>
<td style="text-align: left;">Assistant to CFO</td>
<td style="text-align: left;">Administration</td>
</tr>
</tbody>
</table>
</div>
<ol start="2" type="1">
<li>Next, the following code chunk will create the visNetwork</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>email_network</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span>d <span class='op'>=</span> <span class='va'>links</span>, 
                                       vertices <span class='op'>=</span> <span class='va'>nodes_df</span>
                                       <span class='op'>)</span>

<span class='va'>email_network</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/simplify.html'>simplify</a></span><span class='op'>(</span><span class='va'>email_network</span><span class='op'>)</span>

<span class='va'>nodes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, 
                    title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, 
                    group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>department</span><span class='op'>)</span>


<span class='va'>edges</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>get.data.frame</a></span><span class='op'>(</span><span class='va'>email_network</span>, what<span class='op'>=</span><span class='st'>"edges"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>
<span class='va'>edges</span><span class='op'>$</span><span class='va'>value</span> <span class='op'>&lt;-</span> <span class='va'>links</span><span class='op'>$</span><span class='va'>weight</span>
<span class='co'>#edges$color.opacity &lt;- 0.8</span>
<span class='co'>#edges$color.highlight &lt;- "red"</span>

<span class='va'>nodes</span><span class='op'>$</span><span class='va'>color.highlight.background</span> <span class='op'>&lt;-</span> <span class='st'>"brown"</span>

<span class='va'>nodes</span> <span class='op'>&lt;-</span> <span class='va'>nodes</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>font.size <span class='op'>=</span> <span class='fl'>25</span>, 
                          font.weight<span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>


<span class='va'>lnodes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'square'</span>,<span class='fl'>6</span><span class='op'>)</span>,
                     label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Executive"</span>,
                               <span class='st'>"Facilities"</span>,
                               <span class='st'>"Engineering"</span>,
                               <span class='st'>"Administration"</span>,
                               <span class='st'>"Security"</span>,
                               <span class='st'>"Information Technology"</span><span class='op'>)</span>,
                     color.background <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#FB7E81"</span>,
                                          <span class='st'>"#7BE141"</span>,
                                          <span class='st'>"#FFFF00"</span>,
                                          <span class='st'>"#97C2FC"</span>,
                                          <span class='st'>"#AD85E4"</span>,
                                          <span class='st'>"#EB7DF4"</span><span class='op'>)</span>,
                     color.border <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'black'</span>,<span class='fl'>6</span><span class='op'>)</span>,
                     font.align <span class='op'>=</span>  <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"center"</span>,<span class='fl'>6</span><span class='op'>)</span>,
                     font.size <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>20</span>,<span class='fl'>6</span><span class='op'>)</span>
                     <span class='op'>)</span>


  <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span>nodes <span class='op'>=</span> <span class='va'>nodes</span>, 
                  edges <span class='op'>=</span> <span class='va'>edges</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visOptions.html'>visOptions</a></span><span class='op'>(</span>highlightNearest <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>enabled <span class='op'>=</span> <span class='cn'>T</span>, degree <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>, 
                 nodesIdSelection <span class='op'>=</span> <span class='cn'>T</span>,
                 selectedBy <span class='op'>=</span> <span class='st'>"group"</span>
                 
                 <span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.01</span>,length <span class='op'>=</span> <span class='fl'>10</span>, scaling <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>min<span class='op'>=</span><span class='fl'>0.1</span>,max<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visLayout.html'>visLayout</a></span><span class='op'>(</span>randomSeed <span class='op'>=</span> <span class='fl'>123</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>labelHighlightBold <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='co'>#visPhysics(stabilization = 5,</span>
      <span class='co'>#           barnesHut = list(springLength =230, avoidOverlap=0.2), </span>
      <span class='co'>#           forceAtlas2Based = list(gravitaionalConstant = -100,</span>
      <span class='co'>#                                   centralGravity = 0.5)) %&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>layout <span class='op'>=</span> <span class='st'>"layout_nicely"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visInteraction.html'>visInteraction</a></span><span class='op'>(</span>multiselect <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visLegend.html'>visLegend</a></span><span class='op'>(</span>enabled <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visGroups.html'>visGroups</a></span><span class='op'>(</span>groupname <span class='op'>=</span> <span class='st'>"Executive"</span>, 
                <span class='co'># Red</span>
                color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#FA0A10"</span>, 
                             background <span class='op'>=</span> <span class='st'>"#FB7E81"</span>, 
                             highlight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#FA0A10"</span>, background <span class='op'>=</span> <span class='st'>"#FB7E81"</span><span class='op'>)</span>,
                             hover <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>background <span class='op'>=</span> <span class='st'>"#FA0A10"</span>, border <span class='op'>=</span> <span class='st'>"#FB7E81"</span><span class='op'>)</span>
                             <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visGroups.html'>visGroups</a></span><span class='op'>(</span>groupname <span class='op'>=</span> <span class='st'>"Facilities"</span>, 
                <span class='co'># Green</span>
                color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#41A906"</span>, 
                             background <span class='op'>=</span> <span class='st'>"#7BE141"</span>, 
                             highlight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#41A906"</span>, background <span class='op'>=</span> <span class='st'>"#7BE141"</span><span class='op'>)</span>,
                             hover <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>background <span class='op'>=</span> <span class='st'>"#41A906"</span>, border <span class='op'>=</span> <span class='st'>"#7BE141"</span><span class='op'>)</span>
                             <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visGroups.html'>visGroups</a></span><span class='op'>(</span>groupname <span class='op'>=</span> <span class='st'>"Engineering"</span>, 
                <span class='co'># Yellow</span>
                    color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#FFA500"</span>, 
                                 background <span class='op'>=</span> <span class='st'>"#FFFF00"</span>, 
                                 highlight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#FFA500"</span>, background <span class='op'>=</span> <span class='st'>"#FFFF00"</span><span class='op'>)</span>,
                                 hover <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>background <span class='op'>=</span> <span class='st'>"#FFA500"</span>, border <span class='op'>=</span> <span class='st'>"#FFFF00"</span><span class='op'>)</span>
                                 <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visGroups.html'>visGroups</a></span><span class='op'>(</span>groupname <span class='op'>=</span> <span class='st'>"Administration"</span>, 
                <span class='co'># Blue</span>
                    color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#2B7CE9"</span>, 
                                 background <span class='op'>=</span> <span class='st'>"#97C2FC"</span>, 
                                 highlight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#2B7CE9"</span>, background <span class='op'>=</span> <span class='st'>"#97C2FC"</span><span class='op'>)</span>,
                                 hover <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>background <span class='op'>=</span> <span class='st'>"#2B7CE9"</span>, border <span class='op'>=</span> <span class='st'>"#97C2FC"</span><span class='op'>)</span>
                                 <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visGroups.html'>visGroups</a></span><span class='op'>(</span>groupname <span class='op'>=</span> <span class='st'>"Security"</span>, 
                <span class='co'># Purple</span>
                    color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#7C29F0"</span>, 
                                 background <span class='op'>=</span> <span class='st'>"#AD85E4"</span>, 
                                 highlight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#7C29F0"</span>, background <span class='op'>=</span> <span class='st'>"#AD85E4"</span><span class='op'>)</span>,
                                 hover <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>background <span class='op'>=</span> <span class='st'>"#7C29F0"</span>, border <span class='op'>=</span> <span class='st'>"#AD85E4"</span><span class='op'>)</span>
                                 <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visGroups.html'>visGroups</a></span><span class='op'>(</span>groupname <span class='op'>=</span> <span class='st'>"Information Technology"</span>, 
                <span class='co'># Magenta</span>
                    color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#E129F0"</span>, 
                                 background <span class='op'>=</span> <span class='st'>"#EB7DF4"</span>, 
                                 highlight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#E129F0"</span>, background <span class='op'>=</span> <span class='st'>"#EB7DF4"</span><span class='op'>)</span>,
                                 hover <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>background <span class='op'>=</span> <span class='st'>"#E129F0"</span>, border <span class='op'>=</span> <span class='st'>"#EB7DF4"</span><span class='op'>)</span>
                                 <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visLegend.html'>visLegend</a></span><span class='op'>(</span>zoom <span class='op'>=</span> <span class='cn'>T</span>, addNodes <span class='op'>=</span> <span class='va'>lnodes</span>, useGroups <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div id="htmlwidget-581be6d2a069b3d6a3a7" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-581be6d2a069b3d6a3a7">{"x":{"nodes":{"id":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"title":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"group":["Executive","Facilities","Engineering","Facilities","Administration","Engineering","Facilities","Facilities","Engineering","Engineering","Administration","Facilities","Facilities","Administration","Facilities","Facilities","Security","Engineering","Facilities","Engineering","Security","Engineering","Facilities","Security","Security","Security","Executive","Facilities","Information Technology","Engineering","Security","Security","Engineering","Engineering","Engineering","Administration","Information Technology","Security","Information Technology","Engineering","Administration","Security","Information Technology","Executive","Administration","Administration","Executive","Security","Information Technology","Facilities","Security","Facilities","Engineering","Executive"],"color.highlight.background":["brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown"],"font.size":[25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],"font.weight":[1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000],"label":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"x":[0.837198511440817,0.0892190273605922,-0.0543357823836426,0.0638027742284242,-0.129240578821841,-0.10803646913536,0.148988431042869,0.178644736774229,-0.304529930764778,-0.172719067714806,-0.218902461198741,0.237657710007707,0.152422289434312,-0.326977688705718,0.0194746689927643,0.243242547489806,0.403610383649584,-0.0175791832397652,-0.081042377810296,-0.13010831264099,0.447026612789261,0.103623976020184,0.321432347203318,0.293260189226789,0.179039880529232,0.494585169345029,0.696788077793185,0.305693323366875,-0.825520763197708,0.00332338653791431,0.321016766901419,0.210601674801272,0.12244505258717,-0.227852675788282,-0.0828896464798624,-0.321284786449186,-0.00801395999742582,0.526586910490124,-0.563424718885291,-0.213313950668959,-0.31085164032468,0.184140386205823,-0.469614624473284,0.725665030445529,-0.0536602832913859,0.120502844455279,0.956450218209791,0.434575907421099,-1,0.089180529024073,0.426237924596727,-0.0371545670099276,-0.0167416718103222,1],"y":[0.188127634245905,0.994802045153214,-0.562729156798903,0.878144045874185,0.0229737476252669,-0.770630986808492,0.458783075819856,1,-0.843708413274855,-0.964753856315095,0.24177647298745,0.612184208970588,0.708971782429858,0.1734672375005,0.563865512960458,0.93766546635858,-0.130062598110066,-0.489740482990667,0.574757932884744,-0.604884273775582,0.0901568541877564,-0.700724823040491,0.544144000445231,-0.224297444794613,-0.115794197190264,-0.0780973115294323,0.088607740113513,0.681365906237708,-0.506706649489053,-0.877935444788221,0.0589455301567789,-0.206683772189199,-0.582288020250531,-0.741516130053428,-1,-0.0473564174109764,0.049598692998849,-0.221571759842085,0.110549866381813,-0.513843547235819,0.451290778008043,-0.363254809606238,-0.390380819849416,-0.0571250057134801,0.306070034991284,0.0434844840887876,0.381071913188445,-0.293703822410345,-0.238763623524785,0.654999370085751,-0.448163635458185,0.817473260284254,-0.714076953858845,-0.0534548516037826]},"edges":{"from":["Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Isak Baza","Isak Baza","Isak Baza","Isak Baza","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Sven Flecha","Sven Flecha","Sven Flecha","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais"],"to":["Felix Resumir","Ingrid Barranco","Orhan Strum","Ruscella Mies Haber","Sten Sanjorge Jr","Willem Vasco-Pais","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Axel Calzas","Birgitta Frente","Brand Tempestad","Cecilia Morluniau","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Ruscella Mies Haber","Vira Frente","Adan Morlun","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Rachel Pantanal","Valeria Morlun","Varro Awelon","Carla Forluniau","Cornelia Lais","Gustav Cazar","Henk Mies","Lars Azada","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Valeria Morlun","Adra Nubarron","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Nils Calixto","Varja Lagos","Vira Frente","Adan Morlun","Albina Hafon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Elsa Orilla","Emile Arpa","Felix Resumir","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Adra Nubarron","Axel Calzas","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isak Baza","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Axel Calzas","Birgitta Frente","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Anda Ribera","Cornelia Lais","Felix Balas","Irene Nant","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Ingrid Barranco","Irene Nant","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Isia Vann","Linnea Bergen","Rachel Pantanal","Valeria Morlun","Varro Awelon","Anda Ribera","Carla Forluniau","Hideki Cocinaro","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dylan Scozzese","Emile Arpa","Felix Resumir","Henk Mies","Hideki Cocinaro","Irene Nant","Lucas Alcazar","Mat Bramar","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Elsa Orilla","Felix Resumir","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Varja Lagos","Adra Nubarron","Axel Calzas","Benito Hawelon","Birgitta Frente","Brand Tempestad","Edvard Vann","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Henk Mies","Irene Nant","Lucas Alcazar","Marin Onda","Valeria Morlun","Varro Awelon","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Carla Forluniau","Elsa Orilla","Gustav Cazar","Hennie Osvaldo","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Varja Lagos","Vira Frente","Ada Campo-Corrente","Benito Hawelon","Dante Coginian","Edvard Vann","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Varja Lagos","Adra Nubarron","Anda Ribera","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Orhan Strum","Vira Frente","Adan Morlun","Albina Hafon","Anda Ribera","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Edvard Vann","Emile Arpa","Inga Ferro","Irene Nant","Sten Sanjorge Jr","Valeria Morlun","Varro Awelon","Edvard Vann","Felix Balas","Felix Resumir","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Rachel Pantanal","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Cornelia Lais","Dante Coginian","Edvard Vann","Felix Resumir","Hennie Osvaldo","Inga Ferro","Isande Borrasca","Isia Vann","Kanon Herrero","Minke Mies","Stenig Fusil","Varja Lagos","Edvard Vann","Felix Resumir","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Willem Vasco-Pais","Ada Campo-Corrente","Cecilia Morluniau","Kare Orilla","Loreto Bodrogi","Orhan Strum","Sten Sanjorge Jr","Willem Vasco-Pais","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Orhan Strum","Valeria Morlun","Varro Awelon","Birgitta Frente","Lucas Alcazar","Nils Calixto","Sven Flecha","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Hideki Cocinaro","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Claudio Hawelon","Edvard Vann","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Kanon Herrero","Loreto Bodrogi","Minke Mies","Rachel Pantanal","Stenig Fusil","Varja Lagos","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Irene Nant","Isia Vann","Loreto Bodrogi","Minke Mies","Nils Calixto","Stenig Fusil","Varja Lagos","Adra Nubarron","Axel Calzas","Benito Hawelon","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Inga Ferro","Ingrid Barranco","Isande Borrasca","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Anda Ribera","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Marin Onda","Vira Frente","Anda Ribera","Carla Forluniau","Cornelia Lais","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Vira Frente","Axel Calzas","Claudio Hawelon","Hennie Osvaldo","Inga Ferro","Isia Vann","Loreto Bodrogi","Lucas Alcazar","Minke Mies","Rachel Pantanal","Ruscella Mies Haber","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Isia Vann","Kanon Herrero","Minke Mies","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Dante Coginian","Emile Arpa","Isak Baza","Linnea Bergen","Nils Calixto","Sven Flecha","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Emile Arpa","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Vira Frente","Anda Ribera","Carla Forluniau","Cornelia Lais","Dante Coginian","Linda Lagos","Rachel Pantanal","Ruscella Mies Haber","Varro Awelon","Adra Nubarron","Hennie Osvaldo","Inga Ferro","Isia Vann","Loreto Bodrogi","Nils Calixto","Ruscella Mies Haber","Vira Frente","Axel Calzas","Isak Baza","Kanon Herrero","Lucas Alcazar","Minke Mies","Sven Flecha","Ada Campo-Corrente","Gustav Cazar","Ingrid Barranco","Irene Nant","Sten Sanjorge Jr","Stenig Fusil","Willem Vasco-Pais","Albina Hafon","Anda Ribera","Carla Forluniau","Claudio Hawelon","Cornelia Lais","Hennie Osvaldo","Isia Vann","Linda Lagos","Mat Bramar","Ruscella Mies Haber","Ada Campo-Corrente","Adra Nubarron","Anda Ribera","Carla Forluniau","Cornelia Lais","Hennie Osvaldo","Inga Ferro","Isia Vann","Linda Lagos","Loreto Bodrogi","Mat Bramar","Minke Mies","Rachel Pantanal","Ada Campo-Corrente","Henk Mies","Ingrid Barranco","Orhan Strum","Willem Vasco-Pais","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Orhan Strum","Varja Lagos","Vira Frente","Isak Baza","Lucas Alcazar","Nils Calixto","Adan Morlun","Albina Hafon","Anda Ribera","Benito Hawelon","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Stenig Fusil","Varro Awelon","Axel Calzas","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Mat Bramar","Valeria Morlun","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Marin Onda","Minke Mies","Stenig Fusil","Ada Campo-Corrente","Inga Ferro","Ingrid Barranco","Orhan Strum","Sten Sanjorge Jr","Varja Lagos"],"value":[2,8,9,1,16,9,11,8,2,8,6,9,14,6,11,9,11,6,2,3,5,1,5,4,2,4,4,4,3,4,2,2,10,14,5,12,7,7,17,6,11,11,2,9,4,13,16,2,2,2,13,13,13,13,2,3,4,3,8,6,5,3,6,10,4,3,3,2,7,7,13,2,7,10,9,5,3,8,3,11,5,9,6,24,24,24,23,24,24,24,25,25,24,25,23,2,3,4,5,2,3,3,3,3,5,1,3,2,10,8,7,7,6,5,9,9,9,10,8,7,19,19,2,1,19,19,19,19,3,8,10,4,5,8,5,7,2,9,2,8,5,3,10,12,7,3,11,5,9,6,10,13,2,1,1,8,7,23,20,2,20,20,20,20,8,5,6,2,4,7,6,7,1,6,2,5,2,1,5,5,14,16,7,2,11,11,8,10,9,13,13,6,3,4,1,5,3,3,3,3,3,4,1,2,9,9,2,6,10,2,6,9,5,10,10,8,10,7,6,4,3,1,2,6,3,4,3,3,2,2,5,4,7,5,6,7,2,4,3,1,6,6,7,5,6,1,4,2,2,2,3,3,2,2,1,2,2,2,2,2,3,1,7,3,4,8,3,5,4,9,6,3,3,4,19,20,2,23,5,16,16,14,18,1,14,3,16,2,17,11,1,1,3,3,3,6,3,4,4,2,2,3,2,2,3,2,1,3,3,1,4,1,2,3,3,1,1,3,6,1,5,2,6,9,2,1,2,2,14,1,2,2,6,6,3,8,7,5,3,9,9,6,8,4,5,2,2,4,2,31,24,31,2,9,5,7,7,5,4,1,10,6,4,8,5,4,3,4,4,2,1,3,2,8,2,3,4,4,6,1,5,1,1,2,5,3,1,3,7,5,1,2,10,7,4,3,1,1,7,3,7,9,3,8,2,12,5,7,7,5,1,4,5,10,5,6,7,8,5,7,5,6,4,5,10,7,6,6,18,18,18,18,18,18,1,1,2,3,3,3,3,1,3,2,5,1,1,5,2,4,3,4,2,4,1,2,3,1,2,40,1,22,30,3,2,2,3,2,2,3,3,2,3,2,2,5,18,18,18,1,18,18,18,3,1,1,4,1,1,2,1,3,2,23,2,31,2,31,6,3,3,2,4,1,11,1,14,14,1,14,2,5,14,14,16,1,2,14,14,14,2,2,2,14,2,14,2,14,20,2,8,11,14,4,8,9,7,4,5,6,6,6,1,5,2,24,20,29,3,3,1,2,2,7,4,5,3,4,2,1,5,1,2,4,6,7,5,5,6,6,5,6,4,7,5,1,2,5,6,5,3,2,5,5,3,5,3,10,2,5,7,4,4,4,5,4,4,1,7,3,2,11,2,4,14,9,1]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","labelHighlightBold":true,"physics":false},"manipulation":{"enabled":false},"edges":{"length":10,"width":0.01,"scaling":{"min":0.1,"max":3},"smooth":false},"layout":{"randomSeed":123},"physics":{"stabilization":false},"interaction":{"multiselect":true},"groups":{"Executive":{"color":{"border":"#FA0A10","background":"#FB7E81","highlight":{"border":"#FA0A10","background":"#FB7E81"},"hover":{"background":"#FA0A10","border":"#FB7E81"}}},"Facilities":{"color":{"border":"#41A906","background":"#7BE141","highlight":{"border":"#41A906","background":"#7BE141"},"hover":{"background":"#41A906","border":"#7BE141"}}},"Engineering":{"color":{"border":"#FFA500","background":"#FFFF00","highlight":{"border":"#FFA500","background":"#FFFF00"},"hover":{"background":"#FFA500","border":"#FFFF00"}}},"Administration":{"color":{"border":"#2B7CE9","background":"#97C2FC","highlight":{"border":"#2B7CE9","background":"#97C2FC"},"hover":{"background":"#2B7CE9","border":"#97C2FC"}}},"Security":{"color":{"border":"#7C29F0","background":"#AD85E4","highlight":{"border":"#7C29F0","background":"#AD85E4"},"hover":{"background":"#7C29F0","border":"#AD85E4"}}},"useDefaultGroups":true,"Information Technology":{"color":{"border":"#E129F0","background":"#EB7DF4","highlight":{"border":"#E129F0","background":"#EB7DF4"},"hover":{"background":"#E129F0","border":"#EB7DF4"}}}}},"groups":["Executive","Facilities","Engineering","Administration","Security","Information Technology"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":["Administration","Engineering","Executive","Facilities","Information Technology","Security"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"shape":["square","square","square","square","square","square"],"label":["Executive","Facilities","Engineering","Administration","Security","Information Technology"],"color.background":["#FB7E81","#7BE141","#FFFF00","#97C2FC","#AD85E4","#EB7DF4"],"color.border":["black","black","black","black","black","black"],"font.align":["center","center","center","center","center","center"],"font.size":[20,20,20,20,20,20]},"nodesToDataframe":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="creating-the-email-network-communities-by-weight-i.e.-frequency-of-email-correspondence">Creating the email Network, communities by Weight i.e. frequency of email correspondence</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>email_network_wt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span>d <span class='op'>=</span> <span class='va'>links</span>, 
                                          vertices <span class='op'>=</span> <span class='va'>nodes_df</span>, 
                                          directed <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>

<span class='va'>wt_comm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/cluster_edge_betweenness.html'>edge.betweenness.community</a></span><span class='op'>(</span><span class='va'>email_network_wt</span>, 
                                     weights <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>email_network_wt</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span><span class='op'>)</span>

<span class='va'>nodes_wt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network_wt</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, 
                       title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>email_network_wt</span><span class='op'>)</span><span class='op'>$</span><span class='va'>title</span>, 
                       group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>wt_comm</span><span class='op'>$</span><span class='va'>membership</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>edges_wt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>get.data.frame</a></span><span class='op'>(</span><span class='va'>email_network_wt</span>, what<span class='op'>=</span><span class='st'>"edges"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>

<span class='va'>nodes_wt</span><span class='op'>$</span><span class='va'>color.highlight.background</span> <span class='op'>&lt;-</span> <span class='st'>"brown"</span>
<span class='va'>nodes_wt</span> <span class='op'>&lt;-</span> <span class='va'>nodes_wt</span> <span class='op'>%&gt;%</span> 
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>font.size <span class='op'>=</span> <span class='fl'>25</span>,
                     font.weight<span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>nodes_wt</span>, <span class='va'>edges_wt</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visOptions.html'>visOptions</a></span><span class='op'>(</span>highlightNearest <span class='op'>=</span> <span class='cn'>TRUE</span>, 
             nodesIdSelection <span class='op'>=</span> <span class='cn'>T</span>,
             selectedBy <span class='op'>=</span> <span class='st'>"group"</span>
             <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>layout <span class='op'>=</span> <span class='st'>'layout_nicely'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visInteraction.html'>visInteraction</a></span><span class='op'>(</span>multiselect <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visLegend.html'>visLegend</a></span><span class='op'>(</span><span class='cn'>F</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-1ac8d74ab6f35847e17c" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-1ac8d74ab6f35847e17c">{"x":{"nodes":{"id":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"title":["SVP/CIO","Truck Driver","Geologist","Truck Driver","Assistant to CFO","Drill Technician","Truck Driver","Facilities Group Manager","Geologist","Drill Technician","Assistant to IT Group Manager","Truck Driver","Truck Driver","Assistant to Security Group Manager","Lead Janitor","Truck Driver","Perimeter Control","Drill Technician","Janitor","Engineer","Security Group Manager","Hydraulic Technician","Truck Driver","Perimeter Control","Site Control","Site Control","SVP/CFO","Truck Driver","IT Technician","Drill Technician","Perimeter Control","Badging Office","Drill Technician","Engineer","Engineering Group Manager","Assistant to COO","IT Group Manager","Site Control","IT Helpdesk","Drill Site Manager","Assistant to CEO","Perimeter Control","IT Technician","SVP/COO","Assistant to CIO","Assistant to Engineering Group Manager","CEO","Building Control","IT Technician","Truck Driver","Badging Office","Janitor","Hydraulic Technician","Environmental Safety Advisor"],"group":["1","2","3","2","4","3","2","2","3","3","4","2","2","4","2","2","4","3","2","3","4","3","2","4","4","4","1","2","5","3","4","4","3","3","3","4","4","4","4","3","4","4","5","1","4","4","1","4","5","2","4","2","3","1"],"color.highlight.background":["brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown"],"font.size":[25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],"font.weight":[1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000],"label":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"x":[-0.237248228695738,1,-0.662729708602507,0.940357351583346,0.266150814015556,-0.744421507281928,0.392347428283775,0.815757424236406,-0.727449675507134,-1,0.544891907801517,0.423257526118051,0.677284549419765,0.610274054879098,0.642830513698268,0.909892197332551,-0.409954637960792,-0.538189090973935,0.609478463822248,-0.441881552595151,-0.105084093946672,-0.667371205544862,0.399961340787343,-0.186023385061999,-0.126547285251147,-0.306034110542631,-0.549508305154453,0.56836020868507,-0.107304692948616,-0.890119184993188,-0.019612016944649,-0.335748401777382,-0.785610252303609,-0.607611155116689,-0.932207853784548,0.371331330877325,0.0918613726823625,-0.482673466361856,0.417111656273138,-0.415858030411083,0.856725719190048,-0.334211757581545,-0.139689878103286,-0.34584022696108,0.544351153003208,0.113063822542742,-0.224460761289764,-0.288827327696296,0.268904236290696,0.71413942955639,-0.625508453657192,0.924121872193182,-0.562577591557932,-0.659439551258678],"y":[-0.789918920972067,-0.473293740155571,0.180065718600335,-0.380031662928022,0.0674063784137622,0.319129902090066,-0.312198486292302,-0.572147570475202,0.505548357239529,0.339146609589106,0.121024490481017,-0.442058011822077,-0.320739268410899,0.240902450320625,-0.227370778596301,-0.523566372778724,-0.294776831072051,0.15290434724195,-0.155468801576654,0.247014088832613,-0.425634110269119,0.0893753109564352,-0.518151446959575,-0.172783596938098,-0.0848047271771631,-0.413778079497522,-0.654958275386627,-0.500907726488846,0.910257888353477,0.249802248122657,-0.268787334669361,-0.129816782959346,0.043615854799836,0.407879468549222,0.419157034733343,0.309369574222393,0.0822983087574196,-0.361357558765611,0.487197747986243,0.336898793240754,0.0961379298038119,-0.00973065837933862,0.559320886303816,-0.646684007028594,-0.0207475699808408,-0.0927519523590764,-1,-0.2950559522982,1,-0.406500039445751,-0.241415101161338,-0.279177071556485,0.284590519600355,-0.878118654811763]},"edges":{"from":["Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Henk Mies","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Irene Nant","Isak Baza","Isak Baza","Isak Baza","Isak Baza","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Kare Orilla","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lars Azada","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Lidelse Dedos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linda Lagos","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Linnea Bergen","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Lucas Alcazar","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Marin Onda","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Mat Bramar","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Minke Mies","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Nils Calixto","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Orhan Strum","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Rachel Pantanal","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Ruscella Mies Haber","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Sten Sanjorge Jr","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Stenig Fusil","Sven Flecha","Sven Flecha","Sven Flecha","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Valeria Morlun","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varja Lagos","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Varro Awelon","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Vira Frente","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais","Willem Vasco-Pais"],"to":["Felix Resumir","Ingrid Barranco","Orhan Strum","Ruscella Mies Haber","Sten Sanjorge Jr","Willem Vasco-Pais","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Axel Calzas","Birgitta Frente","Brand Tempestad","Cecilia Morluniau","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Ruscella Mies Haber","Vira Frente","Adan Morlun","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Rachel Pantanal","Valeria Morlun","Varro Awelon","Carla Forluniau","Cornelia Lais","Gustav Cazar","Henk Mies","Lars Azada","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Valeria Morlun","Adra Nubarron","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Nils Calixto","Varja Lagos","Vira Frente","Adan Morlun","Albina Hafon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Elsa Orilla","Emile Arpa","Felix Resumir","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Adra Nubarron","Axel Calzas","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isak Baza","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Axel Calzas","Birgitta Frente","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Anda Ribera","Cornelia Lais","Felix Balas","Irene Nant","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Ingrid Barranco","Irene Nant","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Isia Vann","Linnea Bergen","Rachel Pantanal","Valeria Morlun","Varro Awelon","Anda Ribera","Carla Forluniau","Hideki Cocinaro","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dylan Scozzese","Emile Arpa","Felix Resumir","Henk Mies","Hideki Cocinaro","Irene Nant","Lucas Alcazar","Mat Bramar","Valeria Morlun","Varro Awelon","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Elsa Orilla","Felix Resumir","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Varja Lagos","Adra Nubarron","Axel Calzas","Benito Hawelon","Birgitta Frente","Brand Tempestad","Edvard Vann","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Henk Mies","Irene Nant","Lucas Alcazar","Marin Onda","Valeria Morlun","Varro Awelon","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Carla Forluniau","Elsa Orilla","Gustav Cazar","Hennie Osvaldo","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Varja Lagos","Vira Frente","Ada Campo-Corrente","Benito Hawelon","Dante Coginian","Edvard Vann","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Varja Lagos","Adra Nubarron","Anda Ribera","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Orhan Strum","Vira Frente","Adan Morlun","Albina Hafon","Anda Ribera","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Edvard Vann","Emile Arpa","Inga Ferro","Irene Nant","Sten Sanjorge Jr","Valeria Morlun","Varro Awelon","Edvard Vann","Felix Balas","Felix Resumir","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Rachel Pantanal","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Cornelia Lais","Dante Coginian","Edvard Vann","Felix Resumir","Hennie Osvaldo","Inga Ferro","Isande Borrasca","Isia Vann","Kanon Herrero","Minke Mies","Stenig Fusil","Varja Lagos","Edvard Vann","Felix Resumir","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Willem Vasco-Pais","Ada Campo-Corrente","Cecilia Morluniau","Kare Orilla","Loreto Bodrogi","Orhan Strum","Sten Sanjorge Jr","Willem Vasco-Pais","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Orhan Strum","Valeria Morlun","Varro Awelon","Birgitta Frente","Lucas Alcazar","Nils Calixto","Sven Flecha","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Hideki Cocinaro","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Claudio Hawelon","Edvard Vann","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Kanon Herrero","Loreto Bodrogi","Minke Mies","Rachel Pantanal","Stenig Fusil","Varja Lagos","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Irene Nant","Isia Vann","Loreto Bodrogi","Minke Mies","Nils Calixto","Stenig Fusil","Varja Lagos","Adra Nubarron","Axel Calzas","Benito Hawelon","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Inga Ferro","Ingrid Barranco","Isande Borrasca","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Anda Ribera","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lidelse Dedos","Marin Onda","Vira Frente","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Marin Onda","Vira Frente","Anda Ribera","Carla Forluniau","Cornelia Lais","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Vira Frente","Axel Calzas","Claudio Hawelon","Hennie Osvaldo","Inga Ferro","Isia Vann","Loreto Bodrogi","Lucas Alcazar","Minke Mies","Rachel Pantanal","Ruscella Mies Haber","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Isia Vann","Kanon Herrero","Minke Mies","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Dante Coginian","Emile Arpa","Isak Baza","Linnea Bergen","Nils Calixto","Sven Flecha","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Emile Arpa","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Vira Frente","Anda Ribera","Carla Forluniau","Cornelia Lais","Dante Coginian","Linda Lagos","Rachel Pantanal","Ruscella Mies Haber","Varro Awelon","Adra Nubarron","Hennie Osvaldo","Inga Ferro","Isia Vann","Loreto Bodrogi","Nils Calixto","Ruscella Mies Haber","Vira Frente","Axel Calzas","Isak Baza","Kanon Herrero","Lucas Alcazar","Minke Mies","Sven Flecha","Ada Campo-Corrente","Gustav Cazar","Ingrid Barranco","Irene Nant","Sten Sanjorge Jr","Stenig Fusil","Willem Vasco-Pais","Albina Hafon","Anda Ribera","Carla Forluniau","Claudio Hawelon","Cornelia Lais","Hennie Osvaldo","Isia Vann","Linda Lagos","Mat Bramar","Ruscella Mies Haber","Ada Campo-Corrente","Adra Nubarron","Anda Ribera","Carla Forluniau","Cornelia Lais","Hennie Osvaldo","Inga Ferro","Isia Vann","Linda Lagos","Loreto Bodrogi","Mat Bramar","Minke Mies","Rachel Pantanal","Ada Campo-Corrente","Henk Mies","Ingrid Barranco","Orhan Strum","Willem Vasco-Pais","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Orhan Strum","Varja Lagos","Vira Frente","Isak Baza","Lucas Alcazar","Nils Calixto","Adan Morlun","Albina Hafon","Anda Ribera","Benito Hawelon","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Stenig Fusil","Varro Awelon","Axel Calzas","Edvard Vann","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Minke Mies","Stenig Fusil","Adan Morlun","Albina Hafon","Benito Hawelon","Bertrand Ovan","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Mat Bramar","Valeria Morlun","Adra Nubarron","Axel Calzas","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Marin Onda","Minke Mies","Stenig Fusil","Ada Campo-Corrente","Inga Ferro","Ingrid Barranco","Orhan Strum","Sten Sanjorge Jr","Varja Lagos"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"width":0.2,"smooth":false},"physics":{"stabilization":false},"interaction":{"multiselect":true}},"groups":["1","2","3","4","5"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":["1","2","3","4","5"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
<h3 id="creating-the-email-network-communites-by-text">Creating the email Network, communites by Text</h3>
<ol type="1">
<li>First, we create the dataframe below <code>emails_grouped</code>. This dataframe contains email correspondence with cleaned and tokenized text.</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>emails_grouped</span><span class='op'>&lt;-</span> <span class='va'>df.emails</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>To <span class='op'>=</span> <span class='fu'>str_split</span><span class='op'>(</span><span class='va'>To</span>,pattern<span class='op'>=</span><span class='st'>','</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'>unnest_longer</span><span class='op'>(</span><span class='va'>To</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>To <span class='op'>=</span> <span class='fu'>str_trim</span><span class='op'>(</span><span class='va'>To</span><span class='op'>)</span>,
                         From <span class='op'>=</span> <span class='fu'>str_trim</span><span class='op'>(</span><span class='va'>From</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>From</span><span class='op'>==</span><span class='va'>To</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://rdrr.io/pkg/tidytext/man/unnest_tokens.html'>unnest_tokens</a></span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>Subject</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter-joins.html'>anti_join</a></span><span class='op'>(</span><span class='va'>stop_words</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>From</span>,<span class='va'>To</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'>count</span><span class='op'>(</span><span class='va'>word</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>word <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>word</span>, collapse <span class='op'>=</span> <span class='st'>","</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>From</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>df.emp</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"From"</span><span class='op'>=</span><span class='st'>"FullName"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>From</span>, <span class='va'>To</span>, <span class='va'>word</span>, <span class='va'>CurrentEmploymentType</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>CurrentEmploymentType</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                  <span class='fu'>replace_na</span><span class='op'>(</span>replace<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>From_dep <span class='op'>=</span> <span class='st'>"Executive"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/sample_n.html'>sample_n</a></span><span class='op'>(</span><span class='va'>emails_grouped</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<colgroup>
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 78%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">From</th>
<th style="text-align: left;">To</th>
<th style="text-align: left;">word</th>
<th style="text-align: left;">group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Adan Morlun</td>
<td style="text-align: left;">Dylan Scozzese</td>
<td style="text-align: left;">1,advisory,caution,downtown,drive,effective,facilities,february,guys,ladies,meeting,night,policies,preparations,refueling,text,traffic,union,vip,visit</td>
<td style="text-align: left;">Facilities</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gustav Cazar</td>
<td style="text-align: left;">Lars Azada</td>
<td style="text-align: left;">00,2516,2522,downhole,field,gis,logging,openhole,prediction,results,rotation,schedule,update</td>
<td style="text-align: left;">Engineering</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Felix Resumir</td>
<td style="text-align: left;">Inga Ferro</td>
<td style="text-align: left;">20,inspection,january,procedures,request,security,site,vip,visit</td>
<td style="text-align: left;">Security</td>
</tr>
<tr class="even">
<td style="text-align: left;">Minke Mies</td>
<td style="text-align: left;">Adra Nubarron</td>
<td style="text-align: left;">awwww,cute</td>
<td style="text-align: left;">Security</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Irene Nant</td>
<td style="text-align: left;">Adan Morlun</td>
<td style="text-align: left;">advisory,careful,facilities,funny,guys,ladies,list,night,preparations,repairs,toolbox,traffic,truck,vip,visit</td>
<td style="text-align: left;">Facilities</td>
</tr>
</tbody>
</table>
</div>
<ol start="2" type="1">
<li>Create the Text Network</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>email_text</span> <span class='op'>&lt;-</span> <span class='fu'>PrepText</span><span class='op'>(</span><span class='va'>emails_grouped</span>, 
                  groupvar <span class='op'>=</span> <span class='st'>"From"</span>, 
                  textvar <span class='op'>=</span> <span class='st'>"word"</span>, 
                  node_type <span class='op'>=</span> <span class='st'>"groups"</span>, 
                  tokenizer <span class='op'>=</span> <span class='st'>"words"</span>, 
                  compound_nouns <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>email_text_nt</span> <span class='op'>&lt;-</span> <span class='fu'>CreateTextnet</span><span class='op'>(</span><span class='va'>email_text</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Re-edit the <code>VisTextNet</code> function to include the coloring of nodes by department</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>VisTextNet_e_2</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>text_network</span>, <span class='va'>alpha</span> <span class='op'>=</span> <span class='fl'>.25</span>, <span class='va'>label_degree_cut</span><span class='op'>=</span><span class='fl'>0</span>, <span class='va'>df</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/which_multiple.html'>has.multiple</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>)</span>
    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"textnets does not yet support multiple edges"</span><span class='op'>)</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='va'>text_network</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/set_vertex_attr.html'>set_vertex_attr</a></span><span class='op'>(</span><span class='va'>text_network</span>, <span class='st'>"name"</span>, value <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gorder.html'>vcount</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>}</span>
  
  <span class='co'>#create network backbone </span>
  
  <span class='va'>e</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'>igraph</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>as_data_frame</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span> <span class='op'>]</span>, 
             weight <span class='op'>=</span>   <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span><span class='op'>)</span>
  
  <span class='co'># in</span>
  <span class='va'>w_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/strength.html'>graph.strength</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
  <span class='va'>w_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>w_in</span><span class='op'>)</span>, <span class='va'>w_in</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>k_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"in"</span><span class='op'>)</span>
  <span class='va'>k_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>k_in</span><span class='op'>)</span>, <span class='va'>k_in</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  
  <span class='va'>e_in</span> <span class='op'>&lt;-</span> <span class='va'>e</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>w_in</span>, by <span class='op'>=</span> <span class='st'>"to"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>k_in</span>, by <span class='op'>=</span> <span class='st'>"to"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>alpha_in <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='op'>(</span><span class='va'>weight</span><span class='op'>/</span><span class='va'>w_in</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='va'>k_in</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='co'># out</span>
  
  <span class='va'>w_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/strength.html'>graph.strength</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"out"</span><span class='op'>)</span>
  <span class='va'>w_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>w_out</span><span class='op'>)</span>, <span class='va'>w_out</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  <span class='va'>k_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>text_network</span>, mode <span class='op'>=</span> <span class='st'>"out"</span><span class='op'>)</span>
  <span class='va'>k_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>k_out</span><span class='op'>)</span>, <span class='va'>k_out</span>, stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  
  <span class='va'>e_out</span> <span class='op'>&lt;-</span> <span class='va'>e</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>w_out</span>, by <span class='op'>=</span> <span class='st'>"from"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>k_out</span>, by <span class='op'>=</span> <span class='st'>"from"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>alpha_out <span class='op'>=</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='op'>(</span><span class='va'>weight</span><span class='op'>/</span><span class='va'>w_out</span><span class='op'>)</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='va'>k_out</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>e_full</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>e_in</span>, <span class='va'>e_out</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"from"</span>, <span class='st'>"to"</span>, <span class='st'>"weight"</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>e_full</span> <span class='op'>&lt;-</span> <span class='va'>e_full</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>alpha_in</span> <span class='op'>&lt;</span> <span class='va'>alpha_out</span>, <span class='va'>alpha_in</span>, <span class='va'>alpha_out</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>from</span>, <span class='va'>to</span>, <span class='va'>alpha</span><span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>alpha</span> <span class='op'>&lt;-</span> <span class='va'>e_full</span><span class='op'>$</span><span class='va'>alpha</span>
  
  <span class='va'>pruned</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/delete_edges.html'>delete.edges</a></span><span class='op'>(</span><span class='va'>text_network</span>, <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>text_network</span><span class='op'>)</span><span class='op'>$</span><span class='va'>alpha</span> <span class='op'>&gt;=</span> <span class='va'>alpha</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>pruned</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/delete_vertices.html'>delete.vertices</a></span><span class='op'>(</span><span class='va'>pruned</span>, <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>size</span> <span class='op'>&lt;-</span> <span class='fl'>25</span>
  
  <span class='va'>isolates</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>]</span>
  <span class='va'>pruned</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/delete_vertices.html'>delete.vertices</a></span><span class='op'>(</span><span class='va'>pruned</span>, <span class='va'>isolates</span><span class='op'>)</span>
 
  
  <span class='va'>nodes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, 
                      title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Degree of Node: &lt;br&gt;"</span>,
                                     <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>degree</span><span class='op'>)</span>,
                      size <span class='op'>=</span>  <span class='va'>size</span>
                      <span class='op'>)</span>
  
  <span class='va'>nodes</span><span class='op'>&lt;-</span><span class='va'>nodes</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>FullName</span>,<span class='va'>CurrentEmploymentType</span><span class='op'>)</span>, by<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span><span class='op'>=</span><span class='st'>"FullName"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>group<span class='op'>=</span> <span class='va'>CurrentEmploymentType</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>replace_na</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>group<span class='op'>=</span><span class='st'>"Executive"</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>nodes</span> <span class='op'>&lt;-</span> <span class='va'>nodes</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>nodes</span><span class='op'>$</span><span class='va'>id</span>, decreasing <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>,<span class='op'>]</span>
  <span class='va'>nodes</span><span class='op'>$</span><span class='va'>shadow</span> <span class='op'>&lt;-</span> <span class='cn'>TRUE</span>
  <span class='va'>nodes</span> <span class='op'>&lt;-</span> <span class='va'>nodes</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>font.size <span class='op'>=</span> <span class='fl'>20</span>, font.weight<span class='op'>=</span> <span class='fl'>900</span><span class='op'>)</span>
  <span class='va'>nodes</span><span class='op'>$</span><span class='va'>color.highlight.background</span> <span class='op'>&lt;-</span> <span class='st'>"brown"</span>

  <span class='va'>edges</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>get.data.frame</a></span><span class='op'>(</span><span class='va'>pruned</span>, what<span class='op'>=</span><span class='st'>"edges"</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>
  <span class='va'>edges</span><span class='op'>$</span><span class='va'>value</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>pruned</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span>
  <span class='va'>nodes</span><span class='op'>$</span><span class='va'>color.highlight.background</span> <span class='op'>&lt;-</span> <span class='st'>"brown"</span>
  
  <span class='va'>lnodes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'square'</span>,<span class='fl'>6</span><span class='op'>)</span>,
                     label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Executive"</span>,
                               <span class='st'>"Facilities"</span>,
                               <span class='st'>"Engineering"</span>,
                               <span class='st'>"Administration"</span>,
                               <span class='st'>"Security"</span>,
                               <span class='st'>"Information Technology"</span><span class='op'>)</span>,
                     color.background <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#FB7E81"</span>,
                                          <span class='st'>"#7BE141"</span>,
                                          <span class='st'>"#FFFF00"</span>,
                                          <span class='st'>"#97C2FC"</span>,
                                          <span class='st'>"#AD85E4"</span>,
                                          <span class='st'>"#EB7DF4"</span><span class='op'>)</span>,
                     color.border <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'black'</span>,<span class='fl'>6</span><span class='op'>)</span>,
                     font.align <span class='op'>=</span>  <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"center"</span>,<span class='fl'>6</span><span class='op'>)</span>,
                     font.size <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>20</span>,<span class='fl'>6</span><span class='op'>)</span>
                     <span class='op'>)</span>

  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span><span class='va'>nodes</span>, <span class='va'>edges</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visLayout.html'>visLayout</a></span><span class='op'>(</span>randomSeed <span class='op'>=</span> <span class='fl'>123</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visOptions.html'>visOptions</a></span><span class='op'>(</span>highlightNearest <span class='op'>=</span> <span class='cn'>TRUE</span>, 
               nodesIdSelection <span class='op'>=</span> <span class='cn'>TRUE</span>, 
               selectedBy <span class='op'>=</span> <span class='st'>"group"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>labelHighlightBold <span class='op'>=</span> <span class='cn'>T</span>, size<span class='op'>=</span><span class='fl'>20</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visEdges.html'>visEdges</a></span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.01</span>,length <span class='op'>=</span> <span class='fl'>10</span>, scaling <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>min<span class='op'>=</span><span class='fl'>0.1</span>,max<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>layout <span class='op'>=</span> <span class='st'>'layout.davidson.harel'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visInteraction.html'>visInteraction</a></span><span class='op'>(</span>multiselect <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visLegend.html'>visLegend</a></span><span class='op'>(</span>zoom <span class='op'>=</span> <span class='cn'>T</span>, addNodes <span class='op'>=</span> <span class='va'>lnodes</span>, useGroups <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>  <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visGroups.html'>visGroups</a></span><span class='op'>(</span>groupname <span class='op'>=</span> <span class='st'>"Executive"</span>, 
                <span class='co'># Red</span>
                color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#FA0A10"</span>, 
                             background <span class='op'>=</span> <span class='st'>"#FB7E81"</span>, 
                             highlight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#FA0A10"</span>, background <span class='op'>=</span> <span class='st'>"#FB7E81"</span><span class='op'>)</span>,
                             hover <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>background <span class='op'>=</span> <span class='st'>"#FA0A10"</span>, border <span class='op'>=</span> <span class='st'>"#FB7E81"</span><span class='op'>)</span>
                             <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visGroups.html'>visGroups</a></span><span class='op'>(</span>groupname <span class='op'>=</span> <span class='st'>"Facilities"</span>, 
                <span class='co'># Green</span>
                color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#41A906"</span>, 
                             background <span class='op'>=</span> <span class='st'>"#7BE141"</span>, 
                             highlight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#41A906"</span>, background <span class='op'>=</span> <span class='st'>"#7BE141"</span><span class='op'>)</span>,
                             hover <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>background <span class='op'>=</span> <span class='st'>"#41A906"</span>, border <span class='op'>=</span> <span class='st'>"#7BE141"</span><span class='op'>)</span>
                             <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visGroups.html'>visGroups</a></span><span class='op'>(</span>groupname <span class='op'>=</span> <span class='st'>"Engineering"</span>, 
                <span class='co'># Yellow</span>
                    color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#FFA500"</span>, 
                                 background <span class='op'>=</span> <span class='st'>"#FFFF00"</span>, 
                                 highlight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#FFA500"</span>, background <span class='op'>=</span> <span class='st'>"#FFFF00"</span><span class='op'>)</span>,
                                 hover <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>background <span class='op'>=</span> <span class='st'>"#FFA500"</span>, border <span class='op'>=</span> <span class='st'>"#FFFF00"</span><span class='op'>)</span>
                                 <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visGroups.html'>visGroups</a></span><span class='op'>(</span>groupname <span class='op'>=</span> <span class='st'>"Administration"</span>, 
                <span class='co'># Blue</span>
                    color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#2B7CE9"</span>, 
                                 background <span class='op'>=</span> <span class='st'>"#97C2FC"</span>, 
                                 highlight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#2B7CE9"</span>, background <span class='op'>=</span> <span class='st'>"#97C2FC"</span><span class='op'>)</span>,
                                 hover <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>background <span class='op'>=</span> <span class='st'>"#2B7CE9"</span>, border <span class='op'>=</span> <span class='st'>"#97C2FC"</span><span class='op'>)</span>
                                 <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visGroups.html'>visGroups</a></span><span class='op'>(</span>groupname <span class='op'>=</span> <span class='st'>"Security"</span>, 
                <span class='co'># Purple</span>
                    color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#7C29F0"</span>, 
                                 background <span class='op'>=</span> <span class='st'>"#AD85E4"</span>, 
                                 highlight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#7C29F0"</span>, background <span class='op'>=</span> <span class='st'>"#AD85E4"</span><span class='op'>)</span>,
                                 hover <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>background <span class='op'>=</span> <span class='st'>"#7C29F0"</span>, border <span class='op'>=</span> <span class='st'>"#AD85E4"</span><span class='op'>)</span>
                                 <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visGroups.html'>visGroups</a></span><span class='op'>(</span>groupname <span class='op'>=</span> <span class='st'>"Information Technology"</span>, 
                <span class='co'># Magenta</span>
                    color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#E129F0"</span>, 
                                 background <span class='op'>=</span> <span class='st'>"#EB7DF4"</span>, 
                                 highlight <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>border <span class='op'>=</span> <span class='st'>"#E129F0"</span>, background <span class='op'>=</span> <span class='st'>"#EB7DF4"</span><span class='op'>)</span>,
                                 hover <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>background <span class='op'>=</span> <span class='st'>"#E129F0"</span>, border <span class='op'>=</span> <span class='st'>"#EB7DF4"</span><span class='op'>)</span>
                                 <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
      <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visLegend.html'>visLegend</a></span><span class='op'>(</span>zoom <span class='op'>=</span> <span class='cn'>T</span>, addNodes <span class='op'>=</span> <span class='va'>lnodes</span>, useGroups <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>
    
<span class='op'>}</span>
</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Create visNetwork object</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>390</span><span class='op'>)</span>

<span class='fu'>VisTextNet_e_2</span><span class='op'>(</span><span class='va'>email_text_nt</span>, df <span class='op'>=</span> <span class='va'>df.emp</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-d00dd67d7949b2a0ae29" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-d00dd67d7949b2a0ae29">{"x":{"nodes":{"id":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"title":["Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>","Degree of Node: <br>"],"size":[25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],"group":["Executive","Facilities","Engineering","Facilities","Administration","Engineering","Facilities","Facilities","Engineering","Engineering","Administration","Facilities","Facilities","Administration","Facilities","Facilities","Security","Engineering","Facilities","Engineering","Security","Engineering","Facilities","Security","Security","Security","Executive","Facilities","Information Technology","Engineering","Security","Security","Engineering","Engineering","Engineering","Administration","Information Technology","Security","Information Technology","Engineering","Administration","Security","Information Technology","Executive","Administration","Administration","Executive","Security","Information Technology","Facilities","Security","Facilities","Engineering","Executive"],"shadow":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],"font.size":[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],"font.weight":[900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900,900],"color.highlight.background":["brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown","brown"],"label":["Ada Campo-Corrente","Adan Morlun","Adra Nubarron","Albina Hafon","Anda Ribera","Axel Calzas","Benito Hawelon","Bertrand Ovan","Birgitta Frente","Brand Tempestad","Carla Forluniau","Cecilia Morluniau","Claudio Hawelon","Cornelia Lais","Dante Coginian","Dylan Scozzese","Edvard Vann","Elsa Orilla","Emile Arpa","Felix Balas","Felix Resumir","Gustav Cazar","Henk Mies","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Ingrid Barranco","Irene Nant","Isak Baza","Isande Borrasca","Isia Vann","Kanon Herrero","Kare Orilla","Lars Azada","Lidelse Dedos","Linda Lagos","Linnea Bergen","Loreto Bodrogi","Lucas Alcazar","Marin Onda","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Rachel Pantanal","Ruscella Mies Haber","Sten Sanjorge Jr","Stenig Fusil","Sven Flecha","Valeria Morlun","Varja Lagos","Varro Awelon","Vira Frente","Willem Vasco-Pais"],"x":[0.897663560344942,0.843677385007338,-0.445596980586161,0.730493480034587,-0.452892174817589,-0.551237160381534,0.495253947845915,0.994641177932535,-0.655849285102873,-0.91796389173391,-0.586073616703721,0.637538859702341,0.388506672639635,-0.36450929002573,0.533384492299173,0.579593171458856,0.335889789046548,-0.448018175496282,0.538260747072813,-0.926504493673672,0.219423968751637,-0.349312284390781,0.638558921187961,0.153670534734248,0.268786151708424,0.184813455683662,0.892196675576035,0.459270992033842,-0.927591754371423,-0.758930820069532,0.0789004324929352,0.191316057430848,-0.586769224737682,-0.581759732434363,-0.618398096159419,-0.453524066323168,-0.0395290824491545,0.0348928675068028,-0.819535023244261,-0.544696812976201,-0.339628234455464,0.00614089187152556,-0.968820560623855,0.974268008700606,-0.587150993213311,-0.28036801552335,0.790878439975266,0.442363059962892,-1,0.717758864483236,0.21683684883723,0.582609706279408,-0.654121873963798,1],"y":[0.374237722221098,-0.665239235942498,0.935641902807831,-0.686499992452609,-0.387098545760387,0.766474476011088,-1,-0.674031668017197,0.858936343775375,0.773238538104481,-0.366470900565108,-0.554797292037906,-0.388680489312999,-0.546997880956987,-0.875909764925557,-0.595532368950688,0.181259738134058,0.640556311569928,-0.339203255687029,0.704326755695271,-0.123240727543434,0.56949891376699,-0.733421286521981,0.00597558582534607,0.0983586755240342,-0.266071551421487,0.490490252770814,-0.398624402808353,-0.276724163176955,0.754460768836357,0.253477277727775,0.0881258917311829,0.779506072310682,1,0.712039354391319,-0.446720116106,-0.0301120373649408,0.138844027707898,-0.260208967775006,0.85386567967663,-0.282777857541294,-0.141065256132359,-0.377031613272529,0.561515095929424,-0.45136906539442,-0.121761569367582,0.489709010868173,0.185662371192646,-0.200639763974655,-0.55951302008392,-0.0117904157040265,-0.787251921263115,0.92047234284715,0.39872058856571]},"edges":{"from":["Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Ada Campo-Corrente","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adan Morlun","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Adra Nubarron","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Albina Hafon","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Anda Ribera","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Axel Calzas","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Benito Hawelon","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Bertrand Ovan","Birgitta Frente","Birgitta Frente","Birgitta Frente","Birgitta Frente","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Brand Tempestad","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Carla Forluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Cecilia Morluniau","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Claudio Hawelon","Cornelia Lais","Cornelia Lais","Cornelia Lais","Cornelia Lais","Dante Coginian","Dante Coginian","Dante Coginian","Dante Coginian","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Dylan Scozzese","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Edvard Vann","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Elsa Orilla","Emile Arpa","Emile Arpa","Emile Arpa","Emile Arpa","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Balas","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Felix Resumir","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Gustav Cazar","Henk Mies","Henk Mies","Henk Mies","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hennie Osvaldo","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Hideki Cocinaro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Inga Ferro","Ingrid Barranco","Ingrid Barranco","Ingrid Barranco","Irene Nant","Irene Nant","Isak Baza","Isak Baza","Isak Baza","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isande Borrasca","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Isia Vann","Kanon Herrero","Kanon Herrero","Kanon Herrero","Kare Orilla","Kare Orilla","Kare Orilla","Lars Azada","Lars Azada","Lars Azada","Linda Lagos","Linda Lagos","Linda Lagos","Linnea Bergen","Linnea Bergen","Linnea Bergen","Loreto Bodrogi","Loreto Bodrogi","Loreto Bodrogi","Lucas Alcazar","Lucas Alcazar","Mat Bramar","Mat Bramar","Minke Mies","Nils Calixto","Orhan Strum","Orhan Strum","Rachel Pantanal","Sten Sanjorge Jr","Stenig Fusil"],"to":["Ingrid Barranco","Orhan Strum","Sten Sanjorge Jr","Willem Vasco-Pais","Albina Hafon","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Axel Calzas","Birgitta Frente","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Marin Onda","Vira Frente","Benito Hawelon","Bertrand Ovan","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Carla Forluniau","Cornelia Lais","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Birgitta Frente","Brand Tempestad","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Bertrand Ovan","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Henk Mies","Irene Nant","Varro Awelon","Cecilia Morluniau","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Felix Balas","Isande Borrasca","Lars Azada","Vira Frente","Elsa Orilla","Felix Balas","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Cornelia Lais","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Claudio Hawelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Dante Coginian","Dylan Scozzese","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Linda Lagos","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Dylan Scozzese","Henk Mies","Irene Nant","Varro Awelon","Emile Arpa","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Felix Resumir","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Stenig Fusil","Varja Lagos","Felix Balas","Gustav Cazar","Kare Orilla","Lars Azada","Marin Onda","Henk Mies","Irene Nant","Valeria Morlun","Varro Awelon","Gustav Cazar","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Vira Frente","Hennie Osvaldo","Hideki Cocinaro","Inga Ferro","Isia Vann","Kanon Herrero","Loreto Bodrogi","Stenig Fusil","Varja Lagos","Isande Borrasca","Kare Orilla","Lars Azada","Lidelse Dedos","Marin Onda","Irene Nant","Valeria Morlun","Varro Awelon","Hideki Cocinaro","Inga Ferro","Kanon Herrero","Linnea Bergen","Loreto Bodrogi","Minke Mies","Stenig Fusil","Varja Lagos","Isia Vann","Kanon Herrero","Loreto Bodrogi","Stenig Fusil","Varja Lagos","Isia Vann","Kanon Herrero","Linnea Bergen","Loreto Bodrogi","Minke Mies","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Orhan Strum","Sten Sanjorge Jr","Willem Vasco-Pais","Valeria Morlun","Varro Awelon","Lucas Alcazar","Nils Calixto","Sven Flecha","Kare Orilla","Lars Azada","Lidelse Dedos","Vira Frente","Kanon Herrero","Loreto Bodrogi","Ruscella Mies Haber","Stenig Fusil","Varja Lagos","Loreto Bodrogi","Stenig Fusil","Varja Lagos","Lars Azada","Lidelse Dedos","Marin Onda","Lidelse Dedos","Marin Onda","Vira Frente","Mat Bramar","Rachel Pantanal","Ruscella Mies Haber","Loreto Bodrogi","Minke Mies","Ruscella Mies Haber","Minke Mies","Ruscella Mies Haber","Varja Lagos","Nils Calixto","Sven Flecha","Rachel Pantanal","Ruscella Mies Haber","Ruscella Mies Haber","Sven Flecha","Sten Sanjorge Jr","Willem Vasco-Pais","Ruscella Mies Haber","Willem Vasco-Pais","Varja Lagos"],"value":[0.228218670236283,0.191717520541215,0.203682457851178,0.222194186314646,0.0897225326592802,0.108033923494372,0.127140695782431,0.0738354470109696,0.0533539428653692,0.0977726524303391,0.0885440120536524,0.075086998078543,0.0763533629579137,0.0657250946208278,0.0829089198352878,0.139075520136606,0.0992515680826003,0.0914042698605413,0.0763403302701283,0.100881824296988,0.0901761715576068,0.085098280016151,0.102110871606865,0.091693098349317,0.0859378926685612,0.180174368688988,0.132414137766199,0.106439355516595,0.0760377035144491,0.0918553557485114,0.127356171846914,0.0921691175450957,0.07715058005126,0.0964802460723866,0.0805492224625897,0.0373300785308208,0.139344966443169,0.129969795971339,0.154622714821532,0.0729539622338181,0.201841300184255,0.0487831190425079,0.068367943196818,0.0672357737410683,0.132677876572781,0.159331425322674,0.10500900164737,0.104301786197332,0.068651809891828,0.115756760932828,0.105805717982175,0.0897169365001917,0.101623998692739,0.0697668735870196,0.136399694669792,0.0658116096848202,0.188235064171445,0.0493829421005521,0.0740149351882215,0.075424792758102,0.198131089954209,0.0571463374797762,0.0628755988018968,0.116361358774439,0.0943953185857359,0.120746383382842,0.078412084365287,0.0691004619673369,0.0595264545160914,0.137477320940922,0.101781173431052,0.162594043324695,0.120992885166538,0.201334384108964,0.155954952902661,0.0942724338401081,0.0942364241608386,0.0859709292987616,0.0817127250257041,0.0797335560948681,0.0981030118166462,0.160190578664322,0.159230206567493,0.152062370006853,0.120811950415629,0.116353493464991,0.0951232440901707,0.104991591170287,0.074548234688657,0.0942650734733211,0.113100469521345,0.0976134850036543,0.119994226350105,0.108656284370637,0.0835776580300981,0.0836619295098965,0.0967289213077431,0.0906359719590026,0.0993546844720095,0.127868296672286,0.0812751837249106,0.0490519424627679,0.0780085751835592,0.127835075338961,0.105064003924187,0.0876101082683007,0.0436306477031759,0.100089320271381,0.0848649932689564,0.187211639248939,0.130083402225982,0.103502147777771,0.092002917614451,0.0815457218684987,0.0709045929866507,0.163367786094583,0.151008107239854,0.187954681263692,0.0968412586353773,0.0817340261090892,0.153920800348854,0.0772940394141323,0.192473018505339,0.1839338941377,0.0864458110813762,0.0893010712785608,0.105044006715148,0.0831187496636907,0.195115894671735,0.0562061159452871,0.0875652831574817,0.112263923087876,0.0598275510931968,0.108051551485075,0.0902386083752559,0.110614562857341,0.105153415296369,0.0946584895298016,0.0835659060574676,0.0864697404976827,0.128564700718151,0.0648099438624058,0.159729952274368,0.044548038211197,0.237511740835721,0.114014771530556,0.12359883583252,0.194561441119556,0.108518279013907,0.128143224688587,0.0991077927896751,0.135226200208711,0.0746384407915946,0.105978246864274,0.0589299901279111,0.0888677840301763,0.107589366387006,0.116521711797192,0.0943827979609478,0.209028602248013,0.112350779997821,0.180383937523307,0.190055344360232,0.186925898974326,0.131711154686712,0.0808136659153978,0.0556980507649191,0.1856376692781,0.135396479083351,0.0752357910924059,0.145156320901724,0.125357720955494,0.15474120401669,0.118874426953324,0.0514663561492483,0.0622584813764532,0.114403041837861,0.279128267931188,0.193022945571688,0.247449007240565,0.0797991231198575,0.0572495032989496,0.14736346222579,0.150451753514182,0.154988411158945,0.0843814206585361,0.0917311854596042,0.122075300187487,0.123679397348016,0.0662100491624553,0.0830650100259018,0.0382101720784695,0.0979945328847288,0.0477935996440329,0.123683725780944,0.0836937361020742,0.181128229910542,0.117941770947695,0.0858271417260174,0.0889864906868794,0.0856100082700542,0.0954320640507522,0.101867548911589,0.161277850141928,0.271532299775433,0.123963283517788,0.129081217617538,0.713564306831659,0.0922851785747745,0.116150493233684,0.0541983317137453,0.119137004515858,0.125090210189739,0.120872079130564,0.12006779299261,0.0876785204150807,0.0816542425462733,0.16969624158864,0.176041647327032,0.227364947850872,0.102565894640043,0.20587380014899,0.155190223556963]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","size":20,"labelHighlightBold":true,"physics":false},"manipulation":{"enabled":false},"layout":{"randomSeed":123},"edges":{"length":10,"width":0.01,"scaling":{"min":0.1,"max":3},"smooth":false},"physics":{"stabilization":false},"interaction":{"multiselect":true},"groups":{"Executive":{"color":{"border":"#FA0A10","background":"#FB7E81","highlight":{"border":"#FA0A10","background":"#FB7E81"},"hover":{"background":"#FA0A10","border":"#FB7E81"}}},"Facilities":{"color":{"border":"#41A906","background":"#7BE141","highlight":{"border":"#41A906","background":"#7BE141"},"hover":{"background":"#41A906","border":"#7BE141"}}},"Engineering":{"color":{"border":"#FFA500","background":"#FFFF00","highlight":{"border":"#FFA500","background":"#FFFF00"},"hover":{"background":"#FFA500","border":"#FFFF00"}}},"Administration":{"color":{"border":"#2B7CE9","background":"#97C2FC","highlight":{"border":"#2B7CE9","background":"#97C2FC"},"hover":{"background":"#2B7CE9","border":"#97C2FC"}}},"Security":{"color":{"border":"#7C29F0","background":"#AD85E4","highlight":{"border":"#7C29F0","background":"#AD85E4"},"hover":{"background":"#7C29F0","border":"#AD85E4"}}},"useDefaultGroups":true,"Information Technology":{"color":{"border":"#E129F0","background":"#EB7DF4","highlight":{"border":"#E129F0","background":"#EB7DF4"},"hover":{"background":"#E129F0","border":"#EB7DF4"}}}}},"groups":["Executive","Facilities","Engineering","Administration","Security","Information Technology"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":["Administration","Engineering","Executive","Facilities","Information Technology","Security"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"shape":["square","square","square","square","square","square"],"label":["Executive","Facilities","Engineering","Administration","Security","Information Technology"],"color.background":["#FB7E81","#7BE141","#FFFF00","#97C2FC","#AD85E4","#EB7DF4"],"color.border":["black","black","black","black","black","black"],"font.align":["center","center","center","center","center","center"],"font.size":[20,20,20,20,20,20]},"nodesToDataframe":true}},"evals":[],"jsHooks":[]}</script>
</div>
<h3 id="create-the-age-plot">Create the Age Plot</h3>
<div class="layout-chunk" data-layout="l-body">

</div>
<ol type="1">
<li>Create a new dataframe <code>x_full</code>.</li>
</ol>
<p>This dataframe will contain the department each of the employee in the email is from.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x_full</span> <span class='op'>&lt;-</span> <span class='va'>df.emails</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>To <span class='op'>=</span> <span class='fu'>str_split</span><span class='op'>(</span><span class='va'>To</span>,pattern<span class='op'>=</span><span class='st'>','</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
          <span class='fu'>unnest_longer</span><span class='op'>(</span><span class='va'>To</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>To <span class='op'>=</span> <span class='fu'>str_trim</span><span class='op'>(</span><span class='va'>To</span><span class='op'>)</span>,
                 From <span class='op'>=</span> <span class='fu'>str_trim</span><span class='op'>(</span><span class='va'>From</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>From</span><span class='op'>==</span><span class='va'>To</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Subject2 <span class='op'>=</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>Subject</span>, <span class='st'>"[[:punct:]]"</span>, <span class='st'>" "</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>df.emp</span>, <span class='va'>FullName</span>, <span class='va'>CurrentEmploymentType</span>, <span class='va'>CurrentEmploymentTitle</span><span class='op'>)</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"From"</span><span class='op'>=</span><span class='st'>"FullName"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'>replace_na</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>CurrentEmploymentType <span class='op'>=</span> <span class='st'>"Executive"</span>, CurrentEmploymentTitle<span class='op'>=</span><span class='st'>"CEO"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>From_title <span class='op'>=</span> <span class='va'>CurrentEmploymentTitle</span>, From_dep <span class='op'>=</span>  <span class='va'>CurrentEmploymentType</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>df.emp</span>, <span class='va'>FullName</span>, <span class='va'>CurrentEmploymentTitle</span>, <span class='va'>CurrentEmploymentType</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"To"</span><span class='op'>=</span><span class='st'>"FullName"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>To_title <span class='op'>=</span> <span class='va'>CurrentEmploymentTitle</span>, To_dep <span class='op'>=</span>  <span class='va'>CurrentEmploymentType</span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>x_full</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>kableExtra</span><span class='fu'>::</span> <span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/kable_classic.html'>kable_paper</a></span><span class='op'>(</span><span class='st'>"hover"</span>, 
                           full_width <span class='op'>=</span> <span class='cn'>F</span>,
                           html_font <span class='op'>=</span> <span class='st'>"helvetica"</span><span class='op'>)</span>
</code></pre>
</div>
<table class=" lightable-paper lightable-hover" style="font-family: helvetica; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
From
</th>
<th style="text-align:left;">
To
</th>
<th style="text-align:left;">
Date
</th>
<th style="text-align:left;">
Subject
</th>
<th style="text-align:left;">
Date.Date
</th>
<th style="text-align:left;">
Date.Time
</th>
<th style="text-align:right;">
nTo
</th>
<th style="text-align:left;">
Subject2
</th>
<th style="text-align:left;">
From_dep
</th>
<th style="text-align:left;">
From_title
</th>
<th style="text-align:left;">
To_title
</th>
<th style="text-align:left;">
To_dep
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Varja Lagos
</td>
<td style="text-align:left;">
Hennie Osvaldo
</td>
<td style="text-align:left;">
2014-01-06 10:28:00
</td>
<td style="text-align:left;">
Patrol schedule changes
</td>
<td style="text-align:left;">
2014-01-06
</td>
<td style="text-align:left;">
10:28:00
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Patrol schedule changes
</td>
<td style="text-align:left;">
Security
</td>
<td style="text-align:left;">
Badging Office
</td>
<td style="text-align:left;">
Perimeter Control
</td>
<td style="text-align:left;">
Security
</td>
</tr>
<tr>
<td style="text-align:left;">
Varja Lagos
</td>
<td style="text-align:left;">
Loreto Bodrogi
</td>
<td style="text-align:left;">
2014-01-06 10:28:00
</td>
<td style="text-align:left;">
Patrol schedule changes
</td>
<td style="text-align:left;">
2014-01-06
</td>
<td style="text-align:left;">
10:28:00
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Patrol schedule changes
</td>
<td style="text-align:left;">
Security
</td>
<td style="text-align:left;">
Badging Office
</td>
<td style="text-align:left;">
Site Control
</td>
<td style="text-align:left;">
Security
</td>
</tr>
<tr>
<td style="text-align:left;">
Varja Lagos
</td>
<td style="text-align:left;">
Inga Ferro
</td>
<td style="text-align:left;">
2014-01-06 10:28:00
</td>
<td style="text-align:left;">
Patrol schedule changes
</td>
<td style="text-align:left;">
2014-01-06
</td>
<td style="text-align:left;">
10:28:00
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Patrol schedule changes
</td>
<td style="text-align:left;">
Security
</td>
<td style="text-align:left;">
Badging Office
</td>
<td style="text-align:left;">
Site Control
</td>
<td style="text-align:left;">
Security
</td>
</tr>
<tr>
<td style="text-align:left;">
Brand Tempestad
</td>
<td style="text-align:left;">
Birgitta Frente
</td>
<td style="text-align:left;">
2014-01-06 10:35:00
</td>
<td style="text-align:left;">
Wellhead flow rate data
</td>
<td style="text-align:left;">
2014-01-06
</td>
<td style="text-align:left;">
10:35:00
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Wellhead flow rate data
</td>
<td style="text-align:left;">
Engineering
</td>
<td style="text-align:left;">
Drill Technician
</td>
<td style="text-align:left;">
Geologist
</td>
<td style="text-align:left;">
Engineering
</td>
</tr>
<tr>
<td style="text-align:left;">
Brand Tempestad
</td>
<td style="text-align:left;">
Lars Azada
</td>
<td style="text-align:left;">
2014-01-06 10:35:00
</td>
<td style="text-align:left;">
Wellhead flow rate data
</td>
<td style="text-align:left;">
2014-01-06
</td>
<td style="text-align:left;">
10:35:00
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Wellhead flow rate data
</td>
<td style="text-align:left;">
Engineering
</td>
<td style="text-align:left;">
Drill Technician
</td>
<td style="text-align:left;">
Engineer
</td>
<td style="text-align:left;">
Engineering
</td>
</tr>
</tbody>
</table>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<ol start="2" type="1">
<li>Feed into a for-loop to generate the conversation plot_ly object for each employee</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>x_full</span><span class='op'>$</span><span class='va'>From</span>, <span class='va'>x_full</span><span class='op'>$</span><span class='va'>To</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  
    <span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>x_full</span> <span class='op'>%&gt;%</span>
           <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>From</span><span class='op'>==</span><span class='va'>i</span><span class='op'>)</span>
    
    <span class='va'>details</span><span class='op'>&lt;-</span> <span class='va'>x_full</span> <span class='op'>%&gt;%</span> 
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>From</span> <span class='op'>==</span> <span class='va'>i</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>From_dep</span>, <span class='va'>From_title</span><span class='op'>)</span>

    <span class='va'>g</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>dat</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>To</span>, x<span class='op'>=</span><span class='va'>Date.Time</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span> 
        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='co'>#position=position_dodge(width=1),</span>
                   size<span class='op'>=</span><span class='fl'>2</span>, alpha <span class='op'>=</span> <span class='fl'>0.6</span>, stroke<span class='op'>=</span><span class='fl'>0.5</span>, shape<span class='op'>=</span><span class='fl'>21</span>,
                   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"Sub: %s&lt;br&gt;Date: %s&lt;br&gt;To: %s&lt;br&gt;To_Title: %s&lt;br&gt;To_Dep: %s&lt;br&gt;Time Sent: %s&lt;br&gt;"</span>, 
                                      <span class='va'>Subject2</span>, 
                                      <span class='va'>Date.Date</span>, 
                                      <span class='va'>To</span>,
                                      <span class='va'>To_title</span>, 
                                      <span class='va'>To_dep</span>,
                                      <span class='va'>Date.Time</span><span class='op'>)</span>,
                      <span class='op'>)</span>
                   <span class='op'>)</span> <span class='op'>+</span>
        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>Subject2</span>, color<span class='op'>=</span> <span class='va'>Subject2</span><span class='op'>)</span>, size<span class='op'>=</span><span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>+</span>
        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='st'>""</span>,x<span class='op'>=</span><span class='st'>"Time"</span>,title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>i</span>,<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>details</span><span class='op'>)</span>, collapse <span class='op'>=</span> <span class='st'>','</span><span class='op'>)</span><span class='op'>)</span>, 
             group<span class='op'>=</span><span class='st'>""</span>, 
             color<span class='op'>=</span><span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span>
        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span>,
              panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill<span class='op'>=</span><span class='st'>"white"</span><span class='op'>)</span>,
              panel.grid.major.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='st'>"#f0f0f0"</span><span class='op'>)</span>,
              plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>14</span><span class='op'>)</span>
              <span class='op'>)</span>

    <span class='va'>gg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://docs.ropensci.org/plotly/reference/ggplotly.html'>ggplotly</a></span><span class='op'>(</span><span class='va'>g</span>, tooltip <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"text"</span><span class='op'>)</span><span class='op'>)</span> 

    <span class='co'>#show(gg)</span>
     
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gg</span>
</code></pre>
</div>
<div id="htmlwidget-4808fd13d7f36620e0c8" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4808fd13d7f36620e0c8">{"x":{"data":[{"x":[46560,51540,53820,42780,43620,42060,42060,42060,48660,48660,48660,70920,70920,70920,39900,49800,49800,49800,47220,49140,49140,49140,55440,55440,55440,57720,58380,58380,58380,64740,64740,64740,66900,66900,66900,46680,46680,31920,31920,31920,57900],"y":[4,4,4,2,2,5,1,4,5,1,4,1,4,5,6,4,1,5,5,1,4,3,1,4,3,4,1,4,3,5,1,4,5,1,4,5,1,5,1,3,4],"text":["Sub: RE  IPO<br>Date: 2014-01-06<br>To: Orhan Strum<br>To_Title: SVP/COO<br>To_Dep: Executive<br>Time Sent: 12:56:00<br>","Sub: RE  IPO<br>Date: 2014-01-06<br>To: Orhan Strum<br>To_Title: SVP/COO<br>To_Dep: Executive<br>Time Sent: 14:19:00<br>","Sub: RE  IPO<br>Date: 2014-01-06<br>To: Orhan Strum<br>To_Title: SVP/COO<br>To_Dep: Executive<br>Time Sent: 14:57:00<br>","Sub: RE  Late for meeting<br>Date: 2014-01-07<br>To: Inga Ferro<br>To_Title: Site Control<br>To_Dep: Security<br>Time Sent: 11:53:00<br>","Sub: RE  Late for meeting<br>Date: 2014-01-07<br>To: Inga Ferro<br>To_Title: Site Control<br>To_Dep: Security<br>Time Sent: 12:07:00<br>","Sub: RE  Impact of local politics on profit margin<br>Date: 2014-01-09<br>To: Sten Sanjorge Jr<br>To_Title: NA<br>To_Dep: NA<br>Time Sent: 11:41:00<br>","Sub: RE  Impact of local politics on profit margin<br>Date: 2014-01-09<br>To: Ada Campo-Corrente<br>To_Title: SVP/CIO<br>To_Dep: Executive<br>Time Sent: 11:41:00<br>","Sub: RE  Impact of local politics on profit margin<br>Date: 2014-01-09<br>To: Orhan Strum<br>To_Title: SVP/COO<br>To_Dep: Executive<br>Time Sent: 11:41:00<br>","Sub: RE  Impact of local politics on profit margin<br>Date: 2014-01-09<br>To: Sten Sanjorge Jr<br>To_Title: NA<br>To_Dep: NA<br>Time Sent: 13:31:00<br>","Sub: RE  Impact of local politics on profit margin<br>Date: 2014-01-09<br>To: Ada Campo-Corrente<br>To_Title: SVP/CIO<br>To_Dep: Executive<br>Time Sent: 13:31:00<br>","Sub: RE  Impact of local politics on profit margin<br>Date: 2014-01-09<br>To: Orhan Strum<br>To_Title: SVP/COO<br>To_Dep: Executive<br>Time Sent: 13:31:00<br>","Sub: RE  Impromptu golf vacation   who s in <br>Date: 2014-01-09<br>To: Ada Campo-Corrente<br>To_Title: SVP/CIO<br>To_Dep: Executive<br>Time Sent: 19:42:00<br>","Sub: RE  Impromptu golf vacation   who s in <br>Date: 2014-01-09<br>To: Orhan Strum<br>To_Title: SVP/COO<br>To_Dep: Executive<br>Time Sent: 19:42:00<br>","Sub: RE  Impromptu golf vacation   who s in <br>Date: 2014-01-09<br>To: Sten Sanjorge Jr<br>To_Title: NA<br>To_Dep: NA<br>Time Sent: 19:42:00<br>","Sub: Meeting<br>Date: 2014-01-10<br>To: Varja Lagos<br>To_Title: Badging Office<br>To_Dep: Security<br>Time Sent: 11:05:00<br>","Sub: Recommend a good vacation spot <br>Date: 2014-01-13<br>To: Orhan Strum<br>To_Title: SVP/COO<br>To_Dep: Executive<br>Time Sent: 13:50:00<br>","Sub: Recommend a good vacation spot <br>Date: 2014-01-13<br>To: Ada Campo-Corrente<br>To_Title: SVP/CIO<br>To_Dep: Executive<br>Time Sent: 13:50:00<br>","Sub: Recommend a good vacation spot <br>Date: 2014-01-13<br>To: Sten Sanjorge Jr<br>To_Title: NA<br>To_Dep: NA<br>Time Sent: 13:50:00<br>","Sub: Operational efficiencies<br>Date: 2014-01-14<br>To: Sten Sanjorge Jr<br>To_Title: NA<br>To_Dep: NA<br>Time Sent: 13:07:00<br>","Sub: Impact of local politics on profit margin<br>Date: 2014-01-14<br>To: Ada Campo-Corrente<br>To_Title: SVP/CIO<br>To_Dep: Executive<br>Time Sent: 13:39:00<br>","Sub: Impact of local politics on profit margin<br>Date: 2014-01-14<br>To: Orhan Strum<br>To_Title: SVP/COO<br>To_Dep: Executive<br>Time Sent: 13:39:00<br>","Sub: Impact of local politics on profit margin<br>Date: 2014-01-14<br>To: Ingrid Barranco<br>To_Title: SVP/CFO<br>To_Dep: Executive<br>Time Sent: 13:39:00<br>","Sub: RE  Impact of local politics on profit margin<br>Date: 2014-01-14<br>To: Ada Campo-Corrente<br>To_Title: SVP/CIO<br>To_Dep: Executive<br>Time Sent: 15:24:00<br>","Sub: RE  Impact of local politics on profit margin<br>Date: 2014-01-14<br>To: Orhan Strum<br>To_Title: SVP/COO<br>To_Dep: Executive<br>Time Sent: 15:24:00<br>","Sub: RE  Impact of local politics on profit margin<br>Date: 2014-01-14<br>To: Ingrid Barranco<br>To_Title: SVP/CFO<br>To_Dep: Executive<br>Time Sent: 15:24:00<br>","Sub: RE  Maximizing quarterly profits<br>Date: 2014-01-14<br>To: Orhan Strum<br>To_Title: SVP/COO<br>To_Dep: Executive<br>Time Sent: 16:02:00<br>","Sub: RE  Impact of local politics on profit margin<br>Date: 2014-01-14<br>To: Ada Campo-Corrente<br>To_Title: SVP/CIO<br>To_Dep: Executive<br>Time Sent: 16:13:00<br>","Sub: RE  Impact of local politics on profit margin<br>Date: 2014-01-14<br>To: Orhan Strum<br>To_Title: SVP/COO<br>To_Dep: Executive<br>Time Sent: 16:13:00<br>","Sub: RE  Impact of local politics on profit margin<br>Date: 2014-01-14<br>To: Ingrid Barranco<br>To_Title: SVP/CFO<br>To_Dep: Executive<br>Time Sent: 16:13:00<br>","Sub: RE  Yearly numbers looking good<br>Date: 2014-01-15<br>To: Sten Sanjorge Jr<br>To_Title: NA<br>To_Dep: NA<br>Time Sent: 17:59:00<br>","Sub: RE  Yearly numbers looking good<br>Date: 2014-01-15<br>To: Ada Campo-Corrente<br>To_Title: SVP/CIO<br>To_Dep: Executive<br>Time Sent: 17:59:00<br>","Sub: RE  Yearly numbers looking good<br>Date: 2014-01-15<br>To: Orhan Strum<br>To_Title: SVP/COO<br>To_Dep: Executive<br>Time Sent: 17:59:00<br>","Sub: RE  Yearly numbers looking good<br>Date: 2014-01-15<br>To: Sten Sanjorge Jr<br>To_Title: NA<br>To_Dep: NA<br>Time Sent: 18:35:00<br>","Sub: RE  Yearly numbers looking good<br>Date: 2014-01-15<br>To: Ada Campo-Corrente<br>To_Title: SVP/CIO<br>To_Dep: Executive<br>Time Sent: 18:35:00<br>","Sub: RE  Yearly numbers looking good<br>Date: 2014-01-15<br>To: Orhan Strum<br>To_Title: SVP/COO<br>To_Dep: Executive<br>Time Sent: 18:35:00<br>","Sub: RE  Recommend a good vacation spot <br>Date: 2014-01-16<br>To: Sten Sanjorge Jr<br>To_Title: NA<br>To_Dep: NA<br>Time Sent: 12:58:00<br>","Sub: RE  Recommend a good vacation spot <br>Date: 2014-01-16<br>To: Ada Campo-Corrente<br>To_Title: SVP/CIO<br>To_Dep: Executive<br>Time Sent: 12:58:00<br>","Sub: Managing perceptions about the IPO<br>Date: 2014-01-17<br>To: Sten Sanjorge Jr<br>To_Title: NA<br>To_Dep: NA<br>Time Sent: 08:52:00<br>","Sub: Managing perceptions about the IPO<br>Date: 2014-01-17<br>To: Ada Campo-Corrente<br>To_Title: SVP/CIO<br>To_Dep: Executive<br>Time Sent: 08:52:00<br>","Sub: Managing perceptions about the IPO<br>Date: 2014-01-17<br>To: Ingrid Barranco<br>To_Title: SVP/CFO<br>To_Dep: Executive<br>Time Sent: 08:52:00<br>","Sub: RE  Favor   water plants please next month<br>Date: 2014-01-17<br>To: Orhan Strum<br>To_Title: SVP/COO<br>To_Dep: Executive<br>Time Sent: 16:05:00<br>"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":0.6,"size":7.55905511811024,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[49140,49140,49140],"y":[1,4,3],"text":"","type":"scatter","mode":"lines","line":{"width":0.755905511811024,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Impact of local politics on profit margin","legendgroup":"Impact of local politics on profit margin","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[31920,31920,31920],"y":[5,1,3],"text":"","type":"scatter","mode":"lines","line":{"width":0.755905511811024,"color":"rgba(225,138,0,1)","dash":"solid"},"hoveron":"points","name":"Managing perceptions about the IPO","legendgroup":"Managing perceptions about the IPO","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[39900],"y":[6],"text":"","type":"scatter","mode":"lines","line":{"width":0.755905511811024,"color":"rgba(190,156,0,1)","dash":"solid"},"hoveron":"points","name":"Meeting","legendgroup":"Meeting","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[47220],"y":[5],"text":"","type":"scatter","mode":"lines","line":{"width":0.755905511811024,"color":"rgba(140,171,0,1)","dash":"solid"},"hoveron":"points","name":"Operational efficiencies","legendgroup":"Operational efficiencies","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[57900],"y":[4],"text":"","type":"scatter","mode":"lines","line":{"width":0.755905511811024,"color":"rgba(36,183,0,1)","dash":"solid"},"hoveron":"points","name":"RE  Favor   water plants please next month","legendgroup":"RE  Favor   water plants please next month","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[42060,42060,42060,48660,48660,48660,55440,55440,55440,58380,58380,58380],"y":[5,1,4,5,1,4,1,4,3,1,4,3],"text":"","type":"scatter","mode":"lines","line":{"width":0.755905511811024,"color":"rgba(0,190,112,1)","dash":"solid"},"hoveron":"points","name":"RE  Impact of local politics on profit margin","legendgroup":"RE  Impact of local politics on profit margin","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[70920,70920,70920],"y":[1,4,5],"text":"","type":"scatter","mode":"lines","line":{"width":0.755905511811024,"color":"rgba(0,193,171,1)","dash":"solid"},"hoveron":"points","name":"RE  Impromptu golf vacation   who s in ","legendgroup":"RE  Impromptu golf vacation   who s in ","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[46560,51540,53820],"y":[4,4,4],"text":"","type":"scatter","mode":"lines","line":{"width":0.755905511811024,"color":"rgba(0,187,218,1)","dash":"solid"},"hoveron":"points","name":"RE  IPO","legendgroup":"RE  IPO","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[42780,43620],"y":[2,2],"text":"","type":"scatter","mode":"lines","line":{"width":0.755905511811024,"color":"rgba(0,172,252,1)","dash":"solid"},"hoveron":"points","name":"RE  Late for meeting","legendgroup":"RE  Late for meeting","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[57720],"y":[4],"text":"","type":"scatter","mode":"lines","line":{"width":0.755905511811024,"color":"rgba(139,147,255,1)","dash":"solid"},"hoveron":"points","name":"RE  Maximizing quarterly profits","legendgroup":"RE  Maximizing quarterly profits","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[46680,46680],"y":[5,1],"text":"","type":"scatter","mode":"lines","line":{"width":0.755905511811024,"color":"rgba(213,117,254,1)","dash":"solid"},"hoveron":"points","name":"RE  Recommend a good vacation spot ","legendgroup":"RE  Recommend a good vacation spot ","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[64740,64740,64740,66900,66900,66900],"y":[5,1,4,5,1,4],"text":"","type":"scatter","mode":"lines","line":{"width":0.755905511811024,"color":"rgba(249,98,221,1)","dash":"solid"},"hoveron":"points","name":"RE  Yearly numbers looking good","legendgroup":"RE  Yearly numbers looking good","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[49800,49800,49800],"y":[4,1,5],"text":"","type":"scatter","mode":"lines","line":{"width":0.755905511811024,"color":"rgba(255,101,172,1)","dash":"solid"},"hoveron":"points","name":"Recommend a good vacation spot ","legendgroup":"Recommend a good vacation spot ","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":46.4690743046907,"r":7.30593607305936,"b":41.8264840182648,"l":116.164383561644},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Willem Vasco-Pais Executive,Environmental Safety Advisor","font":{"color":"rgba(0,0,0,1)","family":"","size":18.5969281859693},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[29970,72870],"tickmode":"array","ticktext":["10:00:00","12:00:00","14:00:00","16:00:00","18:00:00","20:00:00"],"tickvals":[36000,43200,50400,57600,64800,72000],"categoryorder":"array","categoryarray":["10:00:00","12:00:00","14:00:00","16:00:00","18:00:00","20:00:00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Time","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,6.6],"tickmode":"array","ticktext":["Ada Campo-Corrente","Inga Ferro","Ingrid Barranco","Orhan Strum","Sten Sanjorge Jr","Varja Lagos"],"tickvals":[1,2,3,4,5,6],"categoryorder":"array","categoryarray":["Ada Campo-Corrente","Inga Ferro","Ingrid Barranco","Orhan Strum","Sten Sanjorge Jr","Varja Lagos"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(240,240,240,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.6268161062682},"y":0.959399606299213},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"214885b3381":{"text":{},"x":{},"y":{},"type":"scatter"},"21482d972f2b":{"colour":{},"x":{},"y":{}}},"cur_data":"214885b3381","visdat":{"214885b3381":["function (y) ","x"],"21482d972f2b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<h3 id="creating-the-age-comparison-plot">Creating the Age Comparison Plot</h3>
<ol type="1">
<li>Create the column of the approximate age, which is 2014 - birth year</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.emp</span> <span class='op'>&lt;-</span><span class='va'>df.emp</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Approx_age <span class='op'>=</span> <span class='fl'>2014</span> <span class='op'>-</span> <span class='fu'>year</span><span class='op'>(</span><span class='va'>BirthDate</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Create an dataframe as follow,<code>age_df</code></li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>age_df</span> <span class='op'>&lt;-</span> <span class='va'>df.emp</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>FullName</span>, <span class='va'>Approx_age</span>, <span class='va'>CurrentEmploymentType</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>FullName2 <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>FullName</span>,<span class='va'>CurrentEmploymentType</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Approx_age</span> <span class='op'>&gt;</span><span class='fl'>60</span>, <span class='fl'>1.05</span>, <span class='op'>-</span><span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Create the ggplot object</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>age_df</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Approx_age</span>, y<span class='op'>=</span> <span class='va'>FullName2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='va'>CurrentEmploymentType</span><span class='op'>)</span>, size<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span>  <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span><span class='va'>FullName2</span>, hjust <span class='op'>=</span> <span class='va'>hjust</span><span class='op'>)</span>, size<span class='op'>=</span><span class='fl'>3</span>, vjust<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span><span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20</span>,<span class='fl'>30</span>,<span class='fl'>40</span>,<span class='fl'>50</span>,<span class='fl'>60</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='st'>""</span>,x<span class='op'>=</span><span class='st'>"Time"</span>,title <span class='op'>=</span> <span class='st'>"Approximate Ages of GasTech Employees"</span>, color<span class='op'>=</span><span class='st'>"Department"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span>,
          panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill<span class='op'>=</span><span class='st'>"white"</span><span class='op'>)</span>,
          panel.grid.major.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='st'>"#c9c9c9"</span>, linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>,
          panel.border <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='st'>"grey"</span>, fill<span class='op'>=</span><span class='cn'>NA</span><span class='op'>)</span>,
          plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>14</span><span class='op'>)</span>,
          axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
          axis.ticks.x  <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
          axis.ticks.y  <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>
          <span class='op'>)</span> <span class='co'>#+</span>
</code></pre>
</div>
<img src="Build_files/figure-html5/unnamed-chunk-43-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">    <span class='co'>#ggsave(filename = 'images/5-Age.png', width = 30, units = "cm")</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="creating-the-citizenship-chart">Creating the Citizenship Chart</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>citi_link</span> <span class='op'>&lt;-</span> <span class='va'>df.emp</span> <span class='op'>%&gt;%</span>
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>FullName</span>, <span class='va'>CitizenshipCountry</span>, <span class='va'>CurrentEmploymentType</span> <span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>From <span class='op'>=</span> <span class='va'>FullName</span>,
                     To <span class='op'>=</span>  <span class='va'>CitizenshipCountry</span>,
                     group <span class='op'>=</span> <span class='va'>CurrentEmploymentType</span><span class='op'>)</span> 
              

<span class='va'>citi_nodes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>citi_link</span><span class='op'>$</span><span class='va'>From</span>, <span class='va'>citi_link</span><span class='op'>$</span><span class='va'>To</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>citi_nodes</span> <span class='op'>&lt;-</span> <span class='va'>citi_nodes</span> <span class='op'>%&gt;%</span> 
                <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>df.emp</span>, <span class='va'>FullName</span>, <span class='va'>CurrentEmploymentType</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span><span class='op'>=</span><span class='st'>"FullName"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>group <span class='op'>=</span>  <span class='va'>CurrentEmploymentType</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                <span class='fu'>replace_na</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>group<span class='op'>=</span><span class='st'>"Place"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>citi_nodes</span><span class='op'>$</span><span class='va'>title</span> <span class='op'>&lt;-</span> <span class='va'>citi_nodes</span><span class='op'>$</span><span class='va'>id</span>
<span class='co'>#citi_nodes$color &lt;- ifelse(str_length(citi_nodes$id)==6,"blue","black")</span>
<span class='va'>citi_nodes</span><span class='op'>$</span><span class='va'>font.size</span> <span class='op'>&lt;-</span> <span class='fl'>25</span>
<span class='va'>citi_nodes</span><span class='op'>$</span><span class='va'>font.weight</span> <span class='op'>&lt;-</span> <span class='fl'>1000</span>



<span class='va'>citi_g</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html'>graph_from_data_frame</a></span><span class='op'>(</span>d <span class='op'>=</span> <span class='va'>citi_link</span>, 
                      vertices <span class='op'>=</span> <span class='va'>citi_nodes</span>, 
                      directed <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
<span class='va'>data_citi</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork-igraph.html'>toVisNetworkData</a></span><span class='op'>(</span><span class='va'>citi_g</span><span class='op'>)</span>

<span class='va'>lnodes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'square'</span>,<span class='fl'>6</span><span class='op'>)</span>,
                     label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Executive"</span>,
                               <span class='st'>"Facilities"</span>,
                               <span class='st'>"Engineering"</span>,
                               <span class='st'>"Administration"</span>,
                               <span class='st'>"Security"</span>,
                               <span class='st'>"Information Technology"</span><span class='op'>)</span>,
                     color.background <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#FB7E81"</span>,
                                          <span class='st'>"#7BE141"</span>,
                                          <span class='st'>"#FFFF00"</span>,
                                          <span class='st'>"#97C2FC"</span>,
                                          <span class='st'>"#AD85E4"</span>,
                                          <span class='st'>"#EB7DF4"</span><span class='op'>)</span>,
                     color.border <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>'black'</span>,<span class='fl'>6</span><span class='op'>)</span>,
                     font.align <span class='op'>=</span>  <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"center"</span>,<span class='fl'>6</span><span class='op'>)</span>,
                     font.size <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>20</span>,<span class='fl'>6</span><span class='op'>)</span>
                     <span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNetwork.html'>visNetwork</a></span><span class='op'>(</span>nodes <span class='op'>=</span> <span class='va'>data_citi</span><span class='op'>$</span><span class='va'>nodes</span>, 
           edges <span class='op'>=</span> <span class='va'>data_citi</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visNodes.html'>visNodes</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>15</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visOptions.html'>visOptions</a></span><span class='op'>(</span>highlightNearest <span class='op'>=</span> <span class='cn'>TRUE</span>, 
             nodesIdSelection <span class='op'>=</span> <span class='cn'>T</span>,
             selectedBy <span class='op'>=</span> <span class='st'>"group"</span>
             <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visIgraphLayout.html'>visIgraphLayout</a></span><span class='op'>(</span>layout <span class='op'>=</span> <span class='st'>"layout_as_star"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/visNetwork/man/visLegend.html'>visLegend</a></span><span class='op'>(</span>zoom <span class='op'>=</span> <span class='cn'>T</span>, addNodes <span class='op'>=</span> <span class='va'>lnodes</span>, useGroups <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span> 
</code></pre>
</div>
<div id="htmlwidget-542633577af928a3e4cc" style="width:624px;height:384px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-542633577af928a3e4cc">{"x":{"nodes":{"id":["Mat Bramar","Anda Ribera","Rachel Pantanal","Linda Lagos","Ruscella Mies Haber","Carla Forluniau","Cornelia Lais","Marin Onda","Isande Borrasca","Axel Calzas","Kare Orilla","Elsa Orilla","Brand Tempestad","Lars Azada","Felix Balas","Lidelse Dedos","Birgitta Frente","Adra Nubarron","Gustav Cazar","Vira Frente","Willem Vasco-Pais","Sten Sanjorge Jr.","Ingrid Barranco","Ada Campo-Corrente","Orhan Strum","Bertrand Ovan","Emile Arpa","Varro Awelon","Dante Coginian","Albina Hafon","Benito Hawelon","Claudio Hawelon","Henk Mies","Valeria Morlun","Adan Morlun","Cecilia Morluniau","Irene Nant","Dylan Scozzese","Linnea Bergen","Lucas Alcazar","Isak Baza","Nils Calixto","Sven Flecha","Kanon Herrero","Varja Lagos","Stenig Fusil","Minke Mies","Hennie Osvaldo","Isia Vann","Edvard Vann","Felix Resumir","Loreto Bodrogi","Hideki Cocinaro","Inga Ferro","Tethys","Kronos"],"group":["Administration","Administration","Administration","Administration","Administration","Administration","Administration","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Executive","Executive","Executive","Executive","Executive","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Information Technology","Information Technology","Information Technology","Information Technology","Information Technology","Security","Security","Security","Security","Security","Security","Security","Security","Security","Security","Security","Place","Place"],"title":["Mat Bramar","Anda Ribera","Rachel Pantanal","Linda Lagos","Ruscella Mies Haber","Carla Forluniau","Cornelia Lais","Marin Onda","Isande Borrasca","Axel Calzas","Kare Orilla","Elsa Orilla","Brand Tempestad","Lars Azada","Felix Balas","Lidelse Dedos","Birgitta Frente","Adra Nubarron","Gustav Cazar","Vira Frente","Willem Vasco-Pais","Sten Sanjorge Jr.","Ingrid Barranco","Ada Campo-Corrente","Orhan Strum","Bertrand Ovan","Emile Arpa","Varro Awelon","Dante Coginian","Albina Hafon","Benito Hawelon","Claudio Hawelon","Henk Mies","Valeria Morlun","Adan Morlun","Cecilia Morluniau","Irene Nant","Dylan Scozzese","Linnea Bergen","Lucas Alcazar","Isak Baza","Nils Calixto","Sven Flecha","Kanon Herrero","Varja Lagos","Stenig Fusil","Minke Mies","Hennie Osvaldo","Isia Vann","Edvard Vann","Felix Resumir","Loreto Bodrogi","Hideki Cocinaro","Inga Ferro","Tethys","Kronos"],"font.size":[25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],"font.weight":[1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000],"label":["Mat Bramar","Anda Ribera","Rachel Pantanal","Linda Lagos","Ruscella Mies Haber","Carla Forluniau","Cornelia Lais","Marin Onda","Isande Borrasca","Axel Calzas","Kare Orilla","Elsa Orilla","Brand Tempestad","Lars Azada","Felix Balas","Lidelse Dedos","Birgitta Frente","Adra Nubarron","Gustav Cazar","Vira Frente","Willem Vasco-Pais","Sten Sanjorge Jr.","Ingrid Barranco","Ada Campo-Corrente","Orhan Strum","Bertrand Ovan","Emile Arpa","Varro Awelon","Dante Coginian","Albina Hafon","Benito Hawelon","Claudio Hawelon","Henk Mies","Valeria Morlun","Adan Morlun","Cecilia Morluniau","Irene Nant","Dylan Scozzese","Linnea Bergen","Lucas Alcazar","Isak Baza","Nils Calixto","Sven Flecha","Kanon Herrero","Varja Lagos","Stenig Fusil","Minke Mies","Hennie Osvaldo","Isia Vann","Edvard Vann","Felix Resumir","Loreto Bodrogi","Hideki Cocinaro","Inga Ferro","Tethys","Kronos"],"x":[-0.000816113535112239,1,0.993476415704543,0.973990707715998,0.941796902037548,0.89731469416029,0.841123977690673,0.773957284550506,0.696690235303089,0.610330124100084,0.516002787061791,0.414937925281574,0.308453073791524,0.197936425478407,0.0848287338664144,-0.0293954693083704,-0.143247096874159,-0.255241918752008,-0.363919911164733,-0.467864290279665,-0.565719982152601,-0.656211288188984,-0.738158515826012,-0.810493357629305,-0.872272818314073,-0.922691508130782,-0.961092142352222,-0.986974109985116,-1,-1,-0.986974109985115,-0.961092142352221,-0.92269150813078,-0.872272818314071,-0.810493357629303,-0.73815851582601,-0.656211288188981,-0.565719982152598,-0.467864290279662,-0.36391991116473,-0.255241918752006,-0.143247096874157,-0.0293954693083682,0.0848287338664164,0.197936425478409,0.308453073791526,0.414937925281575,0.516002787061792,0.610330124100084,0.696690235303089,0.773957284550507,0.841123977690673,0.89731469416029,0.941796902037548,0.973990707715998,0.993476415704543],"y":[2.22044604925031e-16,2.22044604925031e-16,0.114037915370287,0.226589172115208,0.336186492478129,0.44140110778062,0.540861384607196,0.633270706144534,0.717424375564551,0.792225321089906,0.856698398002373,0.910003101145536,0.951444522194885,0.980482408850557,0.996738207852271,1,0.990225262844829,0.96754142503411,0.932244205084165,0.884793756237181,0.825808667659989,0.756057900188259,0.676450761746036,0.588025053126342,0.491933538670727,0.389428918223152,0.281847496271765,0.170591761176282,0.0571121015873908,-0.0571121015873943,-0.170591761176285,-0.281847496271768,-0.389428918223156,-0.49193353867073,-0.588025053126345,-0.676450761746038,-0.756057900188261,-0.825808667659991,-0.884793756237183,-0.932244205084166,-0.967541425034111,-0.990225262844829,-1,-0.996738207852271,-0.980482408850556,-0.951444522194884,-0.910003101145535,-0.856698398002372,-0.792225321089905,-0.71742437556455,-0.633270706144534,-0.540861384607196,-0.441401107780619,-0.336186492478129,-0.226589172115208,-0.114037915370288]},"edges":{"from":["Mat Bramar","Anda Ribera","Rachel Pantanal","Linda Lagos","Ruscella Mies Haber","Carla Forluniau","Cornelia Lais","Marin Onda","Isande Borrasca","Axel Calzas","Kare Orilla","Elsa Orilla","Brand Tempestad","Lars Azada","Felix Balas","Lidelse Dedos","Birgitta Frente","Adra Nubarron","Gustav Cazar","Vira Frente","Willem Vasco-Pais","Sten Sanjorge Jr.","Ingrid Barranco","Ada Campo-Corrente","Orhan Strum","Bertrand Ovan","Emile Arpa","Varro Awelon","Dante Coginian","Albina Hafon","Benito Hawelon","Claudio Hawelon","Henk Mies","Valeria Morlun","Adan Morlun","Cecilia Morluniau","Irene Nant","Dylan Scozzese","Linnea Bergen","Lucas Alcazar","Isak Baza","Nils Calixto","Sven Flecha","Kanon Herrero","Varja Lagos","Stenig Fusil","Minke Mies","Hennie Osvaldo","Isia Vann","Edvard Vann","Felix Resumir","Loreto Bodrogi","Hideki Cocinaro","Inga Ferro"],"to":["Tethys","Tethys","Tethys","Tethys","Kronos","Kronos","Kronos","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Kronos","Kronos","Kronos","Kronos","Kronos","Kronos","Kronos","Kronos","Kronos","Kronos","Kronos","Kronos","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Tethys","Kronos","Kronos","Kronos","Kronos","Tethys","Kronos","Tethys","Kronos"],"group":["Administration","Administration","Administration","Administration","Administration","Administration","Administration","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Engineering","Executive","Executive","Executive","Executive","Executive","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Facilities","Information Technology","Information Technology","Information Technology","Information Technology","Information Technology","Security","Security","Security","Security","Security","Security","Security","Security","Security","Security","Security"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","size":15,"physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false}},"groups":["Administration","Engineering","Executive","Facilities","Information Technology","Security","Place"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":["Administration","Engineering","Executive","Facilities","Information Technology","Place","Security"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"},"legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"shape":["square","square","square","square","square","square"],"label":["Executive","Facilities","Engineering","Administration","Security","Information Technology"],"color.background":["#FB7E81","#7BE141","#FFFF00","#97C2FC","#AD85E4","#EB7DF4"],"color.border":["black","black","black","black","black","black"],"font.align":["center","center","center","center","center","center"],"font.size":[20,20,20,20,20,20]},"nodesToDataframe":true}},"evals":[],"jsHooks":[]}</script>
</div>
<h3 id="creating-the-military-period">Creating the Military Period</h3>
<ol type="1">
<li>Create new columns <code>MilitaryStartYear</code> and <code>MilitaryDischargeYear</code> and add it to the <code>df.emp</code> dataframe</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df.emp</span> <span class='op'>&lt;-</span> <span class='va'>df.emp</span> <span class='op'>%&gt;%</span> 
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>army_year <span class='op'>=</span> <span class='fu'>year</span><span class='op'>(</span><span class='va'>MilitaryDischargeDate</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>disch <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>MilitaryServiceBranch</span>, <span class='va'>army_year</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>MilitaryStartYear <span class='op'>=</span> <span class='fu'>year</span><span class='op'>(</span><span class='va'>MilitaryDischargeDate</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>MilitaryDischargeYear <span class='op'>=</span> <span class='fu'>year</span><span class='op'>(</span><span class='va'>MilitaryDischargeDate</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Two charts will be created, one for Kronos and the other for Tethys. The code line marks <code>--1</code> and <code>--2</code> will be changed to create the new charts.</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mil_data</span><span class='op'>&lt;-</span><span class='va'>df.emp</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>MilitaryDischargeYear</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ArmyLoc <span class='op'>=</span>  <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>MilitaryServiceBranch</span>,<span class='st'>"Kronos"</span><span class='op'>)</span>,<span class='st'>"Kronos"</span>,<span class='st'>"Tethys"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>ArmyLoc</span> <span class='op'>==</span> <span class='st'>"Kronos"</span><span class='op'>)</span>

<span class='va'>mil_data</span> <span class='op'>%&gt;%</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>FullName</span>, x <span class='op'>=</span> <span class='va'>MilitaryStartYear</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>2</span>, color<span class='op'>=</span><span class='st'>"#81b879"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>MilitaryDischargeYear</span><span class='op'>)</span>, color<span class='op'>=</span><span class='st'>"#769ab5"</span>, size<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>MilitaryStartYear</span>, xend<span class='op'>=</span><span class='va'>MilitaryDischargeYear</span>, y<span class='op'>=</span><span class='va'>FullName</span>,yend<span class='op'>=</span><span class='va'>FullName</span><span class='op'>)</span>, size<span class='op'>=</span><span class='fl'>0.5</span>, alpha<span class='op'>=</span><span class='fl'>0.7</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>mil_data</span><span class='op'>$</span><span class='va'>MilitaryStartYear</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>mil_data</span><span class='op'>$</span><span class='va'>MilitaryDischargeYear</span><span class='op'>)</span>, by<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='co'>#facet_wrap(~ArmyLoc, scales = "free") +</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Year"</span>,y <span class='op'>=</span><span class='st'>""</span>, title<span class='op'>=</span><span class='st'>"Time Served in the Military in Kronos"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span><span class='st'>"white"</span><span class='op'>)</span>,
        panel.grid.major.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"grey"</span>,linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>,
        panel.grid.major.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"grey"</span>,linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>,
        panel.border <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='st'>"grey"</span>, fill<span class='op'>=</span><span class='cn'>NA</span><span class='op'>)</span>,
        axis.ticks.x  <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
        axis.ticks.y  <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='co'>#+ </span>
</code></pre>
</div>
<img src="Build_files/figure-html5/army_gg-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r">    <span class='co'>#ggsave('images/5-3-2.png',width = 30, units = "cm")</span>
</code></pre>
</div>
</div>
<h3 id="creating-the-year-joined-chart">Creating the Year Joined Chart</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>year_labels</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/substr.html'>substr</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'>year</span><span class='op'>(</span><span class='va'>df.emp</span><span class='op'>$</span><span class='va'>CurrentEmploymentStartDate</span><span class='op'>)</span><span class='op'>)</span>,<span class='fl'>3</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>year_labels</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"1990"</span>
<span class='va'>year_labels</span><span class='op'>[</span><span class='fl'>20</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"2013"</span>

<span class='va'>df.emp</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>FullName</span>, <span class='va'>CurrentEmploymentStartDate</span>, <span class='va'>CurrentEmploymentType</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>FullName2 <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>FullName</span>,<span class='va'>CurrentEmploymentType</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Year  <span class='op'>=</span> <span class='fu'>year</span><span class='op'>(</span><span class='va'>CurrentEmploymentStartDate</span> <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>FullName2</span> <span class='op'>==</span><span class='st'>"Sten Sanjorge Jr."</span>, <span class='op'>-</span><span class='fl'>0.1</span>, <span class='fl'>1.05</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Year</span>, y<span class='op'>=</span> <span class='va'>FullName2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='va'>CurrentEmploymentType</span><span class='op'>)</span>, size<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>  <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label<span class='op'>=</span><span class='va'>FullName2</span>, hjust <span class='op'>=</span>  <span class='va'>hjust</span><span class='op'>)</span>, size<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='fu'>year</span><span class='op'>(</span><span class='va'>df.emp</span><span class='op'>$</span><span class='va'>CurrentEmploymentStartDate</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, labels <span class='op'>=</span> <span class='va'>year_labels</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='st'>""</span>,x<span class='op'>=</span><span class='st'>"Year"</span>,title <span class='op'>=</span> <span class='st'>"Year Employee of GasTech Joined"</span>, color<span class='op'>=</span><span class='st'>"Department"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>,
          panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill<span class='op'>=</span><span class='st'>"white"</span><span class='op'>)</span>,
          panel.grid.major.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='st'>"#c9c9c9"</span>, linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>,
          panel.border <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='st'>"grey"</span>, fill<span class='op'>=</span><span class='cn'>NA</span><span class='op'>)</span>,
          plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>14</span><span class='op'>)</span>,
          axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
          axis.ticks.x  <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
          axis.ticks.y  <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>
          <span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>'images/5-3-7.png'</span>,width <span class='op'>=</span> <span class='fl'>30</span>, units <span class='op'>=</span> <span class='st'>"cm"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Build_files/figure-html5/join_gg-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
